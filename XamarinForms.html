<html><head><title>Untitled document</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="generator" content="SautinSoft PdfFocus"><style type="text/css">
.cls_0{font: 12px 'Segoe Marker';color:rgb(0,0,0)}
.cls_1{font: 9px 'Lucida Sans Typewriter';color:rgb(0,0,0)}
.cls_2{font: 9px 'Lucida Sans Typewriter';color:rgb(43,145,174)}
.cls_3{font: 9px 'Lucida Sans Typewriter';color:rgb(0,128,0)}
.cls_4{font: 9px 'Lucida Sans Typewriter';color:rgb(0,0,255)}
.cls_5{font: 10px 'Courier New';color:rgb(0,0,0)}
.cls_6{font: 9px 'Lucida Sans Typewriter';color:rgb(162,21,21)}
.cls_7{font: 21px 'Segoe Marker';color:rgb(0,0,0)}
.cls_8{font: 34px 'Segoe Script';color:rgb(0,0,0);font-weight:bold}
.cls_9{font: 12px 'Segoe Marker';color:rgb(0,0,0);font-style:italic}
.cls_10{font: 12px 'Symbol';color:rgb(0,0,0)}
.cls_11{font: 18px 'Segoe Marker';color:rgb(0,0,0);font-weight:bold}
.cls_12{font: 18px 'Segoe Marker';color:rgb(0,0,0)}
.cls_13{font: 12px 'Segoe Marker';color:rgb(0,0,0);font-weight:bold}
.cls_14{font: 9px 'Lucida Sans Typewriter';color:rgb(255,0,0)}
.cls_15{font: 34px 'Segoe Script';color:rgb(0,0,0)}
.cls_16{font: 18px 'Segoe Script';color:rgb(0,0,0);font-weight:bold}
.cls_17{font: 18px 'Segoe Script';color:rgb(0,0,0)}
.cls_18{font: 10px 'Symbol';color:rgb(0,0,0)}</style></head><body><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 5</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Dealing with sizes</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">109</span></div><div style="position:absolute;left:156px;top:71px;white-space:pre;"><span class="cls_1">label.FontSize = fontSize;</span></div><div style="position:absolute;left:156px;top:84px;white-space:pre;"><span class="cls_2">SizeRequest </span><span class="cls_1">sizeRequest =</span></div><div style="position:absolute;left:178px;top:98px;white-space:pre;"><span class="cls_1">label.GetSizeRequest(containerWidth, </span><span class="cls_2">Double</span><span class="cls_1">.PositiveInfinity);</span></div><div style="position:absolute;left:156px;top:124px;white-space:pre;"><span class="cls_3">// Save that height.</span></div><div style="position:absolute;left:156px;top:138px;white-space:pre;"><span class="cls_1">TextHeight = sizeRequest.Request.Height;</span></div><div style="position:absolute;left:133px;top:151px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:133px;top:178px;white-space:pre;"><span class="cls_4">public double </span><span class="cls_1">FontSize { </span><span class="cls_4">private set</span><span class="cls_1">; </span><span class="cls_4">get</span><span class="cls_1">; }</span></div><div style="position:absolute;left:133px;top:204px;white-space:pre;"><span class="cls_4">public double </span><span class="cls_1">TextHeight { </span><span class="cls_4">private set</span><span class="cls_1">; </span><span class="cls_4">get</span><span class="cls_1">; }</span></div><div style="position:absolute;left:111px;top:218px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:243px;white-space:pre;"><span class="cls_0">The resultant height of the rendered </span><span class="cls_5">Label</span><span class="cls_0">is saved in the </span><span class="cls_5">TextHeight</span><span class="cls_0">property.</span></div><div style="position:absolute;left:127px;top:270px;white-space:pre;"><span class="cls_0">When you make a call to </span><span class="cls_5">GetSizeRequest</span><span class="cls_0">on a page or a layout, the page or layout needs to ob-</span></div><div style="position:absolute;left:111px;top:287px;white-space:pre;"><span class="cls_0">tain the sizes of all its children down through the visual tree. This has a performance penalty, of course,</span></div><div style="position:absolute;left:111px;top:304px;white-space:pre;"><span class="cls_0">so you should avoid making calls like that unless necessary. But a </span><span class="cls_5">Label</span><span class="cls_0">has no children, so calling</span></div><div style="position:absolute;left:111px;top:322px;white-space:pre;"><span class="cls_5">GetSizeRequest</span><span class="cls_0">on a </span><span class="cls_5">Label</span><span class="cls_0">is not nearly as bad. However, you should still try to optimize the calls.</span></div><div style="position:absolute;left:111px;top:339px;white-space:pre;"><span class="cls_0">Avoid looping through a sequential series of font size values to determine the maximum value that</span></div><div style="position:absolute;left:111px;top:356px;white-space:pre;"><span class="cls_0">doesn’t result in text exceeding the container height. A process that algorithmically narrows in on an</span></div><div style="position:absolute;left:111px;top:374px;white-space:pre;"><span class="cls_0">optimum value is better.</span></div><div style="position:absolute;left:127px;top:400px;white-space:pre;"><span class="cls_5">GetSizeRequest</span><span class="cls_0">requires that the element be part of a visual tree and that the layout process has</span></div><div style="position:absolute;left:111px;top:418px;white-space:pre;"><span class="cls_0">at least partially begun. Don’t call </span><span class="cls_5">GetSizeRequest</span><span class="cls_0">in the constructor of your page class. You won’t</span></div><div style="position:absolute;left:111px;top:435px;white-space:pre;"><span class="cls_0">get information from it. The firs</span><span class="cls_0">t reasonable opportunity is in an override of the page’s </span><span class="cls_5">OnAppearing</span></div><div style="position:absolute;left:111px;top:452px;white-space:pre;"><span class="cls_0">method. Of course, you might not have sufficient information at this time to pass arguments to the</span></div><div style="position:absolute;left:111px;top:470px;white-space:pre;"><span class="cls_5">GetSizeRequest</span><span class="cls_0">method.</span></div><div style="position:absolute;left:127px;top:496px;white-space:pre;"><span class="cls_0">However, calling </span><span class="cls_5">GetSizeRequest</span><span class="cls_0">doesn’t have any side effects. It doesn’t cause a new size to be</span></div><div style="position:absolute;left:111px;top:514px;white-space:pre;"><span class="cls_0">set on the element, which means that it doesn’t cause a </span><span class="cls_5">SizeChanged</span><span class="cls_0">event to be fired, which means</span></div><div style="position:absolute;left:111px;top:531px;white-space:pre;"><span class="cls_0">that it’s safe to call in a </span><span class="cls_5">SizeChanged</span><span class="cls_0">handler.</span></div><div style="position:absolute;left:127px;top:558px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">EmpiricalFontSizePage</span><span class="cls_0">class instantiates </span><span class="cls_5">FontCalc</span><span class="cls_0">values in the </span><span class="cls_5">SizeChanged</span><span class="cls_0">handler of</span></div><div style="position:absolute;left:111px;top:575px;white-space:pre;"><span class="cls_0">the </span><span class="cls_5">ContentView</span><span class="cls_0">that hosts the </span><span class="cls_5">Label</span><span class="cls_0">. The constructor of each </span><span class="cls_5">FontCalc</span><span class="cls_0">value makes </span><span class="cls_5">GetSize-</span></div><div style="position:absolute;left:111px;top:592px;white-space:pre;"><span class="cls_5">Request</span><span class="cls_0">calls on the </span><span class="cls_5">Label</span><span class="cls_0">and saves the resultant </span><span class="cls_5">TextHeight</span><span class="cls_0">. The </span><span class="cls_5">SizeChanged</span><span class="cls_0">handler begins</span></div><div style="position:absolute;left:111px;top:610px;white-space:pre;"><span class="cls_0">with trial font sizes of 10 and 100 under the assumption that the optimum value is somewhere be-</span></div><div style="position:absolute;left:111px;top:627px;white-space:pre;"><span class="cls_0">tween these two and that these represent lower and upper bounds. Hence the variable names </span><span class="cls_5">lower-</span></div><div style="position:absolute;left:111px;top:644px;white-space:pre;"><span class="cls_5">FontCalc</span><span class="cls_0">and </span><span class="cls_5">upperFontCalc</span><span class="cls_0">:</span></div><div style="position:absolute;left:111px;top:670px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">EmpiricalFontSizePage </span><span class="cls_1">: </span><span class="cls_2">ContentPage</span></div><div style="position:absolute;left:111px;top:683px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:696px;white-space:pre;"><span class="cls_2">Label </span><span class="cls_1">label;</span></div><div style="position:absolute;left:133px;top:723px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">EmpiricalFontSizePage()</span></div><div style="position:absolute;left:133px;top:736px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:750px;white-space:pre;"><span class="cls_1">label = </span><span class="cls_4">new </span><span class="cls_2">Label</span><span class="cls_1">();</span></div><div style="position:absolute;left:156px;top:776px;white-space:pre;"><span class="cls_1">Padding = </span><span class="cls_4">new </span><span class="cls_2">Thickness</span><span class="cls_1">(0, </span><span class="cls_2">Device</span><span class="cls_1">.OnPlatform(20, 0, 0), 0, 0);</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 5</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Dealing with sizes</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">110</span></div><div style="position:absolute;left:132px;top:71px;white-space:pre;"><span class="cls_2">ContentView </span><span class="cls_1">contentView = </span><span class="cls_4">new </span><span class="cls_2">ContentView</span></div><div style="position:absolute;left:132px;top:84px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:98px;white-space:pre;"><span class="cls_1">Content = label</span></div><div style="position:absolute;left:132px;top:111px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:132px;top:124px;white-space:pre;"><span class="cls_1">contentView.SizeChanged += OnContentViewSizeChanged;</span></div><div style="position:absolute;left:132px;top:138px;white-space:pre;"><span class="cls_1">Content = contentView;</span></div><div style="position:absolute;left:109px;top:151px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:178px;white-space:pre;"><span class="cls_4">void </span><span class="cls_1">OnContentViewSizeChanged(</span><span class="cls_4">object </span><span class="cls_1">sender, </span><span class="cls_2">EventArgs </span><span class="cls_1">args)</span></div><div style="position:absolute;left:109px;top:191px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:204px;white-space:pre;"><span class="cls_3">// Get View whose size is changing.</span></div><div style="position:absolute;left:132px;top:218px;white-space:pre;"><span class="cls_2">View </span><span class="cls_1">view = (</span><span class="cls_2">View</span><span class="cls_1">)sender;</span></div><div style="position:absolute;left:132px;top:244px;white-space:pre;"><span class="cls_4">if </span><span class="cls_1">(view.Width <= 0 || view.Height <= 0)</span></div><div style="position:absolute;left:154px;top:258px;white-space:pre;"><span class="cls_4">return</span><span class="cls_1">;</span></div><div style="position:absolute;left:132px;top:284px;white-space:pre;"><span class="cls_1">label.Text =</span></div><div style="position:absolute;left:154px;top:298px;white-space:pre;"><span class="cls_6">"This is a paragraph of text displayed with " </span><span class="cls_1">+</span></div><div style="position:absolute;left:154px;top:311px;white-space:pre;"><span class="cls_6">"a FontSize value of ?? that is empirically " </span><span class="cls_1">+</span></div><div style="position:absolute;left:154px;top:324px;white-space:pre;"><span class="cls_6">"calculated in a loop within the SizeChanged " </span><span class="cls_1">+</span></div><div style="position:absolute;left:154px;top:338px;white-space:pre;"><span class="cls_6">"handler of the Label's container. This technique " </span><span class="cls_1">+</span></div><div style="position:absolute;left:154px;top:351px;white-space:pre;"><span class="cls_6">"can be tricky: You don't want to get into " </span><span class="cls_1">+</span></div><div style="position:absolute;left:154px;top:364px;white-space:pre;"><span class="cls_6">"an infinite loop by triggering a layout pass " </span><span class="cls_1">+</span></div><div style="position:absolute;left:154px;top:378px;white-space:pre;"><span class="cls_6">"with every calculation. Does it work?"</span><span class="cls_1">;</span></div><div style="position:absolute;left:132px;top:404px;white-space:pre;"><span class="cls_3">// Calculate the height of the rendered text.</span></div><div style="position:absolute;left:132px;top:418px;white-space:pre;"><span class="cls_2">FontCalc </span><span class="cls_1">lowerFontCalc = </span><span class="cls_4">new </span><span class="cls_2">FontCalc</span><span class="cls_1">(label, 10, view.Width);</span></div><div style="position:absolute;left:132px;top:431px;white-space:pre;"><span class="cls_2">FontCalc </span><span class="cls_1">upperFontCalc = </span><span class="cls_4">new </span><span class="cls_2">FontCalc</span><span class="cls_1">(label, 100, view.Width);</span></div><div style="position:absolute;left:132px;top:458px;white-space:pre;"><span class="cls_4">while </span><span class="cls_1">(upperFontCalc.FontSize - lowerFontCalc.FontSize > 1)</span></div><div style="position:absolute;left:132px;top:471px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:484px;white-space:pre;"><span class="cls_3">// Get the average font size of the upper and lower bounds.</span></div><div style="position:absolute;left:154px;top:498px;white-space:pre;"><span class="cls_4">double </span><span class="cls_1">fontSize = (lowerFontCalc.FontSize + upperFontCalc.FontSize) / 2;</span></div><div style="position:absolute;left:154px;top:524px;white-space:pre;"><span class="cls_3">// Check the new text height against the container height.</span></div><div style="position:absolute;left:154px;top:538px;white-space:pre;"><span class="cls_2">FontCalc </span><span class="cls_1">newFontCalc = </span><span class="cls_4">new </span><span class="cls_2">FontCalc</span><span class="cls_1">(label, fontSize, view.Width);</span></div><div style="position:absolute;left:154px;top:564px;white-space:pre;"><span class="cls_4">if </span><span class="cls_1">(newFontCalc.TextHeight > view.Height)</span></div><div style="position:absolute;left:154px;top:578px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:177px;top:591px;white-space:pre;"><span class="cls_1">upperFontCalc = newFontCalc;</span></div><div style="position:absolute;left:154px;top:604px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:154px;top:618px;white-space:pre;"><span class="cls_4">else</span></div><div style="position:absolute;left:154px;top:631px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:177px;top:644px;white-space:pre;"><span class="cls_1">lowerFontCalc = newFontCalc;</span></div><div style="position:absolute;left:154px;top:658px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:132px;top:671px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:132px;top:698px;white-space:pre;"><span class="cls_3">// Set the final font size and the text with the embedded value.</span></div><div style="position:absolute;left:132px;top:711px;white-space:pre;"><span class="cls_1">label.FontSize = lowerFontCalc.FontSize;</span></div><div style="position:absolute;left:132px;top:724px;white-space:pre;"><span class="cls_1">label.Text = label.Text.Replace(</span><span class="cls_6">"??"</span><span class="cls_1">, label.FontSize.ToString(</span><span class="cls_6">"F0"</span><span class="cls_1">));</span></div><div style="position:absolute;left:109px;top:738px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:751px;white-space:pre;"><span class="cls_1">}</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:111px;top:196px;width:492px;height:295px;z-index:0;"><img src="images\image65.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image66.png" width="708" height="864" alt=""></div><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 5</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Dealing with sizes</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">111</span></div><div style="position:absolute;left:111px;top:72px;white-space:pre;"><span class="cls_0">In each iteration of the </span><span class="cls_5">while</span><span class="cls_0">loop, the </span><span class="cls_5">FontSize</span><span class="cls_0">properties of those two </span><span class="cls_5">FontCalc</span><span class="cls_0">values are aver-</span></div><div style="position:absolute;left:111px;top:90px;white-space:pre;"><span class="cls_0">aged and a new </span><span class="cls_5">FontCalc</span><span class="cls_0">is obtained. This becomes the new </span><span class="cls_5">lowerFontCalc</span><span class="cls_0">or </span><span class="cls_5">upperFontCalc</span></div><div style="position:absolute;left:111px;top:107px;white-space:pre;"><span class="cls_0">value depending on the height of the rendered text. The loop ends when the calculated font size is</span></div><div style="position:absolute;left:111px;top:124px;white-space:pre;"><span class="cls_0">within one unit of the optimum value.</span></div><div style="position:absolute;left:127px;top:151px;white-space:pre;"><span class="cls_0">About seven iterations of the loop are sufficient to get a value that is clearly better than the esti-</span></div><div style="position:absolute;left:111px;top:168px;white-space:pre;"><span class="cls_0">mated value calculated in the earlier program:</span></div><div style="position:absolute;left:127px;top:499px;white-space:pre;"><span class="cls_0">Turning the phone sideways triggers another recalculation that results in a similar (though not nec-</span></div><div style="position:absolute;left:111px;top:516px;white-space:pre;"><span class="cls_0">essarily the same) font size:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:87px;top:71px;width:492px;height:295px;z-index:0;"><img src="images\image67.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image68.png" width="708" height="864" alt=""></div><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 5</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Dealing with sizes</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">112</span></div><div style="position:absolute;left:103px;top:374px;white-space:pre;"><span class="cls_0">It might seem that the algorithm could be improved beyond simply averaging the </span><span class="cls_5">FontSize</span><span class="cls_0">prop-</span></div><div style="position:absolute;left:87px;top:391px;white-space:pre;"><span class="cls_0">erties from the lower and upper </span><span class="cls_5">FontCalc</span><span class="cls_0">values. But the relationship between the font size and ren-</span></div><div style="position:absolute;left:87px;top:408px;white-space:pre;"><span class="cls_0">dered text height is rather complex, and sometimes the easiest approach is just as good.</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image69.png" width="708" height="864" alt=""></div><div style="position:absolute;left:79px;top:74px;white-space:pre;"><span class="cls_7">Chapter 6</span></div><div style="position:absolute;left:79px;top:94px;white-space:pre;"><span class="cls_8">Button</span></div><div style="position:absolute;left:197px;top:94px;white-space:pre;"><span class="cls_8">clicks</span></div><div style="position:absolute;left:111px;top:168px;white-space:pre;"><span class="cls_0">The components of a graphical user interface can be divided roughly into views that are used for</span></div><div style="position:absolute;left:111px;top:186px;white-space:pre;"><span class="cls_0">presentation, which display information </span><span class="cls_9">to</span><span class="cls_0"> </span><span class="cls_0">the user, and interaction, which obtain input </span><span class="cls_9">from</span><span class="cls_0"> </span><span class="cls_0">the user.</span></div><div style="position:absolute;left:111px;top:203px;white-space:pre;"><span class="cls_0">While the </span><span class="cls_5">Label</span><span class="cls_0">is the most basic presentation view, the </span><span class="cls_5">Button</span><span class="cls_0">is probably the archetypal interactive</span></div><div style="position:absolute;left:111px;top:220px;white-space:pre;"><span class="cls_0">view. The </span><span class="cls_5">Button</span><span class="cls_0">signals a command. It’s the user’s way of telling the program to initiate some ac-</span></div><div style="position:absolute;left:111px;top:238px;white-space:pre;"><span class="cls_0">tion</span><span class="cls_0">—</span><span class="cls_0">to do something.</span></div><div style="position:absolute;left:127px;top:264px;white-space:pre;"><span class="cls_0">A Xamarin.Forms button displays text, with or without an accompanying image. (Only text buttons</span></div><div style="position:absolute;left:111px;top:282px;white-space:pre;"><span class="cls_0">are described in this chapter; adding an image to a </span><span class="cls_0">button is covered in Chapter 13, “Bitmaps.”) When</span></div><div style="position:absolute;left:111px;top:299px;white-space:pre;"><span class="cls_0">the user’s finger presses on a button, the button chan</span><span class="cls_0">ges its appearance somewhat to provide feed-</span></div><div style="position:absolute;left:111px;top:316px;white-space:pre;"><span class="cls_0">back to the user. When the finger is released, the button fires a </span><span class="cls_5">Clicked</span><span class="cls_0">event. The two arguments of</span></div><div style="position:absolute;left:111px;top:334px;white-space:pre;"><span class="cls_0">the </span><span class="cls_5">Clicked</span><span class="cls_0">handler are typical of Xamarin.Forms event handlers:</span></div><div style="position:absolute;left:125px;top:359px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:360px;white-space:pre;"><span class="cls_0">The first argument is the object firing the event. For the </span><span class="cls_5">Clicked</span><span class="cls_0">handler, this is the particular</span></div><div style="position:absolute;left:149px;top:378px;white-space:pre;"><span class="cls_5">Button</span><span class="cls_0">object that’s been tapped.</span></div><div style="position:absolute;left:125px;top:403px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:404px;white-space:pre;"><span class="cls_0">The second argument sometimes provides more information about the event. For the </span><span class="cls_5">Clicked</span></div><div style="position:absolute;left:149px;top:422px;white-space:pre;"><span class="cls_0">event, the second argument is simply an </span><span class="cls_5">EventArgs</span><span class="cls_0">object that provides no additional infor-</span></div><div style="position:absolute;left:149px;top:439px;white-space:pre;"><span class="cls_0">mation.</span></div><div style="position:absolute;left:127px;top:466px;white-space:pre;"><span class="cls_0">Once an application begins implementing user interaction, some special needs arise: The applica-</span></div><div style="position:absolute;left:111px;top:483px;white-space:pre;"><span class="cls_0">tion should make an effort to save the results of that interaction if the program happens to be termi-</span></div><div style="position:absolute;left:111px;top:500px;white-space:pre;"><span class="cls_0">nated before the user has finished working with it. For that reason, this chapter also discusses how an</span></div><div style="position:absolute;left:111px;top:518px;white-space:pre;"><span class="cls_0">application can save transient data, particularly in the context of application lifecycle events. These are</span></div><div style="position:absolute;left:111px;top:535px;white-space:pre;"><span class="cls_0">described in the section “Saving transient data.”</span></div><div style="position:absolute;left:79px;top:575px;white-space:pre;"><span class="cls_11">Processing</span><span class="cls_12"> </span><span class="cls_11">the</span><span class="cls_12"> </span><span class="cls_11">click</span></div><div style="position:absolute;left:111px;top:623px;white-space:pre;"><span class="cls_0">Here’s a prog</span><span class="cls_0">ram named </span><span class="cls_13">ButtonLogger</span><span class="cls_0"> </span><span class="cls_0">with a </span><span class="cls_5">Button</span><span class="cls_0">that shares a </span><span class="cls_5">StackLayout</span><span class="cls_0">with a </span><span class="cls_5">Scroll-</span></div><div style="position:absolute;left:111px;top:641px;white-space:pre;"><span class="cls_5">View</span><span class="cls_0">containing another </span><span class="cls_5">StackLayout</span><span class="cls_0">. Every time the </span><span class="cls_5">Button</span><span class="cls_0">is clicked, the program adds</span></div><div style="position:absolute;left:111px;top:658px;white-space:pre;"><span class="cls_0">a new </span><span class="cls_5">Label</span><span class="cls_0">to the scrollable </span><span class="cls_5">StackLayout</span><span class="cls_0">, in effect logging all the button clicks:</span></div><div style="position:absolute;left:111px;top:683px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">ButtonLoggerPage </span><span class="cls_1">: </span><span class="cls_2">ContentPage</span></div><div style="position:absolute;left:111px;top:696px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:710px;white-space:pre;"><span class="cls_2">StackLayout </span><span class="cls_1">loggerLayout = </span><span class="cls_4">new </span><span class="cls_2">StackLayout</span><span class="cls_1">();</span></div><div style="position:absolute;left:133px;top:736px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">ButtonLoggerPage()</span></div><div style="position:absolute;left:133px;top:750px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:763px;white-space:pre;"><span class="cls_3">// Create the Button and attach Clicked handler.</span></div><div style="position:absolute;left:156px;top:776px;white-space:pre;"><span class="cls_2">Button </span><span class="cls_1">button = </span><span class="cls_4">new </span><span class="cls_2">Button</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 6</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Button clicks</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">114</span></div><div style="position:absolute;left:132px;top:71px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:84px;white-space:pre;"><span class="cls_1">Text = </span><span class="cls_6">"Log the Click Time"</span></div><div style="position:absolute;left:132px;top:98px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:132px;top:111px;white-space:pre;"><span class="cls_1">button.Clicked += OnButtonClicked;</span></div><div style="position:absolute;left:132px;top:138px;white-space:pre;"><span class="cls_4">this</span><span class="cls_1">.Padding = </span><span class="cls_4">new </span><span class="cls_2">Thickness</span><span class="cls_1">(5, </span><span class="cls_2">Device</span><span class="cls_1">.OnPlatform(20, 0, 0), 5, 0);</span></div><div style="position:absolute;left:132px;top:164px;white-space:pre;"><span class="cls_3">// Assemble the page.</span></div><div style="position:absolute;left:132px;top:178px;white-space:pre;"><span class="cls_4">this</span><span class="cls_1">.Content = </span><span class="cls_4">new </span><span class="cls_2">StackLayout</span></div><div style="position:absolute;left:132px;top:191px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:204px;white-space:pre;"><span class="cls_1">Children =</span></div><div style="position:absolute;left:154px;top:218px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:177px;top:231px;white-space:pre;"><span class="cls_1">button,</span></div><div style="position:absolute;left:177px;top:244px;white-space:pre;"><span class="cls_4">new </span><span class="cls_2">ScrollView</span></div><div style="position:absolute;left:177px;top:258px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:199px;top:271px;white-space:pre;"><span class="cls_1">VerticalOptions = </span><span class="cls_2">LayoutOptions</span><span class="cls_1">.FillAndExpand,</span></div><div style="position:absolute;left:199px;top:284px;white-space:pre;"><span class="cls_1">Content = loggerLayout</span></div><div style="position:absolute;left:177px;top:298px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:154px;top:311px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:132px;top:324px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:109px;top:338px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:364px;white-space:pre;"><span class="cls_4">void </span><span class="cls_1">OnButtonClicked(</span><span class="cls_4">object </span><span class="cls_1">sender, </span><span class="cls_2">EventArgs </span><span class="cls_1">args)</span></div><div style="position:absolute;left:109px;top:378px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:391px;white-space:pre;"><span class="cls_3">// Add Label to scrollable StackLayout.</span></div><div style="position:absolute;left:132px;top:404px;white-space:pre;"><span class="cls_1">loggerLayout.Children.Add(</span><span class="cls_4">new </span><span class="cls_2">Label</span></div><div style="position:absolute;left:132px;top:418px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:431px;white-space:pre;"><span class="cls_1">Text = </span><span class="cls_6">"Button clicked at " </span><span class="cls_1">+ </span><span class="cls_2">DateTime</span><span class="cls_1">.Now.ToString(</span><span class="cls_6">"T"</span><span class="cls_1">)</span></div><div style="position:absolute;left:132px;top:444px;white-space:pre;"><span class="cls_1">});</span></div><div style="position:absolute;left:109px;top:458px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:471px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:103px;top:496px;white-space:pre;"><span class="cls_0">In the programs in this book, event handlers are given names beginning with the word </span><span class="cls_5">On</span><span class="cls_0">, followed</span></div><div style="position:absolute;left:87px;top:514px;white-space:pre;"><span class="cls_0">by some kind of identification of the view firing the event (sometimes just the view type), followed by</span></div><div style="position:absolute;left:87px;top:531px;white-space:pre;"><span class="cls_0">the event name. The resultant name in this case is </span><span class="cls_5">OnButtonClicked</span><span class="cls_0">.</span></div><div style="position:absolute;left:103px;top:558px;white-space:pre;"><span class="cls_0">The constructor attaches the </span><span class="cls_5">Clicked</span><span class="cls_0">handler to the </span><span class="cls_5">Button</span><span class="cls_0">right after the </span><span class="cls_5">Button</span><span class="cls_0">is created. The</span></div><div style="position:absolute;left:87px;top:575px;white-space:pre;"><span class="cls_0">page is then assembled with a </span><span class="cls_5">StackLayout</span><span class="cls_0">containing the </span><span class="cls_5">Button</span><span class="cls_0">and a </span><span class="cls_5">ScrollView</span><span class="cls_0">with another</span></div><div style="position:absolute;left:87px;top:592px;white-space:pre;"><span class="cls_5">StackLayout</span><span class="cls_0">, named </span><span class="cls_5">loggerLayout</span><span class="cls_0">. Notice that the </span><span class="cls_5">ScrollView</span><span class="cls_0">has its </span><span class="cls_5">VerticalOptions</span><span class="cls_0">set to</span></div><div style="position:absolute;left:87px;top:610px;white-space:pre;"><span class="cls_5">FillAndExpand</span><span class="cls_0">so that it can share the </span><span class="cls_5">StackLayout</span><span class="cls_0">with the </span><span class="cls_5">Button</span><span class="cls_0">and still be visible and scrolla-</span></div><div style="position:absolute;left:87px;top:627px;white-space:pre;"><span class="cls_0">ble.</span></div><div style="position:absolute;left:103px;top:654px;white-space:pre;"><span class="cls_0">Here’s the display after several </span><span class="cls_5">Button</span><span class="cls_0">clicks:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:111px;top:71px;width:492px;height:295px;z-index:0;"><img src="images\image70.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image71.png" width="708" height="864" alt=""></div><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 6</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Button clicks</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">115</span></div><div style="position:absolute;left:111px;top:374px;white-space:pre;"><span class="cls_0">As you can see, the </span><span class="cls_5">Button</span><span class="cls_0">looks a little different on the three screens. That’s be</span><span class="cls_0">cause the button is</span></div><div style="position:absolute;left:111px;top:391px;white-space:pre;"><span class="cls_0">rendered natively on the individual platforms: on the iPhone it’s a </span><span class="cls_5">UIButton</span><span class="cls_0">, on Android it’s an</span></div><div style="position:absolute;left:111px;top:408px;white-space:pre;"><span class="cls_0">Android </span><span class="cls_5">Button</span><span class="cls_0">, and on Windows 10 Mobile it’s a Windows Runtime </span><span class="cls_5">Button</span><span class="cls_0">. By default the button</span></div><div style="position:absolute;left:111px;top:426px;white-space:pre;"><span class="cls_0">always fills the area available for it and centers the text inside.</span></div><div style="position:absolute;left:127px;top:452px;white-space:pre;"><span class="cls_5">Button</span><span class="cls_0">defines several properties that let you customize its appearance:</span></div><div style="position:absolute;left:125px;top:478px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:479px;white-space:pre;"><span class="cls_5">FontFamily</span><span class="cls_0">of type </span><span class="cls_5">string</span></div><div style="position:absolute;left:125px;top:505px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:506px;white-space:pre;"><span class="cls_5">FontSize</span><span class="cls_0">of type </span><span class="cls_5">double</span></div><div style="position:absolute;left:125px;top:531px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:532px;white-space:pre;"><span class="cls_5">FontAttributes</span><span class="cls_0">of type </span><span class="cls_5">FontAttributes</span></div><div style="position:absolute;left:125px;top:558px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:559px;white-space:pre;"><span class="cls_5">TextColor</span><span class="cls_0">of type </span><span class="cls_5">Color</span><span class="cls_0">(default is </span><span class="cls_5">Color.Default</span><span class="cls_0">)</span></div><div style="position:absolute;left:125px;top:585px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:586px;white-space:pre;"><span class="cls_5">BorderColor</span><span class="cls_0">of type </span><span class="cls_5">Color</span><span class="cls_0">(default is </span><span class="cls_5">Color.Default</span><span class="cls_0">)</span></div><div style="position:absolute;left:125px;top:611px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:612px;white-space:pre;"><span class="cls_5">BorderWidth</span><span class="cls_0">of type </span><span class="cls_5">double</span><span class="cls_0">(default is 0)</span></div><div style="position:absolute;left:125px;top:638px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:639px;white-space:pre;"><span class="cls_5">BorderRadius</span><span class="cls_0">of type </span><span class="cls_5">double</span><span class="cls_0">(default is 5)</span></div><div style="position:absolute;left:125px;top:665px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:666px;white-space:pre;"><span class="cls_5">Image</span><span class="cls_0">(to be discussed in Chapter 13)</span></div><div style="position:absolute;left:111px;top:692px;white-space:pre;"><span class="cls_5">Button</span><span class="cls_0">also inherits the </span><span class="cls_5">BackgroundColor</span><span class="cls_0">property (and a bunch of other properties) from</span></div><div style="position:absolute;left:111px;top:710px;white-space:pre;"><span class="cls_5">VisualElement</span><span class="cls_0">and inherits </span><span class="cls_5">HorizontalOptions</span><span class="cls_0">and </span><span class="cls_5">VerticalOptions</span><span class="cls_0">from </span><span class="cls_5">View</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:736px;white-space:pre;"><span class="cls_0">Some </span><span class="cls_5">Button</span><span class="cls_0">properties might work a little differently on the various platforms. As you can see,</span></div><div style="position:absolute;left:111px;top:754px;white-space:pre;"><span class="cls_0">none of the buttons in the screenshots has a border. (However, the Windows Phone 8.1 button has a</span></div><div style="position:absolute;left:111px;top:771px;white-space:pre;"><span class="cls_0">visible white border by default.) If you set the </span><span class="cls_5">BorderWidth</span><span class="cls_0">property to a nonzero value, the border</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image72.png" width="708" height="864" alt=""></div><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 6</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Button clicks</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">116</span></div><div style="position:absolute;left:87px;top:72px;white-space:pre;"><span class="cls_0">becomes visible only on the iPhone, and it’s black. If you set the </span><span class="cls_5">BorderColor</span><span class="cls_0">property to something</span></div><div style="position:absolute;left:87px;top:90px;white-space:pre;"><span class="cls_0">other than </span><span class="cls_5">Color.Default</span><span class="cls_0">, the border is visible only on the Windows 10 Mobile device. If you want a</span></div><div style="position:absolute;left:87px;top:107px;white-space:pre;"><span class="cls_0">visible border on both iOS and Windows 10 mobile devices, set both </span><span class="cls_5">BorderWidth</span><span class="cls_0">and </span><span class="cls_5">BorderColor</span><span class="cls_0">.</span></div><div style="position:absolute;left:87px;top:124px;white-space:pre;"><span class="cls_0">But the border still won’t show up on Android devices unless you also set the </span><span class="cls_5">BackgroundColor</span></div><div style="position:absolute;left:87px;top:142px;white-space:pre;"><span class="cls_0">property. Customizing a button border is a good opportunity for using </span><span class="cls_5">Device.OnPlatform</span><span class="cls_0">(as you’ll</span></div><div style="position:absolute;left:87px;top:159px;white-space:pre;"><span class="cls_0">see in Chapter 10, “XAML markup extensions”).</span></div><div style="position:absolute;left:103px;top:186px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">BorderRadius</span><span class="cls_0">property is intended to round off the sharp corners of the border, and it works</span></div><div style="position:absolute;left:87px;top:203px;white-space:pre;"><span class="cls_0">on iOS and Android if the bor</span><span class="cls_0">der is displayed, but it doesn’t work on Windows 10 and Windows 10</span></div><div style="position:absolute;left:87px;top:220px;white-space:pre;"><span class="cls_0">Mobile. The </span><span class="cls_5">BorderRadius</span><span class="cls_0">works on Windows 8.1 and Windows Phone 8.1, but if you use it with</span></div><div style="position:absolute;left:87px;top:238px;white-space:pre;"><span class="cls_5">BackgroundColor</span><span class="cls_0">, the background is not enclosed within the border.</span></div><div style="position:absolute;left:103px;top:264px;white-space:pre;"><span class="cls_0">Suppose you wrote a program similar to </span><span class="cls_13">ButtonLogger</span><span class="cls_0"> </span><span class="cls_0">but did not save the </span><span class="cls_5">loggerLayout</span><span class="cls_0">object</span></div><div style="position:absolute;left:87px;top:282px;white-space:pre;"><span class="cls_0">as a field. Could you get access to that </span><span class="cls_5">StackLayout</span><span class="cls_0">object in the </span><span class="cls_5">Clicked</span><span class="cls_0">event handler?</span></div><div style="position:absolute;left:103px;top:308px;white-space:pre;"><span class="cls_0">Yes! It’s possible to obtain parent and child visual elements by a technique called </span><span class="cls_9">walking</span><span class="cls_0"> </span><span class="cls_9">the</span><span class="cls_0"> </span><span class="cls_9">visual</span></div><div style="position:absolute;left:87px;top:326px;white-space:pre;"><span class="cls_9">tree</span><span class="cls_0">. The </span><span class="cls_5">sender</span><span class="cls_0">argument to the </span><span class="cls_5">OnButtonClicked</span><span class="cls_0">handler is the object firing the event, in this case</span></div><div style="position:absolute;left:87px;top:343px;white-space:pre;"><span class="cls_0">the </span><span class="cls_5">Button</span><span class="cls_0">, so you can begin the </span><span class="cls_5">Clicked</span><span class="cls_0">handler by casting that argument:</span></div><div style="position:absolute;left:87px;top:368px;white-space:pre;"><span class="cls_2">Button </span><span class="cls_1">button = (</span><span class="cls_2">Button</span><span class="cls_1">)sender;</span></div><div style="position:absolute;left:87px;top:394px;white-space:pre;"><span class="cls_0">You know that the </span><span class="cls_5">Button</span><span class="cls_0">is a child of a </span><span class="cls_5">StackLayout</span><span class="cls_0">, so that object is accessible from the </span><span class="cls_5">Parent</span></div><div style="position:absolute;left:87px;top:411px;white-space:pre;"><span class="cls_0">property. Again, some casting is required:</span></div><div style="position:absolute;left:87px;top:436px;white-space:pre;"><span class="cls_2">StackLayout </span><span class="cls_1">outerLayout = (</span><span class="cls_2">StackLayout</span><span class="cls_1">)button.Parent;</span></div><div style="position:absolute;left:87px;top:462px;white-space:pre;"><span class="cls_0">The second child of this </span><span class="cls_5">StackLayout</span><span class="cls_0">is the </span><span class="cls_5">ScrollView</span><span class="cls_0">, so the </span><span class="cls_5">Children</span><span class="cls_0">property can be indexed</span></div><div style="position:absolute;left:87px;top:479px;white-space:pre;"><span class="cls_0">to obtain that:</span></div><div style="position:absolute;left:87px;top:504px;white-space:pre;"><span class="cls_2">ScrollView </span><span class="cls_1">scrollView = (</span><span class="cls_2">ScrollView</span><span class="cls_1">)outerLayout.Children[1];</span></div><div style="position:absolute;left:87px;top:530px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">Content</span><span class="cls_0">property of this </span><span class="cls_5">ScrollView</span><span class="cls_0">is exactly the </span><span class="cls_5">StackLayout</span><span class="cls_0">you were looking for:</span></div><div style="position:absolute;left:87px;top:555px;white-space:pre;"><span class="cls_2">StackLayout </span><span class="cls_1">loggerLayout = (</span><span class="cls_2">StackLayout</span><span class="cls_1">)scrollView.Content;</span></div><div style="position:absolute;left:103px;top:580px;white-space:pre;"><span class="cls_0">Of course, the danger in doing something like this is that you might change the layout someday</span></div><div style="position:absolute;left:87px;top:598px;white-space:pre;"><span class="cls_0">and forget to change your tree-walking code similarly. But the technique comes in handy if the code</span></div><div style="position:absolute;left:87px;top:615px;white-space:pre;"><span class="cls_0">that assembles your page is separate from the code handling events from views on that page.</span></div><div style="position:absolute;left:55px;top:655px;white-space:pre;"><span class="cls_11">Sharing</span><span class="cls_12"> </span><span class="cls_11">button</span><span class="cls_12"> </span><span class="cls_11">clicks</span></div><div style="position:absolute;left:87px;top:703px;white-space:pre;"><span class="cls_0">If a program contains multiple </span><span class="cls_5">Button</span><span class="cls_0">views, each </span><span class="cls_5">Button</span><span class="cls_0">can have its own </span><span class="cls_5">Clicked</span><span class="cls_0">handler. But in</span></div><div style="position:absolute;left:87px;top:720px;white-space:pre;"><span class="cls_0">some cases it might be more convenient for multiple </span><span class="cls_5">Button</span><span class="cls_0">views to share a common </span><span class="cls_5">Clicked</span></div><div style="position:absolute;left:87px;top:738px;white-space:pre;"><span class="cls_0">handler.</span></div><div style="position:absolute;left:103px;top:764px;white-space:pre;"><span class="cls_0">Consider a calculator program. Each of the buttons labeled 0 through 9 basically does the same</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 6</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Button clicks</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">117</span></div><div style="position:absolute;left:111px;top:72px;white-space:pre;"><span class="cls_0">thing, and having 10 separate </span><span class="cls_5">Clicked</span><span class="cls_0">handlers for these 10 buttons</span><span class="cls_0">—</span><span class="cls_0">even if they share some com-</span></div><div style="position:absolute;left:111px;top:90px;white-space:pre;"><span class="cls_0">mon code</span><span class="cls_0">—simply wouldn’t make much sense.</span></div><div style="position:absolute;left:127px;top:116px;white-space:pre;"><span class="cls_0">You’ve seen how the first argument to the </span><span class="cls_5">Clicked</span><span class="cls_0">handler can be cast to an object of type</span></div><div style="position:absolute;left:111px;top:134px;white-space:pre;"><span class="cls_5">Button</span><span class="cls_0">. But how do you know which </span><span class="cls_5">Button</span><span class="cls_0">it is?</span></div><div style="position:absolute;left:127px;top:160px;white-space:pre;"><span class="cls_0">One approach is to store all the </span><span class="cls_5">Button</span><span class="cls_0">objects as fields and then compare the </span><span class="cls_5">Button</span><span class="cls_0">object fir-</span></div><div style="position:absolute;left:111px;top:178px;white-space:pre;"><span class="cls_0">ing the event with these fields.</span></div><div style="position:absolute;left:127px;top:204px;white-space:pre;"><span class="cls_0">The </span><span class="cls_13">TwoButtons</span><span class="cls_0"> </span><span class="cls_0">program demonstrates this technique. This program is similar to the previous pro-</span></div><div style="position:absolute;left:111px;top:222px;white-space:pre;"><span class="cls_0">gram but with two buttons</span><span class="cls_0">—</span><span class="cls_0">one to add </span><span class="cls_5">Label</span><span class="cls_0">objects to the </span><span class="cls_5">StackLayout</span><span class="cls_0">, and the other to remove</span></div><div style="position:absolute;left:111px;top:239px;white-space:pre;"><span class="cls_0">them. The two </span><span class="cls_5">Button</span><span class="cls_0">objects are stored as fields so that the </span><span class="cls_5">Clicked</span><span class="cls_0">handler can determine which</span></div><div style="position:absolute;left:111px;top:256px;white-space:pre;"><span class="cls_0">one fired the event:</span></div><div style="position:absolute;left:111px;top:282px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">TwoButtonsPage </span><span class="cls_1">: </span><span class="cls_2">ContentPage</span></div><div style="position:absolute;left:111px;top:295px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:308px;white-space:pre;"><span class="cls_2">Button </span><span class="cls_1">addButton, removeButton;</span></div><div style="position:absolute;left:133px;top:322px;white-space:pre;"><span class="cls_2">StackLayout </span><span class="cls_1">loggerLayout = </span><span class="cls_4">new </span><span class="cls_2">StackLayout</span><span class="cls_1">();</span></div><div style="position:absolute;left:133px;top:348px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">TwoButtonsPage()</span></div><div style="position:absolute;left:133px;top:362px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:375px;white-space:pre;"><span class="cls_3">// Create the Button views and attach Clicked handlers.</span></div><div style="position:absolute;left:156px;top:388px;white-space:pre;"><span class="cls_1">addButton = </span><span class="cls_4">new </span><span class="cls_2">Button</span></div><div style="position:absolute;left:156px;top:402px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:415px;white-space:pre;"><span class="cls_1">Text = </span><span class="cls_6">"Add"</span><span class="cls_1">,</span></div><div style="position:absolute;left:178px;top:428px;white-space:pre;"><span class="cls_1">HorizontalOptions = </span><span class="cls_2">LayoutOptions</span><span class="cls_1">.CenterAndExpand</span></div><div style="position:absolute;left:156px;top:442px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:156px;top:455px;white-space:pre;"><span class="cls_1">addButton.Clicked += OnButtonClicked;</span></div><div style="position:absolute;left:156px;top:482px;white-space:pre;"><span class="cls_1">removeButton = </span><span class="cls_4">new </span><span class="cls_2">Button</span></div><div style="position:absolute;left:156px;top:495px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:508px;white-space:pre;"><span class="cls_1">Text = </span><span class="cls_6">"Remove"</span><span class="cls_1">,</span></div><div style="position:absolute;left:178px;top:522px;white-space:pre;"><span class="cls_1">HorizontalOptions = </span><span class="cls_2">LayoutOptions</span><span class="cls_1">.CenterAndExpand,</span></div><div style="position:absolute;left:178px;top:535px;white-space:pre;"><span class="cls_1">IsEnabled = </span><span class="cls_4">false</span></div><div style="position:absolute;left:156px;top:548px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:156px;top:562px;white-space:pre;"><span class="cls_1">removeButton.Clicked += OnButtonClicked;</span></div><div style="position:absolute;left:156px;top:588px;white-space:pre;"><span class="cls_4">this</span><span class="cls_1">.Padding = </span><span class="cls_4">new </span><span class="cls_2">Thickness</span><span class="cls_1">(5, </span><span class="cls_2">Device</span><span class="cls_1">.OnPlatform(20, 0, 0), 5, 0);</span></div><div style="position:absolute;left:156px;top:615px;white-space:pre;"><span class="cls_3">// Assemble the page.</span></div><div style="position:absolute;left:156px;top:628px;white-space:pre;"><span class="cls_4">this</span><span class="cls_1">.Content = </span><span class="cls_4">new </span><span class="cls_2">StackLayout</span></div><div style="position:absolute;left:156px;top:642px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:655px;white-space:pre;"><span class="cls_1">Children =</span></div><div style="position:absolute;left:178px;top:668px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:201px;top:682px;white-space:pre;"><span class="cls_4">new </span><span class="cls_2">StackLayout</span></div><div style="position:absolute;left:201px;top:695px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:223px;top:708px;white-space:pre;"><span class="cls_1">Orientation = </span><span class="cls_2">StackOrientation</span><span class="cls_1">.Horizontal,</span></div><div style="position:absolute;left:223px;top:722px;white-space:pre;"><span class="cls_1">Children =</span></div><div style="position:absolute;left:223px;top:735px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:246px;top:748px;white-space:pre;"><span class="cls_1">addButton,</span></div><div style="position:absolute;left:246px;top:762px;white-space:pre;"><span class="cls_1">removeButton</span></div><div style="position:absolute;left:223px;top:775px;white-space:pre;"><span class="cls_1">}</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 6</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Button clicks</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">118</span></div><div style="position:absolute;left:177px;top:71px;white-space:pre;"><span class="cls_1">},</span></div><div style="position:absolute;left:177px;top:98px;white-space:pre;"><span class="cls_4">new </span><span class="cls_2">ScrollView</span></div><div style="position:absolute;left:177px;top:111px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:199px;top:124px;white-space:pre;"><span class="cls_1">VerticalOptions = </span><span class="cls_2">LayoutOptions</span><span class="cls_1">.FillAndExpand,</span></div><div style="position:absolute;left:199px;top:138px;white-space:pre;"><span class="cls_1">Content = loggerLayout</span></div><div style="position:absolute;left:177px;top:151px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:154px;top:164px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:132px;top:178px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:109px;top:191px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:218px;white-space:pre;"><span class="cls_4">void </span><span class="cls_1">OnButtonClicked(</span><span class="cls_4">object </span><span class="cls_1">sender, </span><span class="cls_2">EventArgs </span><span class="cls_1">args)</span></div><div style="position:absolute;left:109px;top:231px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:244px;white-space:pre;"><span class="cls_2">Button </span><span class="cls_1">button = (</span><span class="cls_2">Button</span><span class="cls_1">)sender;</span></div><div style="position:absolute;left:132px;top:271px;white-space:pre;"><span class="cls_4">if </span><span class="cls_1">(button == addButton)</span></div><div style="position:absolute;left:132px;top:284px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:298px;white-space:pre;"><span class="cls_3">// Add Label to scrollable StackLayout.</span></div><div style="position:absolute;left:154px;top:311px;white-space:pre;"><span class="cls_1">loggerLayout.Children.Add(</span><span class="cls_4">new </span><span class="cls_2">Label</span></div><div style="position:absolute;left:154px;top:324px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:177px;top:338px;white-space:pre;"><span class="cls_1">Text = </span><span class="cls_6">"Button clicked at " </span><span class="cls_1">+ </span><span class="cls_2">DateTime</span><span class="cls_1">.Now.ToString(</span><span class="cls_6">"T"</span><span class="cls_1">)</span></div><div style="position:absolute;left:154px;top:351px;white-space:pre;"><span class="cls_1">});</span></div><div style="position:absolute;left:132px;top:364px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:132px;top:378px;white-space:pre;"><span class="cls_4">else</span></div><div style="position:absolute;left:132px;top:391px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:404px;white-space:pre;"><span class="cls_3">// Remove topmost Label from StackLayout.</span></div><div style="position:absolute;left:154px;top:418px;white-space:pre;"><span class="cls_1">loggerLayout.Children.RemoveAt(0);</span></div><div style="position:absolute;left:132px;top:431px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:132px;top:458px;white-space:pre;"><span class="cls_3">// Enable "Remove" button only if children are present.</span></div><div style="position:absolute;left:132px;top:471px;white-space:pre;"><span class="cls_1">removeButton.IsEnabled = loggerLayout.Children.Count > 0;</span></div><div style="position:absolute;left:109px;top:484px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:498px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:523px;white-space:pre;"><span class="cls_0">Both buttons are given a </span><span class="cls_5">HorizontalOptions</span><span class="cls_0">value of </span><span class="cls_5">CenterAndExpand</span><span class="cls_0">so that they can be dis-</span></div><div style="position:absolute;left:87px;top:540px;white-space:pre;"><span class="cls_0">played side by side at the top of the screen by using a horizontal </span><span class="cls_5">StackLayout</span><span class="cls_0">:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:111px;top:71px;width:492px;height:295px;z-index:0;"><img src="images\image73.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image74.png" width="708" height="864" alt=""></div><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 6</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Button clicks</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">119</span></div><div style="position:absolute;left:127px;top:374px;white-space:pre;"><span class="cls_0">Notice that when the </span><span class="cls_5">Clicked</span><span class="cls_0">handler detects </span><span class="cls_5">removeButton</span><span class="cls_0">, it simply calls the </span><span class="cls_5">RemoveAt</span></div><div style="position:absolute;left:111px;top:391px;white-space:pre;"><span class="cls_0">method on the </span><span class="cls_5">Children</span><span class="cls_0">property:</span></div><div style="position:absolute;left:111px;top:416px;white-space:pre;"><span class="cls_1">loggerLayout.Children.RemoveAt(0);</span></div><div style="position:absolute;left:111px;top:442px;white-space:pre;"><span class="cls_0">But what happens if t</span><span class="cls_0">here are no children? Won’t </span><span class="cls_5">RemoveAt</span><span class="cls_0">raise an exception?</span></div><div style="position:absolute;left:127px;top:468px;white-space:pre;"><span class="cls_0">It can’t happen! When the </span><span class="cls_13">TwoButtons</span><span class="cls_0"> </span><span class="cls_0">program begins, the </span><span class="cls_5">IsEnabled</span><span class="cls_0">property of the </span><span class="cls_5">remove-</span></div><div style="position:absolute;left:111px;top:486px;white-space:pre;"><span class="cls_5">Button</span><span class="cls_0">is initialized to </span><span class="cls_5">false</span><span class="cls_0">. When a button is disabled in this way, a dim appearance signals to the</span></div><div style="position:absolute;left:111px;top:503px;white-space:pre;"><span class="cls_0">user th</span><span class="cls_0">at it’s nonfunctional. It does not provide feedback to the user and it does not fire </span><span class="cls_5">Clicked</span></div><div style="position:absolute;left:111px;top:520px;white-space:pre;"><span class="cls_0">events. Toward the end of the </span><span class="cls_5">Clicked</span><span class="cls_0">handler, the </span><span class="cls_5">IsEnabled</span><span class="cls_0">property on </span><span class="cls_5">removeButton</span><span class="cls_0">is set to</span></div><div style="position:absolute;left:111px;top:538px;white-space:pre;"><span class="cls_5">true</span><span class="cls_0">only if the </span><span class="cls_5">loggerLayout</span><span class="cls_0">has at least one child.</span></div><div style="position:absolute;left:127px;top:564px;white-space:pre;"><span class="cls_0">This illustrates a good general rule: if your code needs to determine whether a button </span><span class="cls_5">Clicked</span></div><div style="position:absolute;left:111px;top:582px;white-space:pre;"><span class="cls_0">event is valid, it’s probably better to prevent invalid button clicks by disabling the button.</span></div><div style="position:absolute;left:79px;top:621px;white-space:pre;"><span class="cls_11">Anonymous</span><span class="cls_12"> </span><span class="cls_11">event</span><span class="cls_12"> </span><span class="cls_11">handlers</span></div><div style="position:absolute;left:111px;top:670px;white-space:pre;"><span class="cls_0">As with any event handler, you can define a </span><span class="cls_5">Clicked</span><span class="cls_0">handler as an anonymous lambda function.</span></div><div style="position:absolute;left:111px;top:687px;white-space:pre;"><span class="cls_0">Here’s a program named </span><span class="cls_13">ButtonLambdas</span><span class="cls_0"> </span><span class="cls_0">that has a </span><span class="cls_5">Label</span><span class="cls_0">displaying a number and two buttons.</span></div><div style="position:absolute;left:111px;top:704px;white-space:pre;"><span class="cls_0">One button doubles the number, and the other halves the number. Normally, the number and </span><span class="cls_5">Label</span></div><div style="position:absolute;left:111px;top:722px;white-space:pre;"><span class="cls_0">variables would be saved as fields. But because the anonymous event handlers are defined right in the</span></div><div style="position:absolute;left:111px;top:739px;white-space:pre;"><span class="cls_0">constructor after these variables are defined, the event handlers have access to these local variables:</span></div><div style="position:absolute;left:111px;top:764px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">ButtonLambdasPage </span><span class="cls_1">: </span><span class="cls_2">ContentPage</span></div><div style="position:absolute;left:111px;top:778px;white-space:pre;"><span class="cls_1">{</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 6</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Button clicks</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">120</span></div><div style="position:absolute;left:109px;top:71px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">ButtonLambdasPage()</span></div><div style="position:absolute;left:109px;top:84px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:98px;white-space:pre;"><span class="cls_3">// Number to manipulate.</span></div><div style="position:absolute;left:132px;top:111px;white-space:pre;"><span class="cls_4">double </span><span class="cls_1">number = 1;</span></div><div style="position:absolute;left:132px;top:138px;white-space:pre;"><span class="cls_3">// Create the Label for display.</span></div><div style="position:absolute;left:132px;top:151px;white-space:pre;"><span class="cls_2">Label </span><span class="cls_1">label = </span><span class="cls_4">new </span><span class="cls_2">Label</span></div><div style="position:absolute;left:132px;top:164px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:178px;white-space:pre;"><span class="cls_1">Text = number.ToString(),</span></div><div style="position:absolute;left:154px;top:191px;white-space:pre;"><span class="cls_1">FontSize = </span><span class="cls_2">Device</span><span class="cls_1">.GetNamedSize(</span><span class="cls_2">NamedSize</span><span class="cls_1">.Large, </span><span class="cls_4">typeof</span><span class="cls_1">(</span><span class="cls_2">Label</span><span class="cls_1">)),</span></div><div style="position:absolute;left:154px;top:204px;white-space:pre;"><span class="cls_1">HorizontalOptions = </span><span class="cls_2">LayoutOptions</span><span class="cls_1">.Center,</span></div><div style="position:absolute;left:154px;top:218px;white-space:pre;"><span class="cls_1">VerticalOptions = </span><span class="cls_2">LayoutOptions</span><span class="cls_1">.CenterAndExpand</span></div><div style="position:absolute;left:132px;top:231px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:132px;top:258px;white-space:pre;"><span class="cls_3">// Create the first Button and attach Clicked handler.</span></div><div style="position:absolute;left:132px;top:271px;white-space:pre;"><span class="cls_2">Button </span><span class="cls_1">timesButton = </span><span class="cls_4">new </span><span class="cls_2">Button</span></div><div style="position:absolute;left:132px;top:284px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:298px;white-space:pre;"><span class="cls_1">Text = </span><span class="cls_6">"Double"</span><span class="cls_1">,</span></div><div style="position:absolute;left:154px;top:311px;white-space:pre;"><span class="cls_1">FontSize = </span><span class="cls_2">Device</span><span class="cls_1">.GetNamedSize(</span><span class="cls_2">NamedSize</span><span class="cls_1">.Large, </span><span class="cls_4">typeof</span><span class="cls_1">(</span><span class="cls_2">Button</span><span class="cls_1">)),</span></div><div style="position:absolute;left:154px;top:324px;white-space:pre;"><span class="cls_1">HorizontalOptions = </span><span class="cls_2">LayoutOptions</span><span class="cls_1">.CenterAndExpand</span></div><div style="position:absolute;left:132px;top:338px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:132px;top:351px;white-space:pre;"><span class="cls_1">timesButton.Clicked += (sender, args) =></span></div><div style="position:absolute;left:132px;top:364px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:378px;white-space:pre;"><span class="cls_1">number *= 2;</span></div><div style="position:absolute;left:154px;top:391px;white-space:pre;"><span class="cls_1">label.Text = number.ToString();</span></div><div style="position:absolute;left:132px;top:404px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:132px;top:431px;white-space:pre;"><span class="cls_3">// Create the second Button and attach Clicked handler.</span></div><div style="position:absolute;left:132px;top:444px;white-space:pre;"><span class="cls_2">Button </span><span class="cls_1">divideButton = </span><span class="cls_4">new </span><span class="cls_2">Button</span></div><div style="position:absolute;left:132px;top:458px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:471px;white-space:pre;"><span class="cls_1">Text = </span><span class="cls_6">"Half"</span><span class="cls_1">,</span></div><div style="position:absolute;left:154px;top:484px;white-space:pre;"><span class="cls_1">FontSize = </span><span class="cls_2">Device</span><span class="cls_1">.GetNamedSize(</span><span class="cls_2">NamedSize</span><span class="cls_1">.Large, </span><span class="cls_4">typeof</span><span class="cls_1">(</span><span class="cls_2">Button</span><span class="cls_1">)),</span></div><div style="position:absolute;left:154px;top:498px;white-space:pre;"><span class="cls_1">HorizontalOptions = </span><span class="cls_2">LayoutOptions</span><span class="cls_1">.CenterAndExpand</span></div><div style="position:absolute;left:132px;top:511px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:132px;top:524px;white-space:pre;"><span class="cls_1">divideButton.Clicked += (sender, args) =></span></div><div style="position:absolute;left:132px;top:538px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:551px;white-space:pre;"><span class="cls_1">number /= 2;</span></div><div style="position:absolute;left:154px;top:564px;white-space:pre;"><span class="cls_1">label.Text = number.ToString();</span></div><div style="position:absolute;left:132px;top:578px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:132px;top:604px;white-space:pre;"><span class="cls_3">// Assemble the page.</span></div><div style="position:absolute;left:132px;top:618px;white-space:pre;"><span class="cls_4">this</span><span class="cls_1">.Content = </span><span class="cls_4">new </span><span class="cls_2">StackLayout</span></div><div style="position:absolute;left:132px;top:631px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:644px;white-space:pre;"><span class="cls_1">Children =</span></div><div style="position:absolute;left:154px;top:658px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:177px;top:671px;white-space:pre;"><span class="cls_1">label,</span></div><div style="position:absolute;left:177px;top:684px;white-space:pre;"><span class="cls_4">new </span><span class="cls_2">StackLayout</span></div><div style="position:absolute;left:177px;top:698px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:199px;top:711px;white-space:pre;"><span class="cls_1">Orientation = </span><span class="cls_2">StackOrientation</span><span class="cls_1">.Horizontal,</span></div><div style="position:absolute;left:199px;top:724px;white-space:pre;"><span class="cls_1">VerticalOptions = </span><span class="cls_2">LayoutOptions</span><span class="cls_1">.CenterAndExpand,</span></div><div style="position:absolute;left:199px;top:738px;white-space:pre;"><span class="cls_1">Children =</span></div><div style="position:absolute;left:199px;top:751px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:222px;top:764px;white-space:pre;"><span class="cls_1">timesButton,</span></div><div style="position:absolute;left:222px;top:778px;white-space:pre;"><span class="cls_1">divideButton</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:111px;top:252px;width:492px;height:295px;z-index:0;"><img src="images\image75.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image76.png" width="708" height="864" alt=""></div><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 6</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Button clicks</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">121</span></div><div style="position:absolute;left:223px;top:71px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:201px;top:84px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:178px;top:98px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:156px;top:111px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:133px;top:124px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:138px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:163px;white-space:pre;"><span class="cls_0">Notice the use of </span><span class="cls_5">Device.GetNamedSize</span><span class="cls_0">to get large text for both the </span><span class="cls_5">Label</span><span class="cls_0">and the </span><span class="cls_5">Button</span><span class="cls_0">. When</span></div><div style="position:absolute;left:111px;top:180px;white-space:pre;"><span class="cls_0">used with </span><span class="cls_5">Label</span><span class="cls_0">, the second argument of </span><span class="cls_5">GetNamedSize</span><span class="cls_0">should indicate a </span><span class="cls_5">Label</span><span class="cls_0">, and when used</span></div><div style="position:absolute;left:111px;top:198px;white-space:pre;"><span class="cls_0">with the </span><span class="cls_5">Button</span><span class="cls_0">it should indicate a </span><span class="cls_5">Button</span><span class="cls_0">. The sizes for the two elements might be different.</span></div><div style="position:absolute;left:127px;top:224px;white-space:pre;"><span class="cls_0">Like the previous program, the two buttons share a horizontal </span><span class="cls_5">StackLayout</span><span class="cls_0">:</span></div><div style="position:absolute;left:127px;top:555px;white-space:pre;"><span class="cls_0">The disadvantage of defining event handlers as anonymous lambda functions is that they can’t be</span></div><div style="position:absolute;left:111px;top:572px;white-space:pre;"><span class="cls_0">shared among multiple views. (Actually they can, but some messy reflection code is involved.)</span></div><div style="position:absolute;left:79px;top:612px;white-space:pre;"><span class="cls_11">Distinguishing</span><span class="cls_12"> </span><span class="cls_11">views</span><span class="cls_12"> </span><span class="cls_11">with</span><span class="cls_12"> </span><span class="cls_11">IDs</span></div><div style="position:absolute;left:111px;top:660px;white-space:pre;"><span class="cls_0">In the </span><span class="cls_13">TwoButtons</span><span class="cls_0"> </span><span class="cls_0">program, you saw a technique for sharing an event handler that distinguishes</span></div><div style="position:absolute;left:111px;top:678px;white-space:pre;"><span class="cls_0">views by comparing objects. This works fine when there aren’t very many views to distinguish, but it</span></div><div style="position:absolute;left:111px;top:695px;white-space:pre;"><span class="cls_0">would be a terrible approach for a calculator program.</span></div><div style="position:absolute;left:127px;top:722px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">Element</span><span class="cls_0">class defines a </span><span class="cls_5">StyleId</span><span class="cls_0">property of type </span><span class="cls_5">string</span><span class="cls_0">specifically for the purpose of iden-</span></div><div style="position:absolute;left:111px;top:739px;white-space:pre;"><span class="cls_0">tifying views. It’s not used for anything internal to Xamarin.Forms</span><span class="cls_0">, so you can set it to whatever is con-</span></div><div style="position:absolute;left:111px;top:756px;white-space:pre;"><span class="cls_0">venient for the application. You can test the values by using </span><span class="cls_5">if</span><span class="cls_0">and </span><span class="cls_5">else</span><span class="cls_0">statements or in a </span><span class="cls_5">switch</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 6</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Button clicks</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">122</span></div><div style="position:absolute;left:87px;top:72px;white-space:pre;"><span class="cls_0">and </span><span class="cls_5">case</span><span class="cls_0">block, or you can use a </span><span class="cls_5">Parse</span><span class="cls_0">method to convert the strings into numbers or enumeration</span></div><div style="position:absolute;left:87px;top:90px;white-space:pre;"><span class="cls_0">members.</span></div><div style="position:absolute;left:103px;top:116px;white-space:pre;"><span class="cls_0">The following program isn’t a calculator, but it is a numer</span><span class="cls_0">ic keypad, which is certainly part of a cal-</span></div><div style="position:absolute;left:87px;top:134px;white-space:pre;"><span class="cls_0">culator. The program is called </span><span class="cls_13">SimplestKeypad</span><span class="cls_0"> </span><span class="cls_0">and uses a </span><span class="cls_5">StackLayout</span><span class="cls_0">for organizing the rows and</span></div><div style="position:absolute;left:87px;top:151px;white-space:pre;"><span class="cls_0">columns of keys. (One of the intents of this program is to demonstrate that </span><span class="cls_5">StackLayout</span><span class="cls_0">is not quite</span></div><div style="position:absolute;left:87px;top:168px;white-space:pre;"><span class="cls_0">the right tool for this job!)</span></div><div style="position:absolute;left:103px;top:195px;white-space:pre;"><span class="cls_0">The program creates a total of five </span><span class="cls_5">StackLayout</span><span class="cls_0">instances. The </span><span class="cls_5">mainStack</span><span class="cls_0">is vertically oriented,</span></div><div style="position:absolute;left:87px;top:212px;white-space:pre;"><span class="cls_0">and four horizontal </span><span class="cls_5">StackLayout</span><span class="cls_0">objects arrange the 10 digit buttons. To keep things simple, the key-</span></div><div style="position:absolute;left:87px;top:230px;white-space:pre;"><span class="cls_0">pad is arranged with telephone ordering rather than calculator ordering:</span></div><div style="position:absolute;left:87px;top:255px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">SimplestKeypadPage </span><span class="cls_1">: </span><span class="cls_2">ContentPage</span></div><div style="position:absolute;left:87px;top:268px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:282px;white-space:pre;"><span class="cls_2">Label </span><span class="cls_1">displayLabel;</span></div><div style="position:absolute;left:109px;top:295px;white-space:pre;"><span class="cls_2">Button </span><span class="cls_1">backspaceButton;</span></div><div style="position:absolute;left:109px;top:322px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">SimplestKeypadPage()</span></div><div style="position:absolute;left:109px;top:335px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:348px;white-space:pre;"><span class="cls_3">// Create a vertical stack for the entire keypad.</span></div><div style="position:absolute;left:132px;top:362px;white-space:pre;"><span class="cls_2">StackLayout </span><span class="cls_1">mainStack = </span><span class="cls_4">new </span><span class="cls_2">StackLayout</span></div><div style="position:absolute;left:132px;top:375px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:388px;white-space:pre;"><span class="cls_1">VerticalOptions = </span><span class="cls_2">LayoutOptions</span><span class="cls_1">.Center,</span></div><div style="position:absolute;left:154px;top:402px;white-space:pre;"><span class="cls_1">HorizontalOptions = </span><span class="cls_2">LayoutOptions</span><span class="cls_1">.Center</span></div><div style="position:absolute;left:132px;top:415px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:132px;top:442px;white-space:pre;"><span class="cls_3">// First row is the Label.</span></div><div style="position:absolute;left:132px;top:455px;white-space:pre;"><span class="cls_1">displayLabel = </span><span class="cls_4">new </span><span class="cls_2">Label</span></div><div style="position:absolute;left:132px;top:468px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:482px;white-space:pre;"><span class="cls_1">FontSize = </span><span class="cls_2">Device</span><span class="cls_1">.GetNamedSize(</span><span class="cls_2">NamedSize</span><span class="cls_1">.Large, </span><span class="cls_4">typeof</span><span class="cls_1">(</span><span class="cls_2">Label</span><span class="cls_1">)),</span></div><div style="position:absolute;left:154px;top:495px;white-space:pre;"><span class="cls_1">VerticalOptions = </span><span class="cls_2">LayoutOptions</span><span class="cls_1">.Center,</span></div><div style="position:absolute;left:154px;top:508px;white-space:pre;"><span class="cls_1">HorizontalTextAlignment = </span><span class="cls_2">TextAlignment</span><span class="cls_1">.End</span></div><div style="position:absolute;left:132px;top:522px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:132px;top:535px;white-space:pre;"><span class="cls_1">mainStack.Children.Add(displayLabel);</span></div><div style="position:absolute;left:132px;top:562px;white-space:pre;"><span class="cls_3">// Second row is the backspace Button.</span></div><div style="position:absolute;left:132px;top:575px;white-space:pre;"><span class="cls_1">backspaceButton = </span><span class="cls_4">new </span><span class="cls_2">Button</span></div><div style="position:absolute;left:132px;top:588px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:602px;white-space:pre;"><span class="cls_1">Text = </span><span class="cls_6">"\u21E6"</span><span class="cls_1">,</span></div><div style="position:absolute;left:154px;top:615px;white-space:pre;"><span class="cls_1">FontSize = </span><span class="cls_2">Device</span><span class="cls_1">.GetNamedSize(</span><span class="cls_2">NamedSize</span><span class="cls_1">.Large, </span><span class="cls_4">typeof</span><span class="cls_1">(</span><span class="cls_2">Button</span><span class="cls_1">)),</span></div><div style="position:absolute;left:154px;top:628px;white-space:pre;"><span class="cls_1">IsEnabled = </span><span class="cls_4">false</span></div><div style="position:absolute;left:132px;top:642px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:132px;top:655px;white-space:pre;"><span class="cls_1">backspaceButton.Clicked += OnBackspaceButtonClicked;</span></div><div style="position:absolute;left:132px;top:668px;white-space:pre;"><span class="cls_1">mainStack.Children.Add(backspaceButton);</span></div><div style="position:absolute;left:132px;top:695px;white-space:pre;"><span class="cls_3">// Now do the 10 number keys.</span></div><div style="position:absolute;left:132px;top:708px;white-space:pre;"><span class="cls_2">StackLayout </span><span class="cls_1">rowStack = </span><span class="cls_4">null</span><span class="cls_1">;</span></div><div style="position:absolute;left:132px;top:735px;white-space:pre;"><span class="cls_4">for </span><span class="cls_1">(</span><span class="cls_4">int </span><span class="cls_1">num = 1; num <= 10; num++)</span></div><div style="position:absolute;left:132px;top:748px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:762px;white-space:pre;"><span class="cls_4">if </span><span class="cls_1">((num - 1) % 3 == 0)</span></div><div style="position:absolute;left:154px;top:775px;white-space:pre;"><span class="cls_1">{</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 6</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Button clicks</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">123</span></div><div style="position:absolute;left:201px;top:71px;white-space:pre;"><span class="cls_1">rowStack = </span><span class="cls_4">new </span><span class="cls_2">StackLayout</span></div><div style="position:absolute;left:201px;top:84px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:223px;top:98px;white-space:pre;"><span class="cls_1">Orientation = </span><span class="cls_2">StackOrientation</span><span class="cls_1">.Horizontal</span></div><div style="position:absolute;left:201px;top:111px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:201px;top:124px;white-space:pre;"><span class="cls_1">mainStack.Children.Add(rowStack);</span></div><div style="position:absolute;left:178px;top:138px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:178px;top:164px;white-space:pre;"><span class="cls_2">Button </span><span class="cls_1">digitButton = </span><span class="cls_4">new </span><span class="cls_2">Button</span></div><div style="position:absolute;left:178px;top:178px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:201px;top:191px;white-space:pre;"><span class="cls_1">Text = (num % 10).ToString(),</span></div><div style="position:absolute;left:201px;top:204px;white-space:pre;"><span class="cls_1">FontSize = </span><span class="cls_2">Device</span><span class="cls_1">.GetNamedSize(</span><span class="cls_2">NamedSize</span><span class="cls_1">.Large, </span><span class="cls_4">typeof</span><span class="cls_1">(</span><span class="cls_2">Button</span><span class="cls_1">)),</span></div><div style="position:absolute;left:201px;top:218px;white-space:pre;"><span class="cls_1">StyleId = (num % 10).ToString()</span></div><div style="position:absolute;left:178px;top:231px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:178px;top:244px;white-space:pre;"><span class="cls_1">digitButton.Clicked += OnDigitButtonClicked;</span></div><div style="position:absolute;left:178px;top:271px;white-space:pre;"><span class="cls_3">// For the zero button, expand to fill horizontally.</span></div><div style="position:absolute;left:178px;top:284px;white-space:pre;"><span class="cls_4">if </span><span class="cls_1">(num == 10)</span></div><div style="position:absolute;left:178px;top:298px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:201px;top:311px;white-space:pre;"><span class="cls_1">digitButton.HorizontalOptions = </span><span class="cls_2">LayoutOptions</span><span class="cls_1">.FillAndExpand;</span></div><div style="position:absolute;left:178px;top:324px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:178px;top:338px;white-space:pre;"><span class="cls_1">rowStack.Children.Add(digitButton);</span></div><div style="position:absolute;left:156px;top:351px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:156px;top:378px;white-space:pre;"><span class="cls_4">this</span><span class="cls_1">.Content = mainStack;</span></div><div style="position:absolute;left:133px;top:391px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:133px;top:418px;white-space:pre;"><span class="cls_4">void </span><span class="cls_1">OnDigitButtonClicked(</span><span class="cls_4">object </span><span class="cls_1">sender, </span><span class="cls_2">EventArgs </span><span class="cls_1">args)</span></div><div style="position:absolute;left:133px;top:431px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:444px;white-space:pre;"><span class="cls_2">Button </span><span class="cls_1">button = (</span><span class="cls_2">Button</span><span class="cls_1">)sender;</span></div><div style="position:absolute;left:156px;top:458px;white-space:pre;"><span class="cls_1">displayLabel.Text += (</span><span class="cls_4">string</span><span class="cls_1">)button.StyleId;</span></div><div style="position:absolute;left:156px;top:471px;white-space:pre;"><span class="cls_1">backspaceButton.IsEnabled = </span><span class="cls_4">true</span><span class="cls_1">;</span></div><div style="position:absolute;left:133px;top:484px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:133px;top:511px;white-space:pre;"><span class="cls_4">void </span><span class="cls_1">OnBackspaceButtonClicked(</span><span class="cls_4">object </span><span class="cls_1">sender, </span><span class="cls_2">EventArgs </span><span class="cls_1">args)</span></div><div style="position:absolute;left:133px;top:524px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:538px;white-space:pre;"><span class="cls_4">string </span><span class="cls_1">text = displayLabel.Text;</span></div><div style="position:absolute;left:156px;top:551px;white-space:pre;"><span class="cls_1">displayLabel.Text = text.Substring(0, text.Length - 1);</span></div><div style="position:absolute;left:156px;top:564px;white-space:pre;"><span class="cls_1">backspaceButton.IsEnabled = displayLabel.Text.Length > 0;</span></div><div style="position:absolute;left:133px;top:578px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:591px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:127px;top:616px;white-space:pre;"><span class="cls_0">The 10 number keys share a single </span><span class="cls_5">Clicked</span><span class="cls_0">handler. The </span><span class="cls_5">StyleId</span><span class="cls_0">property indicates the number</span></div><div style="position:absolute;left:111px;top:634px;white-space:pre;"><span class="cls_0">associated with the key, so the program can simply append that number to the string displayed by the</span></div><div style="position:absolute;left:111px;top:651px;white-space:pre;"><span class="cls_5">Label</span><span class="cls_0">. The </span><span class="cls_5">StyleId</span><span class="cls_0">happens to be identical to the </span><span class="cls_5">Text</span><span class="cls_0">property of the </span><span class="cls_5">Button</span><span class="cls_0">, and the </span><span class="cls_5">Text</span><span class="cls_0">prop-</span></div><div style="position:absolute;left:111px;top:668px;white-space:pre;"><span class="cls_0">erty </span><span class="cls_0">could be used instead, but in the general case, things aren’t always quite that convenient.</span></div><div style="position:absolute;left:127px;top:695px;white-space:pre;"><span class="cls_0">The backspace </span><span class="cls_5">Button</span><span class="cls_0">is sufficiently different in function to warrant its own </span><span class="cls_5">Clicked</span><span class="cls_0">handler, al-</span></div><div style="position:absolute;left:111px;top:712px;white-space:pre;"><span class="cls_0">though it would surely be possible to combine the two methods into one to take advantage of any</span></div><div style="position:absolute;left:111px;top:730px;white-space:pre;"><span class="cls_0">code they might have in common.</span></div><div style="position:absolute;left:127px;top:756px;white-space:pre;"><span class="cls_0">To give the keypad a slightly larger size, all the text is given a </span><span class="cls_5">FontSize</span><span class="cls_0">using </span><span class="cls_5">NamedSize.Large</span><span class="cls_0">.</span></div><div style="position:absolute;left:111px;top:774px;white-space:pre;"><span class="cls_0">Here are the three renderings of the </span><span class="cls_13">SimplestKeypad</span><span class="cls_0"> </span><span class="cls_0">program:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:87px;top:71px;width:492px;height:295px;z-index:0;"><img src="images\image77.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image78.png" width="708" height="864" alt=""></div><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 6</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Button clicks</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">124</span></div><div style="position:absolute;left:103px;top:374px;white-space:pre;"><span class="cls_0">Of course, you’ll want to press </span><span class="cls_0">the keys repeatedly until you see how the program responds to a</span></div><div style="position:absolute;left:87px;top:391px;white-space:pre;"><span class="cls_0">really large string of digits, and you’ll discover that it doesn’t adequately anticipate such a thing. When</span></div><div style="position:absolute;left:87px;top:408px;white-space:pre;"><span class="cls_0">the </span><span class="cls_5">Label</span><span class="cls_0">gets too wide, it begins to govern the overall width of the vertical </span><span class="cls_5">StackLayout</span><span class="cls_0">, and the</span></div><div style="position:absolute;left:87px;top:426px;white-space:pre;"><span class="cls_0">buttons start shifting as well.</span></div><div style="position:absolute;left:103px;top:452px;white-space:pre;"><span class="cls_0">Moreover, if the buttons contain letters or symbols rather than numbers, the buttons will be</span></div><div style="position:absolute;left:87px;top:470px;white-space:pre;"><span class="cls_0">misaligned because each button width is based on its content.</span></div><div style="position:absolute;left:103px;top:496px;white-space:pre;"><span class="cls_0">Can you fix this problem with the </span><span class="cls_5">Expands</span><span class="cls_0">flag on the </span><span class="cls_5">HorizontalOptions</span><span class="cls_0">property? No. The</span></div><div style="position:absolute;left:87px;top:514px;white-space:pre;"><span class="cls_5">Expands</span><span class="cls_0">flag causes extra space to be distributed equally among the views in the </span><span class="cls_5">StackLayout</span><span class="cls_0">. Each</span></div><div style="position:absolute;left:87px;top:531px;white-space:pre;"><span class="cls_0">view will increase additively by the same amount, but the buttons start out with different widths, and</span></div><div style="position:absolute;left:87px;top:548px;white-space:pre;"><span class="cls_0">they will always have different widths. For example, take a look at the two buttons in the </span><span class="cls_13">TwoButtons</span></div><div style="position:absolute;left:87px;top:566px;white-space:pre;"><span class="cls_0">or </span><span class="cls_13">ButtonLambdas</span><span class="cls_0"> </span><span class="cls_0">program. Those buttons have their </span><span class="cls_5">HorizontalOptions</span><span class="cls_0">properties set to </span><span class="cls_5">Fill-</span></div><div style="position:absolute;left:87px;top:583px;white-space:pre;"><span class="cls_5">AndExpand</span><span class="cls_0">, but they are different widths because the width of the button content is different.</span></div><div style="position:absolute;left:103px;top:610px;white-space:pre;"><span class="cls_0">A better solution for these programs is the layout known as the </span><span class="cls_5">Grid</span><span class="cls_0">, coming up in Chapter 17.</span></div><div style="position:absolute;left:55px;top:649px;white-space:pre;"><span class="cls_11">Saving</span><span class="cls_12"> </span><span class="cls_11">transient</span><span class="cls_12"> </span><span class="cls_11">data</span></div><div style="position:absolute;left:87px;top:698px;white-space:pre;"><span class="cls_0">Suppose you’re entering an important number in the </span><span class="cls_13">SimplestKeypad</span><span class="cls_0"> </span><span class="cls_0">program and you’re inter-</span></div><div style="position:absolute;left:87px;top:715px;white-space:pre;"><span class="cls_0">rupted</span><span class="cls_0">—</span><span class="cls_0">perhaps with a phone call. Later on, you shut off the phone, effectively terminating the</span></div><div style="position:absolute;left:87px;top:732px;white-space:pre;"><span class="cls_0">program.</span></div><div style="position:absolute;left:103px;top:759px;white-space:pre;"><span class="cls_0">What should happen the next time you run </span><span class="cls_13">SimplestKeypad</span><span class="cls_0">? Should the long string of numbers</span></div><div style="position:absolute;left:87px;top:776px;white-space:pre;"><span class="cls_0">you entered earlier be discarded? Or should it seem as though the program resumed from the state</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 6</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Button clicks</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">125</span></div><div style="position:absolute;left:111px;top:72px;white-space:pre;"><span class="cls_0">you last left it? Of course, it doesn’t matter for a simple demo program like </span><span class="cls_13">SimplestKeypad</span><span class="cls_0">, but in</span></div><div style="position:absolute;left:111px;top:90px;white-space:pre;"><span class="cls_0">the general case, users expect mobile applications to remember exactly what they were doing the last</span></div><div style="position:absolute;left:111px;top:107px;white-space:pre;"><span class="cls_0">time they interacted with the program.</span></div><div style="position:absolute;left:127px;top:134px;white-space:pre;"><span class="cls_0">For this reason, the </span><span class="cls_5">Application</span><span class="cls_0">class supports two facilities that help the program save and re-</span></div><div style="position:absolute;left:111px;top:151px;white-space:pre;"><span class="cls_0">store data:</span></div><div style="position:absolute;left:125px;top:177px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:178px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">Properties</span><span class="cls_0">property of </span><span class="cls_5">Application</span><span class="cls_0">is a dictionary with </span><span class="cls_5">string</span><span class="cls_0">keys and </span><span class="cls_5">object</span></div><div style="position:absolute;left:149px;top:195px;white-space:pre;"><span class="cls_0">items. The contents of this dictionary are automatically saved prior to the application being ter-</span></div><div style="position:absolute;left:149px;top:212px;white-space:pre;"><span class="cls_0">minated, and the saved contents become available the next time the application runs.</span></div><div style="position:absolute;left:125px;top:238px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:239px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">Application</span><span class="cls_0">class defines three protected virtual methods, named </span><span class="cls_5">OnStart</span><span class="cls_0">, </span><span class="cls_5">OnSleep</span><span class="cls_0">,</span></div><div style="position:absolute;left:149px;top:256px;white-space:pre;"><span class="cls_0">and </span><span class="cls_5">OnResume</span><span class="cls_0">, and the </span><span class="cls_5">App</span><span class="cls_0">class generated by the Xamarin.Forms template overrides these</span></div><div style="position:absolute;left:149px;top:274px;white-space:pre;"><span class="cls_0">methods. These methods help an application deal with what are known as </span><span class="cls_9">application</span><span class="cls_0"> </span><span class="cls_9">lifecycle</span></div><div style="position:absolute;left:149px;top:291px;white-space:pre;"><span class="cls_0">events.</span></div><div style="position:absolute;left:127px;top:318px;white-space:pre;"><span class="cls_0">To use these facilities, you need to identify what information your application needs to save so that</span></div><div style="position:absolute;left:111px;top:335px;white-space:pre;"><span class="cls_0">it can restore its state after being terminated and restarted. In general, this is a combination of </span><span class="cls_9">applica-</span></div><div style="position:absolute;left:111px;top:352px;white-space:pre;"><span class="cls_9">tion</span><span class="cls_0"> </span><span class="cls_9">settings</span><span class="cls_0">—</span><span class="cls_0">such as colors and font sizes that the user might be given an opportunity to set</span><span class="cls_0">—</span><span class="cls_0">and</span></div><div style="position:absolute;left:111px;top:370px;white-space:pre;"><span class="cls_9">transient</span><span class="cls_0"> </span><span class="cls_9">data</span><span class="cls_0">, such as half-entered entry fields. Application settings usually apply to the entire applica-</span></div><div style="position:absolute;left:111px;top:387px;white-space:pre;"><span class="cls_0">tion, while transient data is unique to each page in the application. If each item of this data is an entry</span></div><div style="position:absolute;left:111px;top:404px;white-space:pre;"><span class="cls_0">in the </span><span class="cls_5">Properties</span><span class="cls_0">dictionary, each item needs a dictionary key. However, if a program needs to save</span></div><div style="position:absolute;left:111px;top:422px;white-space:pre;"><span class="cls_0">a large file such as a word-</span><span class="cls_0">processing document, it shouldn’t use the </span><span class="cls_5">Properties</span><span class="cls_0">dictionary, but in-</span></div><div style="position:absolute;left:111px;top:439px;white-space:pre;"><span class="cls_0">stead should access the platform’s file system directly. (That’s a job for Chapter 20, “Async and file</span></div><div style="position:absolute;left:111px;top:456px;white-space:pre;"><span class="cls_0">I/O.”)</span></div><div style="position:absolute;left:127px;top:483px;white-space:pre;"><span class="cls_0">Also, you should restrict the data types used with </span><span class="cls_5">Properties</span><span class="cls_0">to the basic data types supported by</span></div><div style="position:absolute;left:111px;top:500px;white-space:pre;"><span class="cls_0">.NET and C#, such as </span><span class="cls_5">string</span><span class="cls_0">, </span><span class="cls_5">int</span><span class="cls_0">, and </span><span class="cls_5">double</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:527px;white-space:pre;"><span class="cls_0">The </span><span class="cls_13">SimplestKeypad</span><span class="cls_0"> </span><span class="cls_0">program needs to save only a single item of transient data, and the dictionary</span></div><div style="position:absolute;left:111px;top:544px;white-space:pre;"><span class="cls_0">key “displayLabelText” seems reasonable.</span></div><div style="position:absolute;left:127px;top:571px;white-space:pre;"><span class="cls_0">Sometimes a program can use the </span><span class="cls_5">Properties</span><span class="cls_0">dictionary to save and retrieve data without getting</span></div><div style="position:absolute;left:111px;top:588px;white-space:pre;"><span class="cls_0">involved with application lifecycle events. For example, the </span><span class="cls_13">SimplestKeypad</span><span class="cls_0"> </span><span class="cls_0">program knows exactly</span></div><div style="position:absolute;left:111px;top:606px;white-space:pre;"><span class="cls_0">when the </span><span class="cls_5">Text</span><span class="cls_0">property of </span><span class="cls_5">displayLabel</span><span class="cls_0">changes. It happens only in the two </span><span class="cls_5">Clicked</span><span class="cls_0">event han-</span></div><div style="position:absolute;left:111px;top:623px;white-space:pre;"><span class="cls_0">dlers for the number keys and the delete key. Those two event handlers could simply store the new</span></div><div style="position:absolute;left:111px;top:640px;white-space:pre;"><span class="cls_0">value in the </span><span class="cls_5">Properties</span><span class="cls_0">dictionary.</span></div><div style="position:absolute;left:127px;top:667px;white-space:pre;"><span class="cls_0">But wait: </span><span class="cls_5">Properties</span><span class="cls_0">is a property of the </span><span class="cls_5">Application</span><span class="cls_0">class. Do we need to save the instance of</span></div><div style="position:absolute;left:111px;top:684px;white-space:pre;"><span class="cls_0">the </span><span class="cls_5">App</span><span class="cls_0">class so that code in the </span><span class="cls_5">SimplestKeypadPage</span><span class="cls_0">can get access to the dictionary? No, it’s not</span></div><div style="position:absolute;left:111px;top:702px;white-space:pre;"><span class="cls_0">necessary. </span><span class="cls_5">Application</span><span class="cls_0">defines a static property named </span><span class="cls_5">Current</span><span class="cls_0">that returns the current applica-</span></div><div style="position:absolute;left:111px;top:719px;white-space:pre;"><span class="cls_0">tion’s instance of the </span><span class="cls_5">Application</span><span class="cls_0">class.</span></div><div style="position:absolute;left:127px;top:746px;white-space:pre;"><span class="cls_0">To store the </span><span class="cls_5">Text</span><span class="cls_0">property of the </span><span class="cls_5">Label</span><span class="cls_0">in the dictionary, simply add the following line at the bot-</span></div><div style="position:absolute;left:111px;top:763px;white-space:pre;"><span class="cls_0">tom of the two </span><span class="cls_5">Clicked</span><span class="cls_0">event handlers in </span><span class="cls_13">SimplestKeypad</span><span class="cls_0">:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 6</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Button clicks</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">126</span></div><div style="position:absolute;left:87px;top:71px;white-space:pre;"><span class="cls_2">Application</span><span class="cls_1">.Current.Properties[</span><span class="cls_6">"displayLabelText"</span><span class="cls_1">] = displayLabel.Text;</span></div><div style="position:absolute;left:87px;top:96px;white-space:pre;"><span class="cls_0">Don’t worry if the </span><span class="cls_5">displayLabelText</span><span class="cls_0">key does not yet exist in the dictionary: The </span><span class="cls_5">Properties</span><span class="cls_0">dic-</span></div><div style="position:absolute;left:87px;top:114px;white-space:pre;"><span class="cls_0">tionary implements the generic </span><span class="cls_5">IDictionary</span><span class="cls_0">interface, which explicitly defines the indexer to replace</span></div><div style="position:absolute;left:87px;top:131px;white-space:pre;"><span class="cls_0">the previous item if the key already exists or to add a new item to the dictionary if the key does not</span></div><div style="position:absolute;left:87px;top:148px;white-space:pre;"><span class="cls_0">exist. That behavior is exactly what you want here.</span></div><div style="position:absolute;left:103px;top:175px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">SimplestKeypadPage</span><span class="cls_0">constructor can then conclude by initializing the </span><span class="cls_5">Text</span><span class="cls_0">property of the</span></div><div style="position:absolute;left:87px;top:192px;white-space:pre;"><span class="cls_5">Label</span><span class="cls_0">with the following code, which retrieves the item from the dictionary:</span></div><div style="position:absolute;left:87px;top:218px;white-space:pre;"><span class="cls_2">IDictionary</span><span class="cls_1"><</span><span class="cls_4">string</span><span class="cls_1">, </span><span class="cls_4">object</span><span class="cls_1">> properties = </span><span class="cls_2">Application</span><span class="cls_1">.Current.Properties;</span></div><div style="position:absolute;left:87px;top:244px;white-space:pre;"><span class="cls_4">if </span><span class="cls_1">(properties.ContainsKey(</span><span class="cls_6">"displayLabelText"</span><span class="cls_1">))</span></div><div style="position:absolute;left:87px;top:258px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:271px;white-space:pre;"><span class="cls_1">displayLabel.Text = properties[</span><span class="cls_6">"displayLabelText"</span><span class="cls_1">] </span><span class="cls_4">as string</span><span class="cls_1">;</span></div><div style="position:absolute;left:109px;top:284px;white-space:pre;"><span class="cls_1">backspaceButton.IsEnabled = displayLabel.Text.Length > 0;</span></div><div style="position:absolute;left:87px;top:298px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:103px;top:323px;white-space:pre;"><span class="cls_0">This is all your application needs to do: just save information in the </span><span class="cls_5">Properties</span><span class="cls_0">dictionary and re-</span></div><div style="position:absolute;left:87px;top:340px;white-space:pre;"><span class="cls_0">trieve it. Xamarin.Forms itself is responsible for the job of saving and loading the contents of the dic-</span></div><div style="position:absolute;left:87px;top:358px;white-space:pre;"><span class="cls_0">tionary in platform-specific application storage.</span></div><div style="position:absolute;left:103px;top:384px;white-space:pre;"><span class="cls_0">In general, however, it’s better for an application to interact with </span><span class="cls_0">the </span><span class="cls_5">Properties</span><span class="cls_0">dictionary in a</span></div><div style="position:absolute;left:87px;top:402px;white-space:pre;"><span class="cls_0">more structured manner, and here’s where the application </span><span class="cls_0">lifecycle events come into play. These are</span></div><div style="position:absolute;left:87px;top:419px;white-space:pre;"><span class="cls_0">the three methods that appear in the </span><span class="cls_5">App</span><span class="cls_0">class generated by the Xamarin.Forms template:</span></div><div style="position:absolute;left:87px;top:444px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">App </span><span class="cls_1">: </span><span class="cls_2">Application</span></div><div style="position:absolute;left:87px;top:458px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:471px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">App()</span></div><div style="position:absolute;left:109px;top:484px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:498px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:109px;top:511px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:538px;white-space:pre;"><span class="cls_4">protected override void </span><span class="cls_1">OnStart()</span></div><div style="position:absolute;left:109px;top:551px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:564px;white-space:pre;"><span class="cls_3">// Handle when your app starts</span></div><div style="position:absolute;left:109px;top:578px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:604px;white-space:pre;"><span class="cls_4">protected override void </span><span class="cls_1">OnSleep()</span></div><div style="position:absolute;left:109px;top:618px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:631px;white-space:pre;"><span class="cls_3">// Handle when your app sleeps</span></div><div style="position:absolute;left:109px;top:644px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:671px;white-space:pre;"><span class="cls_4">protected override void </span><span class="cls_1">OnResume()</span></div><div style="position:absolute;left:109px;top:684px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:698px;white-space:pre;"><span class="cls_3">// Handle when your app resumes</span></div><div style="position:absolute;left:109px;top:711px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:724px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:103px;top:750px;white-space:pre;"><span class="cls_0">The most important is the </span><span class="cls_5">OnSleep</span><span class="cls_0">call. In general, an application goes into sleep mode when it no</span></div><div style="position:absolute;left:87px;top:767px;white-space:pre;"><span class="cls_0">longer commands the screen and has become inactive (apart from some background jobs it might</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 6</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Button clicks</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">127</span></div><div style="position:absolute;left:111px;top:72px;white-space:pre;"><span class="cls_0">have initiated). From this sleep mode, an application can be resumed (signaled by an </span><span class="cls_5">OnResume</span><span class="cls_0">call) or</span></div><div style="position:absolute;left:111px;top:90px;white-space:pre;"><span class="cls_0">terminated. But this is important: After the </span><span class="cls_5">OnSleep</span><span class="cls_0">call, there is no further notification that an appli-</span></div><div style="position:absolute;left:111px;top:107px;white-space:pre;"><span class="cls_0">cation is being terminated. The </span><span class="cls_5">OnSleep</span><span class="cls_0">call is as close as you get to a termination notification, and it</span></div><div style="position:absolute;left:111px;top:124px;white-space:pre;"><span class="cls_0">always precedes a termination. For example, if your application is running and the user turns off the</span></div><div style="position:absolute;left:111px;top:142px;white-space:pre;"><span class="cls_0">phone, the application gets an </span><span class="cls_5">OnSleep</span><span class="cls_0">call as the phone is shutting down.</span></div><div style="position:absolute;left:127px;top:168px;white-space:pre;"><span class="cls_0">Actually, there are some exceptions to the rule that a call to </span><span class="cls_5">OnSleep</span><span class="cls_0">always precedes program ter-</span></div><div style="position:absolute;left:111px;top:186px;white-space:pre;"><span class="cls_0">mination: a program that crashes does not get an </span><span class="cls_5">OnSleep</span><span class="cls_0">call first, but you probably expect that. But</span></div><div style="position:absolute;left:111px;top:203px;white-space:pre;"><span class="cls_0">here’s a case that you might not anticipate: When you are debugging a Xamarin.Forms ap</span><span class="cls_0">plication,</span></div><div style="position:absolute;left:111px;top:220px;white-space:pre;"><span class="cls_0">and use Visual Studio or Xamarin Studio to stop debugging, the program is terminated without a pre-</span></div><div style="position:absolute;left:111px;top:238px;white-space:pre;"><span class="cls_0">ceding </span><span class="cls_5">OnSleep</span><span class="cls_0">call. This means that when you are debugging code that uses these application life-</span></div><div style="position:absolute;left:111px;top:255px;white-space:pre;"><span class="cls_0">cycle events, you should get into the habit of using the phone itself to put your program to sleep, to</span></div><div style="position:absolute;left:111px;top:272px;white-space:pre;"><span class="cls_0">resume the program, and to terminate it.</span></div><div style="position:absolute;left:127px;top:299px;white-space:pre;"><span class="cls_0">When your Xamarin.Forms application is running, the easiest way to trigger an </span><span class="cls_5">OnSleep</span><span class="cls_0">call on a</span></div><div style="position:absolute;left:111px;top:316px;white-space:pre;"><span class="cls_0">phone or simulator is by pressing the phone’s </span><span class="cls_13">Home</span><span class="cls_0"> </span><span class="cls_0">button. You can then bring the program back to</span></div><div style="position:absolute;left:111px;top:334px;white-space:pre;"><span class="cls_0">the foreground and trigger an </span><span class="cls_5">OnResume</span><span class="cls_0">call by selecting the application from the home menu (on</span></div><div style="position:absolute;left:111px;top:351px;white-space:pre;"><span class="cls_0">iOS devices or Android devices) or by pressing the </span><span class="cls_13">Back</span><span class="cls_0"> </span><span class="cls_0">button (on Android and Windows Phone</span></div><div style="position:absolute;left:111px;top:368px;white-space:pre;"><span class="cls_0">devices).</span></div><div style="position:absolute;left:127px;top:395px;white-space:pre;"><span class="cls_0">If your Xamarin.Forms </span><span class="cls_0">program is running and you invoke the phone’s application switcher—</span><span class="cls_0">by</span></div><div style="position:absolute;left:111px;top:412px;white-space:pre;"><span class="cls_0">pressing the </span><span class="cls_13">Home</span><span class="cls_0"> </span><span class="cls_0">button twice on iOS devices, by pressing the </span><span class="cls_13">Multitask</span><span class="cls_0"> </span><span class="cls_0">button on Android devices</span></div><div style="position:absolute;left:111px;top:430px;white-space:pre;"><span class="cls_0">(or by holding down the </span><span class="cls_13">Home</span><span class="cls_0"> </span><span class="cls_0">button on older Android devices), or by holding down the </span><span class="cls_13">Back</span><span class="cls_0"> </span><span class="cls_0">button</span></div><div style="position:absolute;left:111px;top:447px;white-space:pre;"><span class="cls_0">on a Windows Phone</span><span class="cls_0">—</span><span class="cls_0">the application gets an </span><span class="cls_5">OnSleep</span><span class="cls_0">call. If you then select that program, the appli-</span></div><div style="position:absolute;left:111px;top:464px;white-space:pre;"><span class="cls_0">cation gets an </span><span class="cls_5">OnResume</span><span class="cls_0">call as it resumes execution. If you instead terminate the application</span><span class="cls_0">—</span><span class="cls_0">by</span></div><div style="position:absolute;left:111px;top:482px;white-space:pre;"><span class="cls_0">swiping the application’s image upward on iOS de</span><span class="cls_0">vices or by tapping the X on the upper-right corner</span></div><div style="position:absolute;left:111px;top:499px;white-space:pre;"><span class="cls_0">of the application’s image on Android and Windows Phone devices—</span><span class="cls_0">the program stops executing with</span></div><div style="position:absolute;left:111px;top:516px;white-space:pre;"><span class="cls_0">no further notification.</span></div><div style="position:absolute;left:127px;top:543px;white-space:pre;"><span class="cls_0">So here’s the basic rule: Whenever your application gets a call to </span><span class="cls_5">OnSleep</span><span class="cls_0">, you should ensure that</span></div><div style="position:absolute;left:111px;top:560px;white-space:pre;"><span class="cls_0">the </span><span class="cls_5">Properties</span><span class="cls_0">dictionary contains all the information about the application you want to save.</span></div><div style="position:absolute;left:127px;top:587px;white-space:pre;"><span class="cls_0">If you’re using </span><span class="cls_0">lifecycle </span><span class="cls_0">events solely for saving and restoring program data, you don’t need to han-</span></div><div style="position:absolute;left:111px;top:604px;white-space:pre;"><span class="cls_0">dle the </span><span class="cls_5">OnResume</span><span class="cls_0">method. When your program gets an </span><span class="cls_5">OnResume</span><span class="cls_0">call, the operating system has al-</span></div><div style="position:absolute;left:111px;top:622px;white-space:pre;"><span class="cls_0">ready automatically restored the program contents and state. If you want to, you can use </span><span class="cls_5">OnResume</span><span class="cls_0">as</span></div><div style="position:absolute;left:111px;top:639px;white-space:pre;"><span class="cls_0">an opportunity to clear out the </span><span class="cls_5">Properties</span><span class="cls_0">dictionary because you are assured of getting another</span></div><div style="position:absolute;left:111px;top:656px;white-space:pre;"><span class="cls_5">OnSleep</span><span class="cls_0">call before your program terminates. However, if your program has established a connection</span></div><div style="position:absolute;left:111px;top:674px;white-space:pre;"><span class="cls_0">with a web service</span><span class="cls_0">—</span><span class="cls_0">or is in the process of establishing such a connection</span><span class="cls_0">—</span><span class="cls_0">you might want to use </span><span class="cls_5">On-</span></div><div style="position:absolute;left:111px;top:691px;white-space:pre;"><span class="cls_5">Resume</span><span class="cls_0">to restore that connection. Perhaps the connection has timed out in the interval that the pro-</span></div><div style="position:absolute;left:111px;top:708px;white-space:pre;"><span class="cls_0">gram was inactive. Or perhaps some fresh data is available.</span></div><div style="position:absolute;left:127px;top:735px;white-space:pre;"><span class="cls_0">You have some flexibility when you restore the data from the </span><span class="cls_5">Properties</span><span class="cls_0">dictionary to your appli-</span></div><div style="position:absolute;left:111px;top:752px;white-space:pre;"><span class="cls_0">cation as your program starts running. When a Xamarin.Forms program starts up, the first opportunity</span></div><div style="position:absolute;left:111px;top:770px;white-space:pre;"><span class="cls_0">you have to execute some code in the Portable Class Library is the constructor of the </span><span class="cls_5">App</span><span class="cls_0">class. At that</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 6</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Button clicks</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">128</span></div><div style="position:absolute;left:87px;top:72px;white-space:pre;"><span class="cls_0">time, the </span><span class="cls_5">Properties</span><span class="cls_0">dictionary has already been filled with the saved data from platform-specific</span></div><div style="position:absolute;left:87px;top:90px;white-space:pre;"><span class="cls_0">storage. The next code that executes is generally the constructor of the first page in your application</span></div><div style="position:absolute;left:87px;top:107px;white-space:pre;"><span class="cls_0">instantiated from the </span><span class="cls_5">App</span><span class="cls_0">constructor. The </span><span class="cls_5">OnStart</span><span class="cls_0">call in </span><span class="cls_5">Application</span><span class="cls_0">(and </span><span class="cls_5">App</span><span class="cls_0">) follows that, and</span></div><div style="position:absolute;left:87px;top:124px;white-space:pre;"><span class="cls_0">then an overridable method called </span><span class="cls_5">OnAppearing</span><span class="cls_0">is called in the page class. You can retrieve the data</span></div><div style="position:absolute;left:87px;top:142px;white-space:pre;"><span class="cls_0">at any time during this startup process.</span></div><div style="position:absolute;left:103px;top:168px;white-space:pre;"><span class="cls_0">The data that an application needs to save is usually in a page class, but the </span><span class="cls_5">OnSleep</span><span class="cls_0">override is in</span></div><div style="position:absolute;left:87px;top:186px;white-space:pre;"><span class="cls_0">the </span><span class="cls_5">App</span><span class="cls_0">class. So somehow the page class and the </span><span class="cls_5">App</span><span class="cls_0">class must communicate. One approach is to</span></div><div style="position:absolute;left:87px;top:203px;white-space:pre;"><span class="cls_0">define an </span><span class="cls_5">OnSleep</span><span class="cls_0">method in the page class that saves the data to the </span><span class="cls_5">Properties</span><span class="cls_0">dictionary and</span></div><div style="position:absolute;left:87px;top:220px;white-space:pre;"><span class="cls_0">then call the page’s </span><span class="cls_5">OnSleep</span><span class="cls_0">method from the </span><span class="cls_5">OnSleep</span><span class="cls_0">method in </span><span class="cls_5">App</span><span class="cls_0">. This approach works fine for</span></div><div style="position:absolute;left:87px;top:238px;white-space:pre;"><span class="cls_0">a single-page application</span><span class="cls_0">—</span><span class="cls_0">indeed, the </span><span class="cls_5">Application</span><span class="cls_0">class has a static property named </span><span class="cls_5">MainPage</span><span class="cls_0">that</span></div><div style="position:absolute;left:87px;top:255px;white-space:pre;"><span class="cls_0">is set in the </span><span class="cls_5">App</span><span class="cls_0">constructor and which the </span><span class="cls_5">OnSleep</span><span class="cls_0">method can use to get access to that page</span><span class="cls_0">—</span><span class="cls_0">but it</span></div><div style="position:absolute;left:87px;top:272px;white-space:pre;"><span class="cls_0">doesn’t work nearly as well for multipage applications.</span></div><div style="position:absolute;left:103px;top:299px;white-space:pre;"><span class="cls_0">Here’s a somewhat different approach: You first defi</span><span class="cls_0">ne all the data you need to save as public prop-</span></div><div style="position:absolute;left:87px;top:316px;white-space:pre;"><span class="cls_0">erties in the </span><span class="cls_5">App</span><span class="cls_0">class, for example:</span></div><div style="position:absolute;left:87px;top:342px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">App </span><span class="cls_1">: </span><span class="cls_2">Application</span></div><div style="position:absolute;left:87px;top:355px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:368px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">App()</span></div><div style="position:absolute;left:109px;top:382px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:395px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:109px;top:408px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:435px;white-space:pre;"><span class="cls_4">public string </span><span class="cls_1">DisplayLabelText { </span><span class="cls_4">set</span><span class="cls_1">; </span><span class="cls_4">get</span><span class="cls_1">; }</span></div><div style="position:absolute;left:109px;top:448px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:87px;top:475px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:500px;white-space:pre;"><span class="cls_0">The page class (or classes) can then set and retrieve those properties when convenient. The </span><span class="cls_5">App</span><span class="cls_0">class</span></div><div style="position:absolute;left:87px;top:518px;white-space:pre;"><span class="cls_0">can restore any such properties from the </span><span class="cls_5">Properties</span><span class="cls_0">dictionary in its constructor prior to instantiat-</span></div><div style="position:absolute;left:87px;top:535px;white-space:pre;"><span class="cls_0">ing the page and can store the properties in the </span><span class="cls_5">Properties</span><span class="cls_0">dictionary in its </span><span class="cls_5">OnSleep</span><span class="cls_0">override.</span></div><div style="position:absolute;left:103px;top:562px;white-space:pre;"><span class="cls_0">That’s the approach taken by the </span><span class="cls_13">PersistentKeypad</span><span class="cls_0"> </span><span class="cls_0">project. This program is identical to </span><span class="cls_13">Simplest-</span></div><div style="position:absolute;left:87px;top:579px;white-space:pre;"><span class="cls_13">Keypad</span><span class="cls_0"> </span><span class="cls_0">except that it includes code to save and restore the contents of the keypad. Here’s the </span><span class="cls_5">App</span></div><div style="position:absolute;left:87px;top:596px;white-space:pre;"><span class="cls_0">class that maintains a public </span><span class="cls_5">DisplayLabelText</span><span class="cls_0">property that is saved in the </span><span class="cls_5">OnSleep</span><span class="cls_0">override and</span></div><div style="position:absolute;left:87px;top:614px;white-space:pre;"><span class="cls_0">loaded in the </span><span class="cls_5">App</span><span class="cls_0">constructor:</span></div><div style="position:absolute;left:87px;top:639px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">PersistentKeypad</span></div><div style="position:absolute;left:87px;top:652px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:666px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">App </span><span class="cls_1">: </span><span class="cls_2">Application</span></div><div style="position:absolute;left:109px;top:679px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:692px;white-space:pre;"><span class="cls_4">const string </span><span class="cls_1">displayLabelText = </span><span class="cls_6">"displayLabelText"</span><span class="cls_1">;</span></div><div style="position:absolute;left:132px;top:719px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">App()</span></div><div style="position:absolute;left:132px;top:732px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:746px;white-space:pre;"><span class="cls_4">if </span><span class="cls_1">(Properties.ContainsKey(displayLabelText))</span></div><div style="position:absolute;left:154px;top:759px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:177px;top:772px;white-space:pre;"><span class="cls_1">DisplayLabelText = (</span><span class="cls_4">string</span><span class="cls_1">)Properties[displayLabelText];</span></div><div style="position:absolute;left:154px;top:786px;white-space:pre;"><span class="cls_1">}</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 6</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Button clicks</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">129</span></div><div style="position:absolute;left:178px;top:84px;white-space:pre;"><span class="cls_1">MainPage = </span><span class="cls_4">new </span><span class="cls_2">PersistentKeypadPage</span><span class="cls_1">();</span></div><div style="position:absolute;left:156px;top:98px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:156px;top:124px;white-space:pre;"><span class="cls_4">public string </span><span class="cls_1">DisplayLabelText { </span><span class="cls_4">set</span><span class="cls_1">; </span><span class="cls_4">get</span><span class="cls_1">; }</span></div><div style="position:absolute;left:156px;top:151px;white-space:pre;"><span class="cls_4">protected override void </span><span class="cls_1">OnStart()</span></div><div style="position:absolute;left:156px;top:164px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:178px;white-space:pre;"><span class="cls_3">// Handle when your app starts</span></div><div style="position:absolute;left:156px;top:191px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:156px;top:218px;white-space:pre;"><span class="cls_4">protected override void </span><span class="cls_1">OnSleep()</span></div><div style="position:absolute;left:156px;top:231px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:244px;white-space:pre;"><span class="cls_3">// Handle when your app sleeps</span></div><div style="position:absolute;left:178px;top:258px;white-space:pre;"><span class="cls_1">Properties[displayLabelText] = DisplayLabelText;</span></div><div style="position:absolute;left:156px;top:271px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:156px;top:298px;white-space:pre;"><span class="cls_4">protected override void </span><span class="cls_1">OnResume()</span></div><div style="position:absolute;left:156px;top:311px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:324px;white-space:pre;"><span class="cls_3">// Handle when your app resumes</span></div><div style="position:absolute;left:156px;top:338px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:133px;top:351px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:364px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:390px;white-space:pre;"><span class="cls_0">To avoid spelling errors, the </span><span class="cls_5">App</span><span class="cls_0">class defines the string dictionary key as a constant. It’s the same as</span></div><div style="position:absolute;left:111px;top:407px;white-space:pre;"><span class="cls_0">the property name except that it begins with a lowercase letter. Notice that the </span><span class="cls_5">DisplayLabelText</span></div><div style="position:absolute;left:111px;top:424px;white-space:pre;"><span class="cls_0">property is set prior to instantiating </span><span class="cls_5">PersistentKeypadPage</span><span class="cls_0">so that it’s available in the</span></div><div style="position:absolute;left:111px;top:442px;white-space:pre;"><span class="cls_5">PersistentKeypadPage</span><span class="cls_0">constructor.</span></div><div style="position:absolute;left:127px;top:468px;white-space:pre;"><span class="cls_0">An application with many more items might want to consolidate them in a class named </span><span class="cls_5">AppSet-</span></div><div style="position:absolute;left:111px;top:486px;white-space:pre;"><span class="cls_5">tings</span><span class="cls_0">(for example), serialize that class to an XML or a JSON string, and then save the string in the</span></div><div style="position:absolute;left:111px;top:503px;white-space:pre;"><span class="cls_0">dictionary.</span></div><div style="position:absolute;left:127px;top:530px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">PersistentKeypadPage</span><span class="cls_0">class accesses that </span><span class="cls_5">DisplayLabelText</span><span class="cls_0">property in its constructor</span></div><div style="position:absolute;left:111px;top:547px;white-space:pre;"><span class="cls_0">and sets the property in its two event handlers:</span></div><div style="position:absolute;left:111px;top:572px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">PersistentKeypadPage </span><span class="cls_1">: </span><span class="cls_2">ContentPage</span></div><div style="position:absolute;left:111px;top:586px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:599px;white-space:pre;"><span class="cls_2">Label </span><span class="cls_1">displayLabel;</span></div><div style="position:absolute;left:133px;top:612px;white-space:pre;"><span class="cls_2">Button </span><span class="cls_1">backspaceButton;</span></div><div style="position:absolute;left:133px;top:639px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">PersistentKeypadPage()</span></div><div style="position:absolute;left:133px;top:652px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:161px;top:679px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:156px;top:706px;white-space:pre;"><span class="cls_3">// New code for loading previous keypad text.</span></div><div style="position:absolute;left:156px;top:719px;white-space:pre;"><span class="cls_2">App </span><span class="cls_1">app = </span><span class="cls_2">Application</span><span class="cls_1">.Current </span><span class="cls_4">as </span><span class="cls_2">App</span><span class="cls_1">;</span></div><div style="position:absolute;left:156px;top:732px;white-space:pre;"><span class="cls_1">displayLabel.Text = app.DisplayLabelText;</span></div><div style="position:absolute;left:156px;top:746px;white-space:pre;"><span class="cls_1">backspaceButton.IsEnabled = displayLabel.Text != </span><span class="cls_4">null </span><span class="cls_1">&&</span></div><div style="position:absolute;left:313px;top:759px;white-space:pre;"><span class="cls_1">displayLabel.Text.Length > 0;</span></div><div style="position:absolute;left:133px;top:786px;white-space:pre;"><span class="cls_1">}</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 6</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Button clicks</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">130</span></div><div style="position:absolute;left:109px;top:84px;white-space:pre;"><span class="cls_4">void </span><span class="cls_1">OnDigitButtonClicked(</span><span class="cls_4">object </span><span class="cls_1">sender, </span><span class="cls_2">EventArgs </span><span class="cls_1">args)</span></div><div style="position:absolute;left:109px;top:98px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:111px;white-space:pre;"><span class="cls_2">Button </span><span class="cls_1">button = (</span><span class="cls_2">Button</span><span class="cls_1">)sender;</span></div><div style="position:absolute;left:132px;top:124px;white-space:pre;"><span class="cls_1">displayLabel.Text += (</span><span class="cls_4">string</span><span class="cls_1">)button.StyleId;</span></div><div style="position:absolute;left:132px;top:138px;white-space:pre;"><span class="cls_1">backspaceButton.IsEnabled = </span><span class="cls_4">true</span><span class="cls_1">;</span></div><div style="position:absolute;left:132px;top:164px;white-space:pre;"><span class="cls_3">// Save keypad text.</span></div><div style="position:absolute;left:132px;top:178px;white-space:pre;"><span class="cls_2">App </span><span class="cls_1">app = </span><span class="cls_2">Application</span><span class="cls_1">.Current </span><span class="cls_4">as </span><span class="cls_2">App</span><span class="cls_1">;</span></div><div style="position:absolute;left:132px;top:191px;white-space:pre;"><span class="cls_1">app.DisplayLabelText = displayLabel.Text;</span></div><div style="position:absolute;left:109px;top:204px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:231px;white-space:pre;"><span class="cls_4">void </span><span class="cls_1">OnBackspaceButtonClicked(</span><span class="cls_4">object </span><span class="cls_1">sender, </span><span class="cls_2">EventArgs </span><span class="cls_1">args)</span></div><div style="position:absolute;left:109px;top:244px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:258px;white-space:pre;"><span class="cls_4">string </span><span class="cls_1">text = displayLabel.Text;</span></div><div style="position:absolute;left:132px;top:271px;white-space:pre;"><span class="cls_1">displayLabel.Text = text.Substring(0, text.Length - 1);</span></div><div style="position:absolute;left:132px;top:284px;white-space:pre;"><span class="cls_1">backspaceButton.IsEnabled = displayLabel.Text.Length > 0;</span></div><div style="position:absolute;left:132px;top:311px;white-space:pre;"><span class="cls_3">// Save keypad text.</span></div><div style="position:absolute;left:132px;top:324px;white-space:pre;"><span class="cls_2">App </span><span class="cls_1">app = </span><span class="cls_2">Application</span><span class="cls_1">.Current </span><span class="cls_4">as </span><span class="cls_2">App</span><span class="cls_1">;</span></div><div style="position:absolute;left:132px;top:338px;white-space:pre;"><span class="cls_1">app.DisplayLabelText = displayLabel.Text;</span></div><div style="position:absolute;left:109px;top:351px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:364px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:103px;top:390px;white-space:pre;"><span class="cls_0">When testing programs that use the </span><span class="cls_5">Properties</span><span class="cls_0">dictionary and application lifecycle event</span><span class="cls_0">s, you’ll</span></div><div style="position:absolute;left:87px;top:407px;white-space:pre;"><span class="cls_0">want to occasionally uninstall the program from the phone or simulator. Uninstalling a program from a</span></div><div style="position:absolute;left:87px;top:424px;white-space:pre;"><span class="cls_0">device also deletes any stored data, so the next time the program is deployed from Visual Studio or</span></div><div style="position:absolute;left:87px;top:442px;white-space:pre;"><span class="cls_0">Xamarin Studio, the program encounters an empty dictionary, as though it were being run for the very</span></div><div style="position:absolute;left:87px;top:459px;white-space:pre;"><span class="cls_0">first time.</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:79px;top:74px;white-space:pre;"><span class="cls_7">Chapter 7</span></div><div style="position:absolute;left:79px;top:94px;white-space:pre;"><span class="cls_8">XAML</span></div><div style="position:absolute;left:183px;top:94px;white-space:pre;"><span class="cls_8">vs.</span></div><div style="position:absolute;left:232px;top:94px;white-space:pre;"><span class="cls_8">code</span></div><div style="position:absolute;left:111px;top:168px;white-space:pre;"><span class="cls_0">C# is undoubtedly one of the greatest programming languages the world has ever seen. You can write</span></div><div style="position:absolute;left:111px;top:186px;white-space:pre;"><span class="cls_0">entire Xamarin.Forms applications in C#, and it’s conceivable that you’ve found C# to be so ideally</span></div><div style="position:absolute;left:111px;top:203px;white-space:pre;"><span class="cls_0">suited for Xamarin.Forms that you haven’t even considered using anything else.</span></div><div style="position:absolute;left:127px;top:230px;white-space:pre;"><span class="cls_0">But keep an open mind. Xamarin.Forms provides an alternative to C# that has some distinct ad-</span></div><div style="position:absolute;left:111px;top:247px;white-space:pre;"><span class="cls_0">vantages for certain aspects of program development. This alternative is XAML (pronounced "zam-</span></div><div style="position:absolute;left:111px;top:264px;white-space:pre;"><span class="cls_0">mel"), which stands for the Extensible Application Markup Language. Like C#, XAML was developed at</span></div><div style="position:absolute;left:111px;top:282px;white-space:pre;"><span class="cls_0">Microsoft Corporation, and it is only a few years younger than C#.</span></div><div style="position:absolute;left:127px;top:308px;white-space:pre;"><span class="cls_0">As its name suggests, XAML adheres to the syntax of XML, the Extensible Markup Language. This</span></div><div style="position:absolute;left:111px;top:326px;white-space:pre;"><span class="cls_0">book assumes that you have familiarity with the basic concepts and syntax of XML.</span></div><div style="position:absolute;left:127px;top:352px;white-space:pre;"><span class="cls_0">In the most general sense, XAML is a declarative markup language used for instantiating and initial-</span></div><div style="position:absolute;left:111px;top:370px;white-space:pre;"><span class="cls_0">izing objects. That definition might seem excessively general, and XAML is indeed quite flexible. But</span></div><div style="position:absolute;left:111px;top:387px;white-space:pre;"><span class="cls_0">most real-world XAML has been used for defining tree-structured visual user interfaces characteristic of</span></div><div style="position:absolute;left:111px;top:404px;white-space:pre;"><span class="cls_0">graphical programming environments. The history of XAML-based user interfaces begins with the</span></div><div style="position:absolute;left:111px;top:422px;white-space:pre;"><span class="cls_0">Windows Presentation Foundation (WPF) and continues with Silverlight, Windows Phone 7 and 8, and</span></div><div style="position:absolute;left:111px;top:439px;white-space:pre;"><span class="cls_0">Windows 8 and 10. Each of these XAML implementations supports a somewhat different set of visual</span></div><div style="position:absolute;left:111px;top:456px;white-space:pre;"><span class="cls_0">elements defined by the particular platform. Likewise, the XAML implementation in Xamarin.Forms</span></div><div style="position:absolute;left:111px;top:474px;white-space:pre;"><span class="cls_0">supports the visual elements defined by Xamarin.Forms, such as </span><span class="cls_5">Label</span><span class="cls_0">, </span><span class="cls_5">BoxView</span><span class="cls_0">, </span><span class="cls_5">Frame</span><span class="cls_0">, </span><span class="cls_5">Button</span><span class="cls_0">,</span></div><div style="position:absolute;left:111px;top:491px;white-space:pre;"><span class="cls_5">StackLayout</span><span class="cls_0">, and </span><span class="cls_5">ContentPage</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:518px;white-space:pre;"><span class="cls_0">As you've seen, a Xamarin.Forms application written entirely in code generally defines the initial ap-</span></div><div style="position:absolute;left:111px;top:535px;white-space:pre;"><span class="cls_0">pearance of its user interface in the constructor of a class that derives from </span><span class="cls_5">ContentPage</span><span class="cls_0">. If you</span></div><div style="position:absolute;left:111px;top:552px;white-space:pre;"><span class="cls_0">choose to use XAML, the markup generally replaces this constructor code. You will find that XAML pro-</span></div><div style="position:absolute;left:111px;top:570px;white-space:pre;"><span class="cls_0">vides a more succinct and elegant definition of the user interface and has a visual structure that better</span></div><div style="position:absolute;left:111px;top:587px;white-space:pre;"><span class="cls_0">mimics the tree organization of the visual elements on the page.</span></div><div style="position:absolute;left:127px;top:614px;white-space:pre;"><span class="cls_0">XAML is also generally easier to maintain and modify than equivalent code. Because XAML is XML, it</span></div><div style="position:absolute;left:111px;top:631px;white-space:pre;"><span class="cls_0">is also potentially toolable: XAML can more easily be parsed and edited by software tools than the</span></div><div style="position:absolute;left:111px;top:648px;white-space:pre;"><span class="cls_0">equivalent C# code. Indeed, an early impetus behind XAML was to facilitate a collaboration between</span></div><div style="position:absolute;left:111px;top:666px;white-space:pre;"><span class="cls_0">programmers and designers: Designers can use design tools that generate XAML, while programmers</span></div><div style="position:absolute;left:111px;top:683px;white-space:pre;"><span class="cls_0">focus on the code that interacts with the markup. While this vision has perhaps only rarely been ful-</span></div><div style="position:absolute;left:111px;top:700px;white-space:pre;"><span class="cls_0">filled to perfection, it certainly suggests how applications can be structured to accommodate XAML.</span></div><div style="position:absolute;left:111px;top:718px;white-space:pre;"><span class="cls_0">You use XAML for the visuals and code for the underlying logic.</span></div><div style="position:absolute;left:127px;top:744px;white-space:pre;"><span class="cls_0">Yet, XAML goes beyond that simple division of labor. As you’ll see in a future chapter, it’s possible to</span></div><div style="position:absolute;left:111px;top:762px;white-space:pre;"><span class="cls_0">define bindings right in the XAML that link user-interface objects with underlying data.</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image79.png" width="708" height="864" alt=""></div><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">132</span></div><div style="position:absolute;left:103px;top:72px;white-space:pre;"><span class="cls_0">When creating XAML for Microsoft platforms, some developers use interactive design tools such as</span></div><div style="position:absolute;left:87px;top:90px;white-space:pre;"><span class="cls_0">Microsoft Blend, but many others prefer to handwrite XAML. No design tools are available for Xama-</span></div><div style="position:absolute;left:87px;top:107px;white-space:pre;"><span class="cls_0">rin.Forms, so handwriting is the only option. Obviously, all the XAML examples in this book are hand-</span></div><div style="position:absolute;left:87px;top:124px;white-space:pre;"><span class="cls_0">written. But even when design tools are available, the ability to handwrite XAML is an important skill.</span></div><div style="position:absolute;left:103px;top:151px;white-space:pre;"><span class="cls_0">The prospect of handwriting XAML might cause some consternation among developers for another</span></div><div style="position:absolute;left:87px;top:168px;white-space:pre;"><span class="cls_0">reason: XML is notoriously verbose. Yet, you’ll see almo</span><span class="cls_0">st immediately that XAML is often more concise</span></div><div style="position:absolute;left:87px;top:186px;white-space:pre;"><span class="cls_0">than the equivalent C# code. The real power of XAML becomes evident only incrementally, however,</span></div><div style="position:absolute;left:87px;top:203px;white-space:pre;"><span class="cls_0">and won’t be fully apparent until Chapter 19, “Collection views,” when you use XAML for constructing</span></div><div style="position:absolute;left:87px;top:220px;white-space:pre;"><span class="cls_0">templates for multiple items displayed in a </span><span class="cls_5">ListView</span><span class="cls_0">.</span></div><div style="position:absolute;left:103px;top:247px;white-space:pre;"><span class="cls_0">It is natural for programmers who prefer strongly typed languages such as C# to be skeptical of a</span></div><div style="position:absolute;left:87px;top:264px;white-space:pre;"><span class="cls_0">markup language where everything is a text string. But you’ll see shortly how XAML is a very strict ana-</span></div><div style="position:absolute;left:87px;top:282px;white-space:pre;"><span class="cls_0">log of progr</span><span class="cls_0">amming code. Much of what’s allowed in your XAML files is defined by the classes and</span></div><div style="position:absolute;left:87px;top:299px;white-space:pre;"><span class="cls_0">properties that make up the Xamarin.Forms application programming interface. For this reason, you</span></div><div style="position:absolute;left:87px;top:316px;white-space:pre;"><span class="cls_0">might even begin to think of XAML as a "strongly typed" markup language. The XAML parser does its</span></div><div style="position:absolute;left:87px;top:334px;white-space:pre;"><span class="cls_0">job in a very mechanical manner based on the underlying API infrastructure. One of the objectives of</span></div><div style="position:absolute;left:87px;top:351px;white-space:pre;"><span class="cls_0">this chapter and the next is to demystify XAML and illuminate what happens when the XAML is parsed.</span></div><div style="position:absolute;left:103px;top:378px;white-space:pre;"><span class="cls_0">Yet, code and markup are very different: Code defines a process while markup defines a state. XAML</span></div><div style="position:absolute;left:87px;top:395px;white-space:pre;"><span class="cls_0">has several deficiencies that are intrinsic to markup languages: XAML has no loops, no flow control, no</span></div><div style="position:absolute;left:87px;top:412px;white-space:pre;"><span class="cls_0">algebraic calculation syntax, and no event handlers. However, XAML defines several features that help</span></div><div style="position:absolute;left:87px;top:430px;white-space:pre;"><span class="cls_0">compensate for some of these deficiencies. You’ll see many of these features in future chapters.</span></div><div style="position:absolute;left:103px;top:456px;white-space:pre;"><span class="cls_0">If you do not want to use XAML, you don’t need to. Anything that can be done in XAML can be</span></div><div style="position:absolute;left:87px;top:474px;white-space:pre;"><span class="cls_0">done in C#. But watch out: Sometimes developers get a little taste of XAML and get carried away and</span></div><div style="position:absolute;left:87px;top:491px;white-space:pre;"><span class="cls_0">try to do everything in XAML! As usual, the best rule is “moderation in all things.” Many of the best</span></div><div style="position:absolute;left:87px;top:508px;white-space:pre;"><span class="cls_0">techniques involve combining code and XAML in interactive ways.</span></div><div style="position:absolute;left:103px;top:535px;white-space:pre;"><span class="cls_0">Let's begin this exploration with a few snippets of code and the equivalent XAML, and then see how</span></div><div style="position:absolute;left:87px;top:552px;white-space:pre;"><span class="cls_0">XAML and code fit together in a Xamarin.Forms application.</span></div><div style="position:absolute;left:55px;top:592px;white-space:pre;"><span class="cls_11">Properties</span><span class="cls_12"> </span><span class="cls_11">and</span><span class="cls_12"> </span><span class="cls_11">attributes</span></div><div style="position:absolute;left:87px;top:640px;white-space:pre;"><span class="cls_0">Here is a Xamarin.Forms </span><span class="cls_5">Label</span><span class="cls_0">instantiated and initialized in code, much as it might appear in the</span></div><div style="position:absolute;left:87px;top:658px;white-space:pre;"><span class="cls_0">constructor of a page class:</span></div><div style="position:absolute;left:87px;top:683px;white-space:pre;"><span class="cls_4">new </span><span class="cls_2">Label</span></div><div style="position:absolute;left:87px;top:696px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:710px;white-space:pre;"><span class="cls_1">Text = </span><span class="cls_6">"Hello from Code!"</span><span class="cls_1">,</span></div><div style="position:absolute;left:109px;top:723px;white-space:pre;"><span class="cls_1">IsVisible = </span><span class="cls_4">true</span><span class="cls_1">,</span></div><div style="position:absolute;left:109px;top:736px;white-space:pre;"><span class="cls_1">Opacity = 0.75,</span></div><div style="position:absolute;left:109px;top:750px;white-space:pre;"><span class="cls_1">HorizontalTextAlignment = </span><span class="cls_2">TextAlignment</span><span class="cls_1">.Center,</span></div><div style="position:absolute;left:109px;top:763px;white-space:pre;"><span class="cls_1">VerticalOptions = </span><span class="cls_2">LayoutOptions</span><span class="cls_1">.CenterAndExpand,</span></div><div style="position:absolute;left:109px;top:776px;white-space:pre;"><span class="cls_1">TextColor = </span><span class="cls_2">Color</span><span class="cls_1">.Blue,</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">133</span></div><div style="position:absolute;left:133px;top:71px;white-space:pre;"><span class="cls_1">BackgroundColor = </span><span class="cls_2">Color</span><span class="cls_1">.FromRgb(255, 128, 128),</span></div><div style="position:absolute;left:133px;top:84px;white-space:pre;"><span class="cls_1">FontSize = </span><span class="cls_2">Device</span><span class="cls_1">.GetNamedSize(</span><span class="cls_2">NamedSize</span><span class="cls_1">.Large, </span><span class="cls_4">typeof</span><span class="cls_1">(</span><span class="cls_2">Label</span><span class="cls_1">)),</span></div><div style="position:absolute;left:133px;top:98px;white-space:pre;"><span class="cls_1">FontAttributes = </span><span class="cls_2">FontAttributes</span><span class="cls_1">.Bold | </span><span class="cls_2">FontAttributes</span><span class="cls_1">.Italic</span></div><div style="position:absolute;left:111px;top:111px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:111px;top:136px;white-space:pre;"><span class="cls_0">Here is a very similar </span><span class="cls_5">Label</span><span class="cls_0">instantiated and initialized in XAML, which you can see immediately is</span></div><div style="position:absolute;left:111px;top:154px;white-space:pre;"><span class="cls_0">more concise than the equivalent code:</span></div><div style="position:absolute;left:111px;top:179px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Hello from XAML!</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:192px;white-space:pre;"><span class="cls_14">IsVisible</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">True</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:206px;white-space:pre;"><span class="cls_14">Opacity</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">0.75</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:219px;white-space:pre;"><span class="cls_14">HorizontalTextAlignment</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:232px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:246px;white-space:pre;"><span class="cls_14">TextColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Blue</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:259px;white-space:pre;"><span class="cls_14">BackgroundColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">#FF8080</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:272px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:286px;white-space:pre;"><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Bold,Italic</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:111px;top:311px;white-space:pre;"><span class="cls_0">Xamarin.Forms classes such as </span><span class="cls_5">Label</span><span class="cls_0">become XML elements in XAML. Properties such as </span><span class="cls_5">Text</span><span class="cls_0">,</span></div><div style="position:absolute;left:111px;top:328px;white-space:pre;"><span class="cls_5">IsVisible</span><span class="cls_0">, and the rest become XML attributes in XAML.</span></div><div style="position:absolute;left:127px;top:355px;white-space:pre;"><span class="cls_0">To be instantiated in XAML, a class such as </span><span class="cls_5">Label</span><span class="cls_0">must have a public parameterless constructor. (In</span></div><div style="position:absolute;left:111px;top:372px;white-space:pre;"><span class="cls_0">the next chapter, you’ll see that there is a technique to pass arguments to a constructor in XAML, but</span></div><div style="position:absolute;left:111px;top:390px;white-space:pre;"><span class="cls_0">it’s generally used for special purposes.) The properties set in XAML must have public </span><span class="cls_5">set</span><span class="cls_0">accessors. By</span></div><div style="position:absolute;left:111px;top:407px;white-space:pre;"><span class="cls_0">convention, spaces surround an equal sign in code but not in XML (or XAML), but you can use as much</span></div><div style="position:absolute;left:111px;top:424px;white-space:pre;"><span class="cls_0">white space as you want.</span></div><div style="position:absolute;left:127px;top:451px;white-space:pre;"><span class="cls_0">The concision of the XAML results mostly from the brevity of the attribute values</span><span class="cls_0">—</span><span class="cls_0">for example, the</span></div><div style="position:absolute;left:111px;top:468px;white-space:pre;"><span class="cls_0">use of the word "Large" rather than a call to the </span><span class="cls_5">Device.GetNamedSize</span><span class="cls_0">method. These abbreviations</span></div><div style="position:absolute;left:111px;top:486px;white-space:pre;"><span class="cls_0">are not built into the XAML parser. The XAML parser is instead assisted by various converter classes de-</span></div><div style="position:absolute;left:111px;top:503px;white-space:pre;"><span class="cls_0">fined specifically for this purpose.</span></div><div style="position:absolute;left:127px;top:530px;white-space:pre;"><span class="cls_0">When the XAML parser encounters the </span><span class="cls_5">Label</span><span class="cls_0">element, it can use reflection to determine whether</span></div><div style="position:absolute;left:111px;top:547px;white-space:pre;"><span class="cls_0">Xamarin.Forms has a class named </span><span class="cls_5">Label</span><span class="cls_0">, and if so, it can instantiate that class. Now it is ready to ini-</span></div><div style="position:absolute;left:111px;top:564px;white-space:pre;"><span class="cls_0">tialize that object. The </span><span class="cls_5">Text</span><span class="cls_0">property is of type </span><span class="cls_5">string</span><span class="cls_0">, and the attribute value is simply assigned to</span></div><div style="position:absolute;left:111px;top:582px;white-space:pre;"><span class="cls_0">that property.</span></div><div style="position:absolute;left:127px;top:608px;white-space:pre;"><span class="cls_0">Because XAML is XML, you can include Unicode characters in the text by using the standard XML</span></div><div style="position:absolute;left:111px;top:626px;white-space:pre;"><span class="cls_0">syntax. Precede the decimal Unicode value with </span><span class="cls_5">&#</span><span class="cls_0">(or the hexadecimal Unicode value with </span><span class="cls_5">&#x</span><span class="cls_0">) and</span></div><div style="position:absolute;left:111px;top:643px;white-space:pre;"><span class="cls_0">follow it with a semicolon:</span></div><div style="position:absolute;left:111px;top:668px;white-space:pre;"><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Cost </span><span class="cls_14">&#x2014; &#x20AC;</span><span class="cls_4">123.45</span><span class="cls_1">"</span></div><div style="position:absolute;left:111px;top:694px;white-space:pre;"><span class="cls_0">Those are the Unicode values for the em dash and euro symbol. To force a line break, use the line-feed</span></div><div style="position:absolute;left:111px;top:711px;white-space:pre;"><span class="cls_0">character </span><span class="cls_5">&#x000A,</span><span class="cls_0">or (because leading zeros aren’t required) </span><span class="cls_5">&#xA</span><span class="cls_0">, or, in decimal, </span><span class="cls_5">&#10</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:738px;white-space:pre;"><span class="cls_0">Angle brackets, ampersands, and quotation marks have a special meaning in XML, so to include</span></div><div style="position:absolute;left:111px;top:755px;white-space:pre;"><span class="cls_0">those characters in a text string, use one of the standard predefined entities:</span></div><div style="position:absolute;left:125px;top:781px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:782px;white-space:pre;"><span class="cls_5">&lt;</span><span class="cls_0">for <</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">134</span></div><div style="position:absolute;left:101px;top:71px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:125px;top:72px;white-space:pre;"><span class="cls_5">&gt;</span><span class="cls_0">for ></span></div><div style="position:absolute;left:101px;top:98px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:125px;top:99px;white-space:pre;"><span class="cls_5">&amp;</span><span class="cls_0">for &</span></div><div style="position:absolute;left:101px;top:125px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:125px;top:126px;white-space:pre;"><span class="cls_5">&apos;</span><span class="cls_0">for '</span></div><div style="position:absolute;left:101px;top:151px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:125px;top:152px;white-space:pre;"><span class="cls_5">&quot;</span><span class="cls_0">for "</span></div><div style="position:absolute;left:87px;top:179px;white-space:pre;"><span class="cls_0">The HTML predefined entities such as </span><span class="cls_5">&nbsp;</span><span class="cls_0">are not supported. For a nonbreaking space use </span><span class="cls_5">&#xA0;</span></div><div style="position:absolute;left:87px;top:196px;white-space:pre;"><span class="cls_0">instead.</span></div><div style="position:absolute;left:103px;top:223px;white-space:pre;"><span class="cls_0">In addition, in Chapter 10, “XAML markup extensions,” you’ll discover that curly braces ({ and }) have</span></div><div style="position:absolute;left:87px;top:240px;white-space:pre;"><span class="cls_0">a special meaning in XAML. If you need to begin an attribute value with a left curly brace, begin it with</span></div><div style="position:absolute;left:87px;top:258px;white-space:pre;"><span class="cls_0">a pair of curly braces ({}) and then the left curly brace.</span></div><div style="position:absolute;left:103px;top:284px;white-space:pre;"><span class="cls_0">Back to the example: The </span><span class="cls_5">IsVisible</span><span class="cls_0">and </span><span class="cls_5">Opacity</span><span class="cls_0">properties of </span><span class="cls_5">Label</span><span class="cls_0">are of type </span><span class="cls_5">bool</span><span class="cls_0">and </span><span class="cls_5">dou-</span></div><div style="position:absolute;left:87px;top:302px;white-space:pre;"><span class="cls_5">ble</span><span class="cls_0">, respectively, and these are as simple as you might expect. The XAML parser uses the </span><span class="cls_5">Bool-</span></div><div style="position:absolute;left:87px;top:319px;white-space:pre;"><span class="cls_5">ean.Parse</span><span class="cls_0">and </span><span class="cls_5">Double.Parse</span><span class="cls_0">methods to convert the attribute values. The </span><span class="cls_5">Boolean.Parse</span></div><div style="position:absolute;left:87px;top:336px;white-space:pre;"><span class="cls_0">method is case insensitive, but generally Boolean values are capitalized as “True” and “False” </span><span class="cls_0">in XAML.</span></div><div style="position:absolute;left:87px;top:354px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">Double.Parse</span><span class="cls_0">method is passed a </span><span class="cls_5">CultureInfo.InvariantCulture</span><span class="cls_0">argument, so the conver-</span></div><div style="position:absolute;left:87px;top:371px;white-space:pre;"><span class="cls_0">sion doesn’t depend on the local culture of the programmer or user.</span></div><div style="position:absolute;left:103px;top:398px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">HorizontalTextAlignment</span><span class="cls_0">property of </span><span class="cls_5">Label</span><span class="cls_0">is of type </span><span class="cls_5">TextAlignment</span><span class="cls_0">, which is an enu-</span></div><div style="position:absolute;left:87px;top:415px;white-space:pre;"><span class="cls_0">meration. For any property that is an enumeration type, the XAML parser uses the </span><span class="cls_5">Enum.Parse</span></div><div style="position:absolute;left:87px;top:432px;white-space:pre;"><span class="cls_0">method to convert from the string to the value.</span></div><div style="position:absolute;left:103px;top:459px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">VerticalOptions</span><span class="cls_0">property is of type </span><span class="cls_5">LayoutOptions</span><span class="cls_0">, a structure. When the XAML parser</span></div><div style="position:absolute;left:87px;top:476px;white-space:pre;"><span class="cls_0">references the </span><span class="cls_5">LayoutOptions</span><span class="cls_0">structure using reflection, it discovers that the structure has a C# at-</span></div><div style="position:absolute;left:87px;top:494px;white-space:pre;"><span class="cls_0">tribute defined:</span></div><div style="position:absolute;left:87px;top:519px;white-space:pre;"><span class="cls_1">[</span><span class="cls_2">TypeConverter </span><span class="cls_1">(</span><span class="cls_4">typeof</span><span class="cls_1">(</span><span class="cls_2">LayoutOptionsConverter</span><span class="cls_1">))]</span></div><div style="position:absolute;left:87px;top:532px;white-space:pre;"><span class="cls_4">public struct </span><span class="cls_2">LayoutOptions</span></div><div style="position:absolute;left:87px;top:546px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:559px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:87px;top:572px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:598px;white-space:pre;"><span class="cls_0">(Watch out! This discussion involves two types of attributes: XML attributes such as </span><span class="cls_5">HorizontalText-</span></div><div style="position:absolute;left:87px;top:615px;white-space:pre;"><span class="cls_5">Alignment</span><span class="cls_0">and C# attributes such as this </span><span class="cls_5">TypeConverter</span><span class="cls_0">.)</span></div><div style="position:absolute;left:103px;top:642px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">TypeConverter</span><span class="cls_0">attribute is supported by a class named </span><span class="cls_5">TypeConverterAttribute</span><span class="cls_0">. This par-</span></div><div style="position:absolute;left:87px;top:659px;white-space:pre;"><span class="cls_0">ticular </span><span class="cls_5">TypeConverter</span><span class="cls_0">attribute on </span><span class="cls_5">LayoutOptions</span><span class="cls_0">references a class named </span><span class="cls_5">LayoutOptionsCon-</span></div><div style="position:absolute;left:87px;top:676px;white-space:pre;"><span class="cls_5">verter</span><span class="cls_0">, which derives from a public abstract class named </span><span class="cls_5">TypeConverter</span><span class="cls_0">that defines methods</span></div><div style="position:absolute;left:87px;top:694px;white-space:pre;"><span class="cls_0">named </span><span class="cls_5">CanConvertFrom</span><span class="cls_0">and </span><span class="cls_5">ConvertFrom</span><span class="cls_0">. When the XAML parser encounters this </span><span class="cls_5">TypeConverter</span></div><div style="position:absolute;left:87px;top:711px;white-space:pre;"><span class="cls_0">attribute, it instantiates the </span><span class="cls_5">LayoutOptionsConverter</span><span class="cls_0">. The </span><span class="cls_5">VerticalOptions</span><span class="cls_0">attribute in the XAML</span></div><div style="position:absolute;left:87px;top:728px;white-space:pre;"><span class="cls_0">is assigned the string “Center”, so the XAML parser passes that “Center” string to the </span><span class="cls_5">ConvertFrom</span></div><div style="position:absolute;left:87px;top:746px;white-space:pre;"><span class="cls_0">method of </span><span class="cls_5">LayoutOptionsConverter</span><span class="cls_0">, and out pops a </span><span class="cls_5">LayoutOptions</span><span class="cls_0">value. This is assigned to the</span></div><div style="position:absolute;left:87px;top:763px;white-space:pre;"><span class="cls_5">VerticalOptions</span><span class="cls_0">property of the </span><span class="cls_5">Label</span><span class="cls_0">object.</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">135</span></div><div style="position:absolute;left:127px;top:72px;white-space:pre;"><span class="cls_0">Similarly, when the XAML parser encounters the </span><span class="cls_5">TextColor</span><span class="cls_0">and </span><span class="cls_5">BackgroundColor</span><span class="cls_0">properties, it</span></div><div style="position:absolute;left:111px;top:90px;white-space:pre;"><span class="cls_0">uses reflection to determine that those properties are of type </span><span class="cls_5">Color</span><span class="cls_0">. The </span><span class="cls_5">Color</span><span class="cls_0">structure is also</span></div><div style="position:absolute;left:111px;top:107px;white-space:pre;"><span class="cls_0">adorned with a </span><span class="cls_5">TypeConverter</span><span class="cls_0">attribute:</span></div><div style="position:absolute;left:111px;top:132px;white-space:pre;"><span class="cls_1">[</span><span class="cls_2">TypeConverter </span><span class="cls_1">(</span><span class="cls_4">typeof</span><span class="cls_1">(</span><span class="cls_2">ColorTypeConverter</span><span class="cls_1">))]</span></div><div style="position:absolute;left:111px;top:146px;white-space:pre;"><span class="cls_4">public struct </span><span class="cls_2">Color</span></div><div style="position:absolute;left:111px;top:159px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:172px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:111px;top:186px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:211px;white-space:pre;"><span class="cls_0">You can create an instance of </span><span class="cls_5">ColorTypeConverter</span><span class="cls_0">and experiment with it in code if you'd like. It</span></div><div style="position:absolute;left:111px;top:228px;white-space:pre;"><span class="cls_0">accepts color definitions in several formats: It can convert a string like “Blue” to the </span><span class="cls_5">Color.Blue</span><span class="cls_0">value,</span></div><div style="position:absolute;left:111px;top:246px;white-space:pre;"><span class="cls_0">and the “Default” and “Accent” strings to the </span><span class="cls_5">Color.Default</span><span class="cls_0">and </span><span class="cls_5">Color.Accent</span><span class="cls_0">values. </span><span class="cls_5">Color-</span></div><div style="position:absolute;left:111px;top:263px;white-space:pre;"><span class="cls_5">TypeConverter</span><span class="cls_0">can also parse strings that encode red-green-</span><span class="cls_0">blue values, such as “#FF8080”, which is</span></div><div style="position:absolute;left:111px;top:280px;white-space:pre;"><span class="cls_0">a red value of 0xFF, a green value of 0x80, and a blue value also of 0x80.</span></div><div style="position:absolute;left:127px;top:307px;white-space:pre;"><span class="cls_0">All numeric RGB values begin with a number-sign prefix, but that prefix can be followed with eight,</span></div><div style="position:absolute;left:111px;top:324px;white-space:pre;"><span class="cls_0">six, four, or three hexadecimal digits for specifying color values with or without an alpha channel.</span></div><div style="position:absolute;left:111px;top:342px;white-space:pre;"><span class="cls_0">Here’s the most extensive syntax:</span></div><div style="position:absolute;left:111px;top:367px;white-space:pre;"><span class="cls_14">BackgroundColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">#aarrggbb</span><span class="cls_1">"</span></div><div style="position:absolute;left:111px;top:392px;white-space:pre;"><span class="cls_0">Each of the letters represents a hexadecimal digit, in the order alpha (opacity), red, green, and blue. For</span></div><div style="position:absolute;left:111px;top:410px;white-space:pre;"><span class="cls_0">the alpha channel, keep in mind that 0xFF is fully opaque and 0x00 is fully transparent. </span><span class="cls_0">Here’s the syn-</span></div><div style="position:absolute;left:111px;top:427px;white-space:pre;"><span class="cls_0">tax without an alpha channel:</span></div><div style="position:absolute;left:111px;top:452px;white-space:pre;"><span class="cls_14">BackgroundColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">#rrggbb</span><span class="cls_1">"</span></div><div style="position:absolute;left:111px;top:478px;white-space:pre;"><span class="cls_0">In this case the alpha value is set to 0xFF for full opacity.</span></div><div style="position:absolute;left:127px;top:504px;white-space:pre;"><span class="cls_0">Two other formats allow you to specify only a single hexadecimal digit for each channel:</span></div><div style="position:absolute;left:111px;top:530px;white-space:pre;"><span class="cls_14">BackgroundColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">#argb</span><span class="cls_1">"</span></div><div style="position:absolute;left:111px;top:543px;white-space:pre;"><span class="cls_14">BackgroundColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">#rgb</span><span class="cls_1">"</span></div><div style="position:absolute;left:111px;top:568px;white-space:pre;"><span class="cls_0">In these cases, the digit is repeated to form the value. For example, #CF3 is the RGB color 0xCC-0xFF-</span></div><div style="position:absolute;left:111px;top:586px;white-space:pre;"><span class="cls_0">0x33. These short formats are rarely used.</span></div><div style="position:absolute;left:127px;top:612px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">FontSize</span><span class="cls_0">property of </span><span class="cls_5">Label</span><span class="cls_0">is of type </span><span class="cls_5">double</span><span class="cls_0">. This is a little different from properties of type</span></div><div style="position:absolute;left:111px;top:630px;white-space:pre;"><span class="cls_5">LayoutOptions</span><span class="cls_0">and </span><span class="cls_5">Color</span><span class="cls_0">. The </span><span class="cls_5">LayoutOptions</span><span class="cls_0">and </span><span class="cls_5">Color</span><span class="cls_0">structures are part of Xamarin.Forms, so</span></div><div style="position:absolute;left:111px;top:647px;white-space:pre;"><span class="cls_0">they can be flagged with the C# </span><span class="cls_5">TypeConverter</span><span class="cls_0">attribute, but it’s not possible to flag the .NET</span></div><div style="position:absolute;left:111px;top:664px;white-space:pre;"><span class="cls_5">Double</span><span class="cls_0">structure with a </span><span class="cls_5">TypeConverter</span><span class="cls_0">attribute just for font sizes!</span></div><div style="position:absolute;left:127px;top:691px;white-space:pre;"><span class="cls_0">Instead, the </span><span class="cls_5">FontSize</span><span class="cls_0">property within the </span><span class="cls_5">Label</span><span class="cls_0">class has the </span><span class="cls_5">TypeConverter</span><span class="cls_0">attribute:</span></div><div style="position:absolute;left:111px;top:716px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">Label </span><span class="cls_1">: </span><span class="cls_2">View</span><span class="cls_1">, </span><span class="cls_2">IFontElement</span></div><div style="position:absolute;left:111px;top:730px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:743px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:133px;top:756px;white-space:pre;"><span class="cls_1">[</span><span class="cls_2">TypeConverter </span><span class="cls_1">(</span><span class="cls_4">typeof </span><span class="cls_1">(</span><span class="cls_2">FontSizeConverter</span><span class="cls_1">))]</span></div><div style="position:absolute;left:133px;top:770px;white-space:pre;"><span class="cls_4">public double </span><span class="cls_1">FontSize</span></div><div style="position:absolute;left:133px;top:783px;white-space:pre;"><span class="cls_1">{</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image80.png" width="708" height="864" alt=""></div><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">136</span></div><div style="position:absolute;left:132px;top:71px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:109px;top:84px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:98px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:87px;top:111px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:136px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">FontSizeConverter</span><span class="cls_0">class determines whether the string passed to it is one of the members of</span></div><div style="position:absolute;left:87px;top:154px;white-space:pre;"><span class="cls_0">the </span><span class="cls_5">NamedSize</span><span class="cls_0">enumeration. If not, </span><span class="cls_5">FontSizeConverter</span><span class="cls_0">assumes the value is a </span><span class="cls_5">double</span><span class="cls_0">.</span></div><div style="position:absolute;left:103px;top:180px;white-space:pre;"><span class="cls_0">The last attribute set in the example is </span><span class="cls_5">FontAttributes</span><span class="cls_0">. The </span><span class="cls_5">FontAttributes</span><span class="cls_0">property is an enu-</span></div><div style="position:absolute;left:87px;top:198px;white-space:pre;"><span class="cls_0">meration named </span><span class="cls_5">FontAttributes</span><span class="cls_0">, and you already know that the XAML parser handles enumeration</span></div><div style="position:absolute;left:87px;top:215px;white-space:pre;"><span class="cls_0">types automatically. However, the </span><span class="cls_5">FontAttributes</span><span class="cls_0">enumeration has a C# </span><span class="cls_5">Flags</span><span class="cls_0">attribute set like so:</span></div><div style="position:absolute;left:87px;top:240px;white-space:pre;"><span class="cls_1">[</span><span class="cls_2">Flags</span><span class="cls_1">]</span></div><div style="position:absolute;left:87px;top:254px;white-space:pre;"><span class="cls_4">public enum </span><span class="cls_2">FontAttributes</span></div><div style="position:absolute;left:87px;top:267px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:280px;white-space:pre;"><span class="cls_1">None = 0,</span></div><div style="position:absolute;left:109px;top:294px;white-space:pre;"><span class="cls_1">Bold = 1,</span></div><div style="position:absolute;left:109px;top:307px;white-space:pre;"><span class="cls_1">Italic = 2</span></div><div style="position:absolute;left:87px;top:320px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:346px;white-space:pre;"><span class="cls_0">The XAML parser therefore allows multiple members separated by commas:</span></div><div style="position:absolute;left:87px;top:371px;white-space:pre;"><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Bold,Italic</span><span class="cls_1">"</span></div><div style="position:absolute;left:103px;top:396px;white-space:pre;"><span class="cls_0">This demonstration of the mechanical nature of the XAML parser should be very good news. It</span></div><div style="position:absolute;left:87px;top:414px;white-space:pre;"><span class="cls_0">means that you can include custom classes in XAML, and these classes can have properties of custom</span></div><div style="position:absolute;left:87px;top:431px;white-space:pre;"><span class="cls_0">types, or the properties can be of standard types but allow additional values. All you need is to flag</span></div><div style="position:absolute;left:87px;top:448px;white-space:pre;"><span class="cls_0">these types or properties with a C# </span><span class="cls_5">TypeConverter</span><span class="cls_0">attribute and provide a class that derives from</span></div><div style="position:absolute;left:87px;top:466px;white-space:pre;"><span class="cls_5">TypeConverter</span><span class="cls_0">.</span></div><div style="position:absolute;left:55px;top:505px;white-space:pre;"><span class="cls_11">Property-element</span><span class="cls_12"> </span><span class="cls_11">syntax</span></div><div style="position:absolute;left:87px;top:554px;white-space:pre;"><span class="cls_0">Here is some C# that is similar to the </span><span class="cls_13">FramedText</span><span class="cls_0"> </span><span class="cls_0">code in Chapter 4. In one statement it instantiates a</span></div><div style="position:absolute;left:87px;top:571px;white-space:pre;"><span class="cls_5">Frame</span><span class="cls_0">and a </span><span class="cls_5">Label</span><span class="cls_0">and sets the </span><span class="cls_5">Label</span><span class="cls_0">to the </span><span class="cls_5">Content</span><span class="cls_0">property of the </span><span class="cls_5">Frame</span><span class="cls_0">:</span></div><div style="position:absolute;left:87px;top:596px;white-space:pre;"><span class="cls_4">new </span><span class="cls_2">Frame</span></div><div style="position:absolute;left:87px;top:610px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:623px;white-space:pre;"><span class="cls_1">OutlineColor = </span><span class="cls_2">Color</span><span class="cls_1">.Accent,</span></div><div style="position:absolute;left:109px;top:636px;white-space:pre;"><span class="cls_1">HorizontalOptions = </span><span class="cls_2">LayoutOptions</span><span class="cls_1">.Center,</span></div><div style="position:absolute;left:109px;top:650px;white-space:pre;"><span class="cls_1">VerticalOptions = </span><span class="cls_2">LayoutOptions</span><span class="cls_1">.Center,</span></div><div style="position:absolute;left:109px;top:663px;white-space:pre;"><span class="cls_1">Content = </span><span class="cls_4">new </span><span class="cls_2">Label</span></div><div style="position:absolute;left:109px;top:676px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:690px;white-space:pre;"><span class="cls_1">Text = </span><span class="cls_6">"Greetings, Xamarin.Forms!"</span></div><div style="position:absolute;left:109px;top:703px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:716px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:103px;top:742px;white-space:pre;"><span class="cls_0">But when you start to duplicate this in XAML, you might become a little stymied at the point where</span></div><div style="position:absolute;left:87px;top:759px;white-space:pre;"><span class="cls_0">you set the </span><span class="cls_5">Content</span><span class="cls_0">attribute:</span></div><div style="position:absolute;left:87px;top:784px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame </span><span class="cls_14">OutlineColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Accent</span><span class="cls_1">"</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">137</span></div><div style="position:absolute;left:150px;top:71px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:84px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:98px;white-space:pre;"><span class="cls_14">Content</span><span class="cls_4">=</span><span class="cls_1">" </span><span class="cls_4">what goes here? </span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:111px;top:123px;white-space:pre;"><span class="cls_0">How can that </span><span class="cls_5">Content</span><span class="cls_0">attribute be set to an entire </span><span class="cls_5">Label</span><span class="cls_0">object?</span></div><div style="position:absolute;left:127px;top:150px;white-space:pre;"><span class="cls_0">The solution to this problem is the most fundamental feature of XAML syntax. The first step is to</span></div><div style="position:absolute;left:111px;top:167px;white-space:pre;"><span class="cls_0">separate the </span><span class="cls_5">Frame</span><span class="cls_0">tag into start and end tags:</span></div><div style="position:absolute;left:111px;top:192px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame </span><span class="cls_14">OutlineColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Accent</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:206px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:219px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:246px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:271px;white-space:pre;"><span class="cls_0">Within those tags, add two more tags that consist of the element (</span><span class="cls_5">Frame</span><span class="cls_0">) and the property you want</span></div><div style="position:absolute;left:111px;top:288px;white-space:pre;"><span class="cls_0">to set (</span><span class="cls_5">Content</span><span class="cls_0">) connected with a period:</span></div><div style="position:absolute;left:111px;top:314px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame </span><span class="cls_14">OutlineColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Accent</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:327px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:340px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:354px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:380px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:394px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:419px;white-space:pre;"><span class="cls_0">Now put the </span><span class="cls_5">Label</span><span class="cls_0">within those tags:</span></div><div style="position:absolute;left:111px;top:444px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame </span><span class="cls_14">OutlineColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Accent</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:458px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:471px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:484px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:498px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Greetings, Xamarin.Forms!</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:133px;top:511px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:524px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:550px;white-space:pre;"><span class="cls_0">That syntax is how you set a </span><span class="cls_5">Label</span><span class="cls_0">to the </span><span class="cls_5">Content</span><span class="cls_0">property of the </span><span class="cls_5">Frame</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:576px;white-space:pre;"><span class="cls_0">You might wonder if this XAML feature violates XML syntax rules. It does not. The period has no</span></div><div style="position:absolute;left:111px;top:594px;white-space:pre;"><span class="cls_0">special meaning in XML, so </span><span class="cls_5">Frame.Content</span><span class="cls_0">is a perfectly valid XML tag. However, XAML imposes its</span></div><div style="position:absolute;left:111px;top:611px;white-space:pre;"><span class="cls_0">own rules about these tags: The </span><span class="cls_5">Frame.Content</span><span class="cls_0">tags must appear within </span><span class="cls_5">Frame</span><span class="cls_0">tags, and no attrib-</span></div><div style="position:absolute;left:111px;top:628px;white-space:pre;"><span class="cls_0">utes can be set in the </span><span class="cls_5">Frame.Content</span><span class="cls_0">tag. The object set to the </span><span class="cls_5">Content</span><span class="cls_0">property appears as the</span></div><div style="position:absolute;left:111px;top:646px;white-space:pre;"><span class="cls_0">XML content of those tags.</span></div><div style="position:absolute;left:127px;top:672px;white-space:pre;"><span class="cls_0">Once this syntax is introduced, some terminology becomes necessary. In the final XAML snippet</span></div><div style="position:absolute;left:111px;top:690px;white-space:pre;"><span class="cls_0">shown above:</span></div><div style="position:absolute;left:125px;top:715px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:716px;white-space:pre;"><span class="cls_5">Frame</span><span class="cls_0">and </span><span class="cls_5">Label</span><span class="cls_0">are C# objects expressed as XML elements. They are called </span><span class="cls_9">object</span><span class="cls_0"> </span><span class="cls_9">elements</span><span class="cls_0">.</span></div><div style="position:absolute;left:125px;top:742px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:743px;white-space:pre;"><span class="cls_5">OutlineColor</span><span class="cls_0">, </span><span class="cls_5">HorizontalOptions</span><span class="cls_0">, </span><span class="cls_5">VerticalOptions</span><span class="cls_0">, and </span><span class="cls_5">Text</span><span class="cls_0">are C# properties ex-</span></div><div style="position:absolute;left:149px;top:760px;white-space:pre;"><span class="cls_0">pressed as XML attributes. They are called </span><span class="cls_9">property</span><span class="cls_0"> </span><span class="cls_9">attributes</span><span class="cls_0">.</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">138</span></div><div style="position:absolute;left:101px;top:71px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:125px;top:72px;white-space:pre;"><span class="cls_5">Frame.Content</span><span class="cls_0">is a C# property expressed as an XML element, and it is therefore called a</span></div><div style="position:absolute;left:125px;top:90px;white-space:pre;"><span class="cls_9">property</span><span class="cls_0"> </span><span class="cls_9">element</span><span class="cls_0">.</span></div><div style="position:absolute;left:103px;top:116px;white-space:pre;"><span class="cls_0">Property elements are very common in real-life XAML. </span><span class="cls_0">You’ll see numerous </span><span class="cls_0">examples in this chapter</span></div><div style="position:absolute;left:87px;top:134px;white-space:pre;"><span class="cls_0">and future chapters, and you’ll soon find property elements becoming second nature </span><span class="cls_0">to your use of</span></div><div style="position:absolute;left:87px;top:151px;white-space:pre;"><span class="cls_0">XAML. But watch out: Sometimes developers must remember so much that we forget the basics. Even</span></div><div style="position:absolute;left:87px;top:168px;white-space:pre;"><span class="cls_0">after you’ve been </span><span class="cls_0">using </span><span class="cls_0">XAML for a while, you’ll probably encounter a situation where it doesn’t seem</span></div><div style="position:absolute;left:87px;top:186px;white-space:pre;"><span class="cls_0">possible to set a particular object to a particular property. The solution is very often a property</span></div><div style="position:absolute;left:87px;top:203px;white-space:pre;"><span class="cls_0">element.</span></div><div style="position:absolute;left:103px;top:230px;white-space:pre;"><span class="cls_0">You can also use property-element syntax for simpler properties, for example:</span></div><div style="position:absolute;left:87px;top:255px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame </span><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:268px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame.VerticalOptions</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:282px;white-space:pre;"><span class="cls_1">Center</span></div><div style="position:absolute;left:109px;top:295px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame.VerticalOptions</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:308px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame.OutlineColor</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:322px;white-space:pre;"><span class="cls_1">Accent</span></div><div style="position:absolute;left:109px;top:335px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame.OutlineColor</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:348px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:362px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:375px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.Text</span><span class="cls_4">></span></div><div style="position:absolute;left:177px;top:388px;white-space:pre;"><span class="cls_1">Greetings, Xamarin.Forms!</span></div><div style="position:absolute;left:154px;top:402px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.Text</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:415px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:428px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:442px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:467px;white-space:pre;"><span class="cls_0">Now the </span><span class="cls_5">VerticalOptions</span><span class="cls_0">and </span><span class="cls_5">OutlineColor</span><span class="cls_0">properties of </span><span class="cls_5">Frame</span><span class="cls_0">and the </span><span class="cls_5">Text</span><span class="cls_0">property of </span><span class="cls_5">Label</span></div><div style="position:absolute;left:87px;top:484px;white-space:pre;"><span class="cls_0">have all become property elements. The value of these attributes is always the content of the property</span></div><div style="position:absolute;left:87px;top:502px;white-space:pre;"><span class="cls_0">element without quotation marks.</span></div><div style="position:absolute;left:103px;top:528px;white-space:pre;"><span class="cls_0">Of course, it doesn’t make much sense to def</span><span class="cls_0">ine these properties as property elements. It</span><span class="cls_0">’s </span><span class="cls_0">unneces-</span></div><div style="position:absolute;left:87px;top:546px;white-space:pre;"><span class="cls_0">sarily verbose. But it works as it should.</span></div><div style="position:absolute;left:103px;top:572px;white-space:pre;"><span class="cls_0">Let’s go a little further: Instead of setting </span><span class="cls_5">HorizontalOptions</span><span class="cls_0">to “Center” (corresponding to the</span></div><div style="position:absolute;left:87px;top:590px;white-space:pre;"><span class="cls_0">static property </span><span class="cls_5">LayoutOptions.Center</span><span class="cls_0">), you can express </span><span class="cls_5">HorizontalOptions</span><span class="cls_0">as a property ele-</span></div><div style="position:absolute;left:87px;top:607px;white-space:pre;"><span class="cls_0">ment and set it to a </span><span class="cls_5">LayoutOptions</span><span class="cls_0">value with its individual properties set:</span></div><div style="position:absolute;left:87px;top:632px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:646px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame.HorizontalOptions</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:659px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">LayoutOptions </span><span class="cls_14">Alignment</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:216px;top:672px;white-space:pre;"><span class="cls_14">Expands</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">False</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:109px;top:686px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame.HorizontalOptions</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:699px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame.VerticalOptions</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:712px;white-space:pre;"><span class="cls_1">Center</span></div><div style="position:absolute;left:109px;top:726px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame.VerticalOptions</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:739px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame.OutlineColor</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:752px;white-space:pre;"><span class="cls_1">Accent</span></div><div style="position:absolute;left:109px;top:766px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame.OutlineColor</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:779px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame.Content</span><span class="cls_4">></span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">139</span></div><div style="position:absolute;left:156px;top:71px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:84px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.Text</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:98px;white-space:pre;"><span class="cls_1">Greetings, Xamarin.Forms!</span></div><div style="position:absolute;left:178px;top:111px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.Text</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:124px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:138px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:151px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame</span><span class="cls_4">></span></div><div style="position:absolute;left:127px;top:176px;white-space:pre;"><span class="cls_0">And you can also express these properties of </span><span class="cls_5">LayoutOptions</span><span class="cls_0">as property elements:</span></div><div style="position:absolute;left:111px;top:202px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:215px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame.HorizontalOptions</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:228px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">LayoutOptions</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:242px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">LayoutOptions.Alignment</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:255px;white-space:pre;"><span class="cls_1">Center</span></div><div style="position:absolute;left:178px;top:268px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">LayoutOptions.Alignment</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:282px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">LayoutOptions.Expands</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:295px;white-space:pre;"><span class="cls_1">False</span></div><div style="position:absolute;left:178px;top:308px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">LayoutOptions.Expands</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:322px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">LayoutOptions</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:335px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame.HorizontalOptions</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:348px;white-space:pre;"><span class="cls_4">…</span></div><div style="position:absolute;left:111px;top:362px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame</span><span class="cls_4">></span></div><div style="position:absolute;left:127px;top:387px;white-space:pre;"><span class="cls_0">You can’t set the same property as a property attribute and a property element. That’s setting the</span></div><div style="position:absolute;left:111px;top:404px;white-space:pre;"><span class="cls_0">property twice, and it’s not allowed. And remember that </span><span class="cls_0">nothing else can appear in the property-</span></div><div style="position:absolute;left:111px;top:422px;white-space:pre;"><span class="cls_0">element tags. The value being set to the property is always the XML content of those tags.</span></div><div style="position:absolute;left:127px;top:448px;white-space:pre;"><span class="cls_0">Now you should know how to use a </span><span class="cls_5">StackLayout</span><span class="cls_0">in XAML. First express the </span><span class="cls_5">Children</span><span class="cls_0">property as</span></div><div style="position:absolute;left:111px;top:466px;white-space:pre;"><span class="cls_0">the property element </span><span class="cls_5">StackLayout.Children</span><span class="cls_0">, and then include the children of the </span><span class="cls_5">StackLayout</span><span class="cls_0">as</span></div><div style="position:absolute;left:111px;top:483px;white-space:pre;"><span class="cls_0">XML content of the property-</span><span class="cls_0">element tags. Here’s an example where each child </span><span class="cls_0">of the first </span><span class="cls_5">StackLay-</span></div><div style="position:absolute;left:111px;top:500px;white-space:pre;"><span class="cls_5">out</span><span class="cls_0">is another </span><span class="cls_5">StackLayout</span><span class="cls_0">with a horizontal orientation:</span></div><div style="position:absolute;left:111px;top:526px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:539px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:552px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">Orientation</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Horizontal</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:566px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:579px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">Color</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Red</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:201px;top:592px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Red</span><span class="cls_1">"</span></div><div style="position:absolute;left:240px;top:606px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:619px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:632px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:659px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">Orientation</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Horizontal</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:672px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:686px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">Color</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Green</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:201px;top:699px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Green</span><span class="cls_1">"</span></div><div style="position:absolute;left:240px;top:712px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:726px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:739px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:766px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">Orientation</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Horizontal</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:779px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image81.png" width="708" height="864" alt=""></div><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">140</span></div><div style="position:absolute;left:177px;top:71px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">Color</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Blue</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:177px;top:84px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Blue</span><span class="cls_1">"</span></div><div style="position:absolute;left:216px;top:98px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:154px;top:111px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:124px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:138px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:151px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:176px;white-space:pre;"><span class="cls_0">Each horizontal </span><span class="cls_5">StackLayout</span><span class="cls_0">has a </span><span class="cls_5">BoxView</span><span class="cls_0">with a color and a </span><span class="cls_5">Label</span><span class="cls_0">with that color name.</span></div><div style="position:absolute;left:103px;top:203px;white-space:pre;"><span class="cls_0">Of course, the repetitive markup here looks rather scary! What if you wanted to display 16 colors?</span></div><div style="position:absolute;left:87px;top:220px;white-space:pre;"><span class="cls_0">Or 140? You might succeed at first with a lot of copying and pasting, but if you then needed to refine</span></div><div style="position:absolute;left:87px;top:238px;white-space:pre;"><span class="cls_0">the visuals a bit, </span><span class="cls_0">you’d be in bad shape. In code you’d do this in a loop, but XAML has no such feature.</span></div><div style="position:absolute;left:103px;top:264px;white-space:pre;"><span class="cls_0">When markup threatens to be overly repetitious, you can always use code. Defining some of a user</span></div><div style="position:absolute;left:87px;top:282px;white-space:pre;"><span class="cls_0">interface in XAML and the rest in code is perfectly reasonable. But there </span><span class="cls_0">are other solutions, as you’ll</span></div><div style="position:absolute;left:87px;top:299px;white-space:pre;"><span class="cls_0">see in later chapters.</span></div><div style="position:absolute;left:55px;top:339px;white-space:pre;"><span class="cls_11">Adding</span><span class="cls_12"> </span><span class="cls_11">a</span><span class="cls_12"> </span><span class="cls_11">XAML</span><span class="cls_12"> </span><span class="cls_11">page</span><span class="cls_12"> </span><span class="cls_11">to</span><span class="cls_12"> </span><span class="cls_11">your</span><span class="cls_12"> </span><span class="cls_11">project</span></div><div style="position:absolute;left:87px;top:387px;white-space:pre;"><span class="cls_0">Now that you’ve seen some snippets of XAML, let’s look at a whole XAML page in the context of a</span></div><div style="position:absolute;left:87px;top:404px;white-space:pre;"><span class="cls_0">complete program. First, create a Xamarin.Forms solution named </span><span class="cls_13">CodePlusXaml</span><span class="cls_0"> </span><span class="cls_0">using the Portable</span></div><div style="position:absolute;left:87px;top:422px;white-space:pre;"><span class="cls_0">Class Library solution template.</span></div><div style="position:absolute;left:103px;top:448px;white-space:pre;"><span class="cls_0">Now add a XAML </span><span class="cls_5">ContentPage</span><span class="cls_0">to the PCL. Here’s how: In Visual Studio, right</span><span class="cls_0">-click the</span></div><div style="position:absolute;left:87px;top:466px;white-space:pre;"><span class="cls_13">CodePlusXaml</span><span class="cls_0"> </span><span class="cls_0">project in the </span><span class="cls_13">Solution</span><span class="cls_0"> </span><span class="cls_13">Explorer</span><span class="cls_0">. Select </span><span class="cls_13">Add</span><span class="cls_0"> </span><span class="cls_13">></span><span class="cls_0"> </span><span class="cls_13">New</span><span class="cls_0"> </span><span class="cls_13">Item</span><span class="cls_0"> </span><span class="cls_0">from the menu. In the </span><span class="cls_13">Add</span></div><div style="position:absolute;left:87px;top:483px;white-space:pre;"><span class="cls_13">New</span><span class="cls_0"> </span><span class="cls_13">Item</span><span class="cls_0"> </span><span class="cls_0">dialog, select </span><span class="cls_13">Visual</span><span class="cls_0"> </span><span class="cls_13">C#</span><span class="cls_0"> </span><span class="cls_0">and </span><span class="cls_13">Cross-Platform</span><span class="cls_0"> </span><span class="cls_0">at the left, and </span><span class="cls_13">Forms</span><span class="cls_0"> </span><span class="cls_13">Xaml</span><span class="cls_0"> </span><span class="cls_13">Page</span><span class="cls_0"> </span><span class="cls_0">from the</span></div><div style="position:absolute;left:87px;top:500px;white-space:pre;"><span class="cls_0">central list. Name it CodePlusXamlPage.cs.</span></div><div style="position:absolute;left:103px;top:527px;white-space:pre;"><span class="cls_0">In Xamarin Studio, invoke the drop-down menu on the </span><span class="cls_13">CodePlusXaml</span><span class="cls_0"> </span><span class="cls_0">project in the </span><span class="cls_13">Solution</span><span class="cls_0"> </span><span class="cls_0">list,</span></div><div style="position:absolute;left:87px;top:544px;white-space:pre;"><span class="cls_0">and select </span><span class="cls_13">Add</span><span class="cls_0"> </span><span class="cls_13">></span><span class="cls_0"> </span><span class="cls_13">New</span><span class="cls_0"> </span><span class="cls_13">File</span><span class="cls_0">. In the </span><span class="cls_13">New</span><span class="cls_0"> </span><span class="cls_13">File</span><span class="cls_0"> </span><span class="cls_0">dialog, select </span><span class="cls_13">Forms</span><span class="cls_0"> </span><span class="cls_0">at the left and </span><span class="cls_13">Forms</span><span class="cls_0"> </span><span class="cls_13">ContentPage</span></div><div style="position:absolute;left:87px;top:562px;white-space:pre;"><span class="cls_13">Xaml</span><span class="cls_0"> </span><span class="cls_0">in the central list. (Watch out: There’s also a </span><span class="cls_13">Forms</span><span class="cls_0"> </span><span class="cls_13">ContentView</span><span class="cls_0"> </span><span class="cls_13">Xaml</span><span class="cls_0"> </span><span class="cls_0">in the list. You want a</span></div><div style="position:absolute;left:87px;top:579px;white-space:pre;"><span class="cls_0">content </span><span class="cls_9">page</span><span class="cls_0">.) Name it CodePlusXamlPage.</span></div><div style="position:absolute;left:103px;top:606px;white-space:pre;"><span class="cls_0">In either case, two files are created:</span></div><div style="position:absolute;left:101px;top:631px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:125px;top:632px;white-space:pre;"><span class="cls_0">CodePlusXamlPage.xaml, the XAML file; and</span></div><div style="position:absolute;left:101px;top:658px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:125px;top:659px;white-space:pre;"><span class="cls_0">CodePlusXamlPage.xaml.cs, a C# file (despite the odd double extension on the filename).</span></div><div style="position:absolute;left:87px;top:686px;white-space:pre;"><span class="cls_0">In the file list, the second file is indented underneath the first, indicating their close relationship. The C#</span></div><div style="position:absolute;left:87px;top:703px;white-space:pre;"><span class="cls_0">file is often referred to as the </span><span class="cls_9">code-behind</span><span class="cls_0"> </span><span class="cls_0">of the XAML file. It contains code that supports the markup.</span></div><div style="position:absolute;left:87px;top:720px;white-space:pre;"><span class="cls_0">These two files both contribute to a class named </span><span class="cls_5">CodePlusXamlPage</span><span class="cls_0">that derives from </span><span class="cls_5">ContentPage</span><span class="cls_0">.</span></div><div style="position:absolute;left:103px;top:747px;white-space:pre;"><span class="cls_0">Let’s examine the code file first. Excluding the </span><span class="cls_5">using</span><span class="cls_0">directives, it looks like this:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">141</span></div><div style="position:absolute;left:111px;top:71px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">CodePlusXaml</span></div><div style="position:absolute;left:111px;top:84px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:98px;white-space:pre;"><span class="cls_4">public partial class </span><span class="cls_2">CodePlusXamlPage </span><span class="cls_1">: </span><span class="cls_2">ContentPage</span></div><div style="position:absolute;left:133px;top:111px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:124px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">CodePlusXamlPage()</span></div><div style="position:absolute;left:156px;top:138px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:151px;white-space:pre;"><span class="cls_1">InitializeComponent();</span></div><div style="position:absolute;left:156px;top:164px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:133px;top:178px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:191px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:216px;white-space:pre;"><span class="cls_0">It is indeed a class named </span><span class="cls_5">CodePlusXamlPage</span><span class="cls_0">that derives from </span><span class="cls_5">ContentPage</span><span class="cls_0">, just as anticipated.</span></div><div style="position:absolute;left:111px;top:234px;white-space:pre;"><span class="cls_0">However, the class definition includes a </span><span class="cls_5">partial</span><span class="cls_0">keyword, which usually indicates that this is only part</span></div><div style="position:absolute;left:111px;top:251px;white-space:pre;"><span class="cls_0">of the </span><span class="cls_5">CodePlusXamlPage</span><span class="cls_0">class definition. Somewhere else there should be another partial class defi-</span></div><div style="position:absolute;left:111px;top:268px;white-space:pre;"><span class="cls_0">nition for </span><span class="cls_5">CodePlusXamlPage</span><span class="cls_0">. So if it exists, where is it? It’s a mystery! (For now.)</span></div><div style="position:absolute;left:127px;top:295px;white-space:pre;"><span class="cls_0">Another mystery is the </span><span class="cls_5">InitializeComponent</span><span class="cls_0">method that the constructor calls. Judging solely</span></div><div style="position:absolute;left:111px;top:312px;white-space:pre;"><span class="cls_0">from the syntax, it seems as though this method should be defined or inherited by </span><span class="cls_5">ContentPage</span><span class="cls_0">. Yet</span></div><div style="position:absolute;left:111px;top:330px;white-space:pre;"><span class="cls_0">you </span><span class="cls_0">won’t find </span><span class="cls_5">InitializeComponent</span><span class="cls_0">in the API documentation.</span></div><div style="position:absolute;left:127px;top:356px;white-space:pre;"><span class="cls_0">Let’s set those two mysteries aside temporarily and look at the XAML file. The Visual Studio and</span></div><div style="position:absolute;left:111px;top:374px;white-space:pre;"><span class="cls_0">Xamarin Studio templates generate two somewhat different XAML files. If you’re using Visual Studio,</span></div><div style="position:absolute;left:111px;top:391px;white-space:pre;"><span class="cls_0">delete the markup for the </span><span class="cls_5">Label</span><span class="cls_0">and replace it with </span><span class="cls_5">ContentPage.Content</span><span class="cls_0">property-element tags</span></div><div style="position:absolute;left:111px;top:408px;white-space:pre;"><span class="cls_0">so that it looks like the version in Xamarin Studio:</span></div><div style="position:absolute;left:111px;top:434px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:447px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:460px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CodePlusXaml.CodePlusXamlPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:474px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:487px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:500px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:526px;white-space:pre;"><span class="cls_0">The root element is </span><span class="cls_5">ContentPage</span><span class="cls_0">, which is the class that </span><span class="cls_5">CodePlusXamlPage</span><span class="cls_0">derives from. That tag</span></div><div style="position:absolute;left:111px;top:543px;white-space:pre;"><span class="cls_0">begins with two XML </span><span class="cls_0">namespace declarations, both of which are URIs. But don’t bother checking the</span></div><div style="position:absolute;left:111px;top:560px;white-space:pre;"><span class="cls_0">web addresses! There’s nothing there. These URIs simply indicate who owns the namespace and what</span></div><div style="position:absolute;left:111px;top:578px;white-space:pre;"><span class="cls_0">function it serves.</span></div><div style="position:absolute;left:127px;top:604px;white-space:pre;"><span class="cls_0">The default namespace belongs to Xamarin. This is the XML namespace for elements in the file with</span></div><div style="position:absolute;left:111px;top:622px;white-space:pre;"><span class="cls_0">no prefix, such as the </span><span class="cls_5">ContentPage</span><span class="cls_0">tag. The URI includes the year that this namespace came into be-</span></div><div style="position:absolute;left:111px;top:639px;white-space:pre;"><span class="cls_0">ing and the word </span><span class="cls_5">forms</span><span class="cls_0">as an abbreviation for Xamarin.Forms.</span></div><div style="position:absolute;left:127px;top:666px;white-space:pre;"><span class="cls_0">The second namespace is associated with a prefix of </span><span class="cls_5">x</span><span class="cls_0">by convention, and it belongs to Microsoft.</span></div><div style="position:absolute;left:111px;top:683px;white-space:pre;"><span class="cls_0">This namespace refers to elements and attributes that are intrinsic to XAML and are found in every</span></div><div style="position:absolute;left:111px;top:700px;white-space:pre;"><span class="cls_0">XAML implementation. The word </span><span class="cls_5">winfx</span><span class="cls_0">refers to a name once used for the .NET Framework 3.0, which</span></div><div style="position:absolute;left:111px;top:718px;white-space:pre;"><span class="cls_0">introduced WPF and XAML. The year 2009 refers to a particular XAML specification, which also implies</span></div><div style="position:absolute;left:111px;top:735px;white-space:pre;"><span class="cls_0">a particular collection of elements and attributes that build upon the original XAML specification,</span></div><div style="position:absolute;left:111px;top:752px;white-space:pre;"><span class="cls_0">which is dated 2006. However, Xamarin.Forms implements only a subset of the elements and attributes</span></div><div style="position:absolute;left:111px;top:770px;white-space:pre;"><span class="cls_0">in the 2009 specification.</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">142</span></div><div style="position:absolute;left:103px;top:72px;white-space:pre;"><span class="cls_0">The next line is one of the attributes that is intrinsic to XAML, called </span><span class="cls_5">Class</span><span class="cls_0">. Because the </span><span class="cls_5">x</span><span class="cls_0">prefix is</span></div><div style="position:absolute;left:87px;top:90px;white-space:pre;"><span class="cls_0">almost universally used for this namespace, this attribute is commonly referred to as </span><span class="cls_5">x:Class</span><span class="cls_0">and pro-</span></div><div style="position:absolute;left:87px;top:107px;white-space:pre;"><span class="cls_0">nounced “x class.”</span></div><div style="position:absolute;left:103px;top:134px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">x:Class</span><span class="cls_0">attribute can appear only on the root element of a XAML file. It specifies the .NET</span></div><div style="position:absolute;left:87px;top:151px;white-space:pre;"><span class="cls_0">namespace and name of a derived class. The base class of this derived class is the root element. In</span></div><div style="position:absolute;left:87px;top:168px;white-space:pre;"><span class="cls_0">other words, this </span><span class="cls_5">x:Class</span><span class="cls_0">specification indicates that the </span><span class="cls_5">CodePlusXamlPage</span><span class="cls_0">class in the</span></div><div style="position:absolute;left:87px;top:186px;white-space:pre;"><span class="cls_5">CodePlusXaml</span><span class="cls_0">namespace derives from </span><span class="cls_5">ContentPage</span><span class="cls_0">. That’s exactly the same information as the</span></div><div style="position:absolute;left:87px;top:203px;white-space:pre;"><span class="cls_5">CodePlusXamlPage</span><span class="cls_0">class definition in the CodePlusXamlPage.xaml.cs file.</span></div><div style="position:absolute;left:103px;top:230px;white-space:pre;"><span class="cls_0">Let’s add some content to this </span><span class="cls_5">ContentPage</span><span class="cls_0">in the XAML file. This requires setting something to</span></div><div style="position:absolute;left:87px;top:247px;white-space:pre;"><span class="cls_0">the </span><span class="cls_5">Content</span><span class="cls_0">property, which in the XAML file means putting something between </span><span class="cls_5">ContentPage.Con-</span></div><div style="position:absolute;left:87px;top:264px;white-space:pre;"><span class="cls_5">tent</span><span class="cls_0">property-element tags. Begin the content with a </span><span class="cls_5">StackLayout</span><span class="cls_0">, and then add a </span><span class="cls_5">Label</span><span class="cls_0">to the</span></div><div style="position:absolute;left:87px;top:282px;white-space:pre;"><span class="cls_5">Children</span><span class="cls_0">property:</span></div><div style="position:absolute;left:87px;top:307px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:320px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:334px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CodePlusXaml.CodePlusXamlPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:347px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:360px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:374px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div><div style="position:absolute;left:177px;top:387px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Hello from XAML!</span><span class="cls_1">"</span></div><div style="position:absolute;left:216px;top:400px;white-space:pre;"><span class="cls_14">IsVisible</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">True</span><span class="cls_1">"</span></div><div style="position:absolute;left:216px;top:414px;white-space:pre;"><span class="cls_14">Opacity</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">0.75</span><span class="cls_1">"</span></div><div style="position:absolute;left:216px;top:427px;white-space:pre;"><span class="cls_14">HorizontalTextAlignment</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:216px;top:440px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span></div><div style="position:absolute;left:216px;top:454px;white-space:pre;"><span class="cls_14">TextColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Blue</span><span class="cls_1">"</span></div><div style="position:absolute;left:216px;top:467px;white-space:pre;"><span class="cls_14">BackgroundColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">#FF8080</span><span class="cls_1">"</span></div><div style="position:absolute;left:216px;top:480px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:216px;top:494px;white-space:pre;"><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Bold,Italic</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:154px;top:507px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:520px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:534px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:547px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:572px;white-space:pre;"><span class="cls_0">That’s the XAML </span><span class="cls_5">Label</span><span class="cls_0">you saw at the beginning of this chapter.</span></div><div style="position:absolute;left:103px;top:599px;white-space:pre;"><span class="cls_0">You’ll now need to change the </span><span class="cls_5">App</span><span class="cls_0">class to instantiate this page just like you do with a code-only</span></div><div style="position:absolute;left:87px;top:616px;white-space:pre;"><span class="cls_0">derivative of </span><span class="cls_5">ContentPage</span><span class="cls_0">:</span></div><div style="position:absolute;left:87px;top:642px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">CodePlusXaml</span></div><div style="position:absolute;left:87px;top:655px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:668px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">App </span><span class="cls_1">: </span><span class="cls_2">Application</span></div><div style="position:absolute;left:109px;top:682px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:695px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">App()</span></div><div style="position:absolute;left:132px;top:708px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:722px;white-space:pre;"><span class="cls_1">MainPage = </span><span class="cls_4">new </span><span class="cls_2">CodePlusXamlPage</span><span class="cls_1">();</span></div><div style="position:absolute;left:132px;top:735px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:132px;top:748px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:109px;top:762px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:775px;white-space:pre;"><span class="cls_1">}</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">143</span></div><div style="position:absolute;left:127px;top:72px;white-space:pre;"><span class="cls_0">You can now build and deploy this program. After you do so, it’s possible to clear up a couple of</span></div><div style="position:absolute;left:111px;top:90px;white-space:pre;"><span class="cls_0">mysteries encountered earlier in this section:</span></div><div style="position:absolute;left:127px;top:116px;white-space:pre;"><span class="cls_0">In Visual Studio, in the </span><span class="cls_13">Solution</span><span class="cls_0"> </span><span class="cls_13">Explorer</span><span class="cls_0">, select the </span><span class="cls_13">CodePlusXaml</span><span class="cls_0"> </span><span class="cls_0">project, find the icon at the top</span></div><div style="position:absolute;left:111px;top:134px;white-space:pre;"><span class="cls_0">with the tooltip </span><span class="cls_13">Show</span><span class="cls_0"> </span><span class="cls_13">All</span><span class="cls_0"> </span><span class="cls_13">Files</span><span class="cls_0">, and toggle that on.</span></div><div style="position:absolute;left:127px;top:160px;white-space:pre;"><span class="cls_0">In Xamarin Studio, in the </span><span class="cls_13">Solution</span><span class="cls_0"> </span><span class="cls_0">file list, invoke the drop-down menu for the whole solution, and</span></div><div style="position:absolute;left:111px;top:178px;white-space:pre;"><span class="cls_0">select </span><span class="cls_13">Display</span><span class="cls_0"> </span><span class="cls_13">Options</span><span class="cls_0"> </span><span class="cls_13">></span><span class="cls_0"> </span><span class="cls_13">Show</span><span class="cls_0"> </span><span class="cls_13">All</span><span class="cls_0"> </span><span class="cls_13">Files</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:204px;white-space:pre;"><span class="cls_0">In the </span><span class="cls_13">CodePlusXaml</span><span class="cls_0"> </span><span class="cls_0">Portable Class Library project, find the </span><span class="cls_13">obj</span><span class="cls_0"> </span><span class="cls_0">folder and within that, the </span><span class="cls_13">Debug</span></div><div style="position:absolute;left:111px;top:222px;white-space:pre;"><span class="cls_0">folder. You’ll see a file named CodePlusXamlPage.xaml.g.cs. Notice the </span><span class="cls_9">g</span><span class="cls_0"> </span><span class="cls_0">in the filename. That stands</span></div><div style="position:absolute;left:111px;top:239px;white-space:pre;"><span class="cls_0">for </span><span class="cls_9">generated</span><span class="cls_0">. Here it is, complete with the comment that tells you that this file is generated by a tool:</span></div><div style="position:absolute;left:111px;top:264px;white-space:pre;"><span class="cls_3">//------------------------------------------------------------------------------</span></div><div style="position:absolute;left:111px;top:278px;white-space:pre;"><span class="cls_3">// <auto-generated></span></div><div style="position:absolute;left:111px;top:291px;white-space:pre;"><span class="cls_3">//</span></div><div style="position:absolute;left:150px;top:291px;white-space:pre;"><span class="cls_3">This code was generated by a tool.</span></div><div style="position:absolute;left:111px;top:304px;white-space:pre;"><span class="cls_3">//</span></div><div style="position:absolute;left:150px;top:304px;white-space:pre;"><span class="cls_3">Runtime Version:4.0.30319.42000</span></div><div style="position:absolute;left:111px;top:318px;white-space:pre;"><span class="cls_3">//</span></div><div style="position:absolute;left:111px;top:331px;white-space:pre;"><span class="cls_3">//</span></div><div style="position:absolute;left:150px;top:331px;white-space:pre;"><span class="cls_3">Changes to this file may cause incorrect behavior and will be lost if</span></div><div style="position:absolute;left:111px;top:344px;white-space:pre;"><span class="cls_3">//</span></div><div style="position:absolute;left:150px;top:344px;white-space:pre;"><span class="cls_3">the code is regenerated.</span></div><div style="position:absolute;left:111px;top:358px;white-space:pre;"><span class="cls_3">// </auto-generated></span></div><div style="position:absolute;left:111px;top:371px;white-space:pre;"><span class="cls_3">//------------------------------------------------------------------------------</span></div><div style="position:absolute;left:111px;top:398px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">CodePlusXaml {</span></div><div style="position:absolute;left:133px;top:411px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">System;</span></div><div style="position:absolute;left:133px;top:424px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Xamarin.Forms;</span></div><div style="position:absolute;left:133px;top:438px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Xamarin.Forms.Xaml;</span></div><div style="position:absolute;left:133px;top:464px;white-space:pre;"><span class="cls_4">public partial class </span><span class="cls_2">CodePlusXamlPage </span><span class="cls_1">: </span><span class="cls_4">global</span><span class="cls_1">::Xamarin.Forms.ContentPage {</span></div><div style="position:absolute;left:156px;top:491px;white-space:pre;"><span class="cls_1">[System.CodeDom.Compiler.</span><span class="cls_2">GeneratedCodeAttribute</span><span class="cls_1">(</span><span class="cls_6">"Xamarin.Forms.Build.Tasks.XamlG"</span><span class="cls_1">,</span></div><div style="position:absolute;left:426px;top:504px;white-space:pre;"><span class="cls_6">"0.0.0.0"</span><span class="cls_1">)]</span></div><div style="position:absolute;left:156px;top:518px;white-space:pre;"><span class="cls_4">private void </span><span class="cls_1">InitializeComponent() {</span></div><div style="position:absolute;left:178px;top:531px;white-space:pre;"><span class="cls_4">this</span><span class="cls_1">.LoadFromXaml(</span><span class="cls_4">typeof</span><span class="cls_1">(</span><span class="cls_2">CodePlusXamlPage</span><span class="cls_1">));</span></div><div style="position:absolute;left:156px;top:544px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:133px;top:558px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:571px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:127px;top:596px;white-space:pre;"><span class="cls_0">During the build process, the XAML file is pars</span><span class="cls_0">ed, and this code file is generated. Notice that it’s a</span></div><div style="position:absolute;left:111px;top:614px;white-space:pre;"><span class="cls_0">partial class definition of </span><span class="cls_5">CodePlusXamlPage</span><span class="cls_0">, which derives from </span><span class="cls_5">ContentPage</span><span class="cls_0">, and the class con-</span></div><div style="position:absolute;left:111px;top:631px;white-space:pre;"><span class="cls_0">tains a method named </span><span class="cls_5">InitializeComponent</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:658px;white-space:pre;"><span class="cls_0">In other words, it’s a perfect fit for the CodePlusXamlPage.xam</span><span class="cls_0">l.cs code-behind file. After the</span></div><div style="position:absolute;left:111px;top:675px;white-space:pre;"><span class="cls_0">CodePlusXamlPage.xaml.g.cs file is generated, the two files can be compiled together as if they were</span></div><div style="position:absolute;left:111px;top:692px;white-space:pre;"><span class="cls_0">just normal C# partial class definitions.</span></div><div style="position:absolute;left:127px;top:719px;white-space:pre;"><span class="cls_0">At run time, the </span><span class="cls_5">App</span><span class="cls_0">class instantiates the </span><span class="cls_5">CodePlusXamlPage</span><span class="cls_0">class. The </span><span class="cls_5">CodePlusXamlPage</span><span class="cls_0">con-</span></div><div style="position:absolute;left:111px;top:736px;white-space:pre;"><span class="cls_0">structor (defined in the code-behind file) calls </span><span class="cls_5">InitializeComponent</span><span class="cls_0">(defined in the generated file),</span></div><div style="position:absolute;left:111px;top:754px;white-space:pre;"><span class="cls_0">and </span><span class="cls_5">InitializeComponent</span><span class="cls_0">calls </span><span class="cls_5">LoadFromXaml</span><span class="cls_0">. This is an extension method for </span><span class="cls_5">View</span><span class="cls_0">defined in the</span></div><div style="position:absolute;left:111px;top:771px;white-space:pre;"><span class="cls_5">Extensions</span><span class="cls_0">class in the </span><span class="cls_13">Xamarin.Forms.Xaml</span><span class="cls_0"> </span><span class="cls_0">assembly. What </span><span class="cls_5">LoadFromXaml</span><span class="cls_0">does depends on</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">144</span></div><div style="position:absolute;left:87px;top:72px;white-space:pre;"><span class="cls_0">whether you’ve chosen to compile the XAML or not (as discussed in the next section). But when the</span></div><div style="position:absolute;left:87px;top:90px;white-space:pre;"><span class="cls_5">InitializeComponent</span><span class="cls_0">method returns, the whole page is in place, just as though everything had</span></div><div style="position:absolute;left:87px;top:107px;white-space:pre;"><span class="cls_0">been instantiated and initialized in code in the </span><span class="cls_5">CodePlusXamlPage</span><span class="cls_0">constructor.</span></div><div style="position:absolute;left:103px;top:134px;white-space:pre;"><span class="cls_0">It’s possible to continue adding content to the page in the constructor of the code</span><span class="cls_0">-behind file, but</span></div><div style="position:absolute;left:87px;top:151px;white-space:pre;"><span class="cls_0">only after the </span><span class="cls_5">InitializeComponent</span><span class="cls_0">call returns. Let’s take this opportunity to create another </span><span class="cls_5">Label</span></div><div style="position:absolute;left:87px;top:168px;white-space:pre;"><span class="cls_0">by using some code from earlier in this chapter:</span></div><div style="position:absolute;left:87px;top:194px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">CodePlusXaml</span></div><div style="position:absolute;left:87px;top:207px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:220px;white-space:pre;"><span class="cls_4">public partial class </span><span class="cls_2">CodePlusXamlPage </span><span class="cls_1">: </span><span class="cls_2">ContentPage</span></div><div style="position:absolute;left:109px;top:234px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:247px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">CodePlusXamlPage()</span></div><div style="position:absolute;left:132px;top:260px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:274px;white-space:pre;"><span class="cls_1">InitializeComponent();</span></div><div style="position:absolute;left:154px;top:300px;white-space:pre;"><span class="cls_2">Label </span><span class="cls_1">label = </span><span class="cls_4">new </span><span class="cls_2">Label</span></div><div style="position:absolute;left:154px;top:314px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:177px;top:327px;white-space:pre;"><span class="cls_1">Text = </span><span class="cls_6">"Hello from Code!"</span><span class="cls_1">,</span></div><div style="position:absolute;left:177px;top:340px;white-space:pre;"><span class="cls_1">IsVisible = </span><span class="cls_4">true</span><span class="cls_1">,</span></div><div style="position:absolute;left:177px;top:354px;white-space:pre;"><span class="cls_1">Opacity = 0.75,</span></div><div style="position:absolute;left:177px;top:367px;white-space:pre;"><span class="cls_1">HorizontalTextAlignment = </span><span class="cls_2">TextAlignment</span><span class="cls_1">.Center,</span></div><div style="position:absolute;left:177px;top:380px;white-space:pre;"><span class="cls_1">VerticalOptions = </span><span class="cls_2">LayoutOptions</span><span class="cls_1">.CenterAndExpand,</span></div><div style="position:absolute;left:177px;top:394px;white-space:pre;"><span class="cls_1">TextColor = </span><span class="cls_2">Color</span><span class="cls_1">.Blue,</span></div><div style="position:absolute;left:177px;top:407px;white-space:pre;"><span class="cls_1">BackgroundColor = </span><span class="cls_2">Color</span><span class="cls_1">.FromRgb(255, 128, 128),</span></div><div style="position:absolute;left:177px;top:420px;white-space:pre;"><span class="cls_1">FontSize = </span><span class="cls_2">Device</span><span class="cls_1">.GetNamedSize(</span><span class="cls_2">NamedSize</span><span class="cls_1">.Large, </span><span class="cls_4">typeof</span><span class="cls_1">(</span><span class="cls_2">Label</span><span class="cls_1">)),</span></div><div style="position:absolute;left:177px;top:434px;white-space:pre;"><span class="cls_1">FontAttributes = </span><span class="cls_2">FontAttributes</span><span class="cls_1">.Bold | </span><span class="cls_2">FontAttributes</span><span class="cls_1">.Italic</span></div><div style="position:absolute;left:154px;top:447px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:154px;top:474px;white-space:pre;"><span class="cls_1">(Content </span><span class="cls_4">as </span><span class="cls_2">StackLayout</span><span class="cls_1">).Children.Insert(0, label);</span></div><div style="position:absolute;left:132px;top:487px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:500px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:514px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:103px;top:539px;white-space:pre;"><span class="cls_0">The constructor concludes by accessing the </span><span class="cls_5">StackLayout</span><span class="cls_0">that we know is set to the </span><span class="cls_5">Content</span></div><div style="position:absolute;left:87px;top:556px;white-space:pre;"><span class="cls_0">property of the page and inserting the </span><span class="cls_5">Label</span><span class="cls_0">at the top. (In the ne</span><span class="cls_0">xt chapter, you’ll see a much better</span></div><div style="position:absolute;left:87px;top:574px;white-space:pre;"><span class="cls_0">way to reference objects in the XAML file by using the </span><span class="cls_5">x:Name</span><span class="cls_0">attribute.) You can create the </span><span class="cls_5">Label</span></div><div style="position:absolute;left:87px;top:591px;white-space:pre;"><span class="cls_0">prior to the </span><span class="cls_5">InitializeComponent</span><span class="cls_0">call, but you can’t add it to the </span><span class="cls_5">StackLayout</span><span class="cls_0">at that time be-</span></div><div style="position:absolute;left:87px;top:608px;white-space:pre;"><span class="cls_0">cause </span><span class="cls_5">InitializeComponent</span><span class="cls_0">is what causes the </span><span class="cls_5">StackLayout</span><span class="cls_0">(and all the other XAML elements) to</span></div><div style="position:absolute;left:87px;top:626px;white-space:pre;"><span class="cls_0">be instantiated. Here’s the result:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:111px;top:71px;width:492px;height:295px;z-index:0;"><img src="images\image82.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image83.png" width="708" height="864" alt=""></div><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">145</span></div><div style="position:absolute;left:111px;top:374px;white-space:pre;"><span class="cls_0">Aside from the text, the two buttons are identical.</span></div><div style="position:absolute;left:127px;top:400px;white-space:pre;"><span class="cls_0">You don’t have to spend much time examining the generated code file that the XAML parser cre-</span></div><div style="position:absolute;left:111px;top:418px;white-space:pre;"><span class="cls_0">ates, </span><span class="cls_0">but it’s helpful to understand how the XAML file plays a role both in the build process and during</span></div><div style="position:absolute;left:111px;top:435px;white-space:pre;"><span class="cls_0">run time. Also, sometimes an error in the XAML file raises a run-time exception at the </span><span class="cls_5">LoadFromXaml</span></div><div style="position:absolute;left:111px;top:452px;white-space:pre;"><span class="cls_0">call, so you will probably see the generated code file pop up frequently, and you should know what</span></div><div style="position:absolute;left:111px;top:470px;white-space:pre;"><span class="cls_0">it is.</span></div><div style="position:absolute;left:79px;top:509px;white-space:pre;"><span class="cls_11">The</span><span class="cls_12"> </span><span class="cls_11">XAML</span><span class="cls_12"> </span><span class="cls_11">compiler</span></div><div style="position:absolute;left:111px;top:558px;white-space:pre;"><span class="cls_0">You have an option whether to compile the XAML during the build process. Compiling the XAML per-</span></div><div style="position:absolute;left:111px;top:575px;white-space:pre;"><span class="cls_0">forms validity checks during the build process, reduces the size of the executable, and improves load-</span></div><div style="position:absolute;left:111px;top:592px;white-space:pre;"><span class="cls_0">ing time, but it’s somewhat newer than the noncompilation approach, so there might be issues</span></div><div style="position:absolute;left:111px;top:610px;white-space:pre;"><span class="cls_0">sometimes.</span></div><div style="position:absolute;left:127px;top:636px;white-space:pre;"><span class="cls_0">To indicate that you want to compile all the XAML files in your application, you can insert the fol-</span></div><div style="position:absolute;left:111px;top:654px;white-space:pre;"><span class="cls_0">lowing assembly attribute somewhere in a code file. The most convenient place is the Assembly.cs file</span></div><div style="position:absolute;left:111px;top:671px;white-space:pre;"><span class="cls_0">in the </span><span class="cls_13">Properties</span><span class="cls_0"> </span><span class="cls_0">folder of the PCL project:</span></div><div style="position:absolute;left:111px;top:696px;white-space:pre;"><span class="cls_1">[</span><span class="cls_4">assembly</span><span class="cls_1">: </span><span class="cls_2">XamlCompilation</span><span class="cls_1">(</span><span class="cls_2">XamlCompilationOptions</span><span class="cls_1">.Compile)]</span></div><div style="position:absolute;left:111px;top:722px;white-space:pre;"><span class="cls_0">You can put it in another C# file, but because it’s an assembly attribute, it needs to be out</span><span class="cls_0">side any</span></div><div style="position:absolute;left:111px;top:739px;white-space:pre;"><span class="cls_5">namespace</span><span class="cls_0">block. You’ll also need a </span><span class="cls_5">using</span><span class="cls_0">directive for </span><span class="cls_5">Xamarin.Forms.Xaml</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:766px;white-space:pre;"><span class="cls_0">You can alternatively specify that the XAML file for a particular class is compiled:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image84.png" width="708" height="864" alt=""></div><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">146</span></div><div style="position:absolute;left:87px;top:71px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">CodePlusXaml</span></div><div style="position:absolute;left:87px;top:84px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:98px;white-space:pre;"><span class="cls_1">[</span><span class="cls_2">XamlCompilation</span><span class="cls_1">(</span><span class="cls_2">XamlCompilationOptions</span><span class="cls_1">.Compile)]</span></div><div style="position:absolute;left:109px;top:111px;white-space:pre;"><span class="cls_4">public partial class </span><span class="cls_2">CodePlusXamlPage </span><span class="cls_1">: </span><span class="cls_2">ContentPage</span></div><div style="position:absolute;left:109px;top:124px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:138px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">CodePlusXamlPage()</span></div><div style="position:absolute;left:132px;top:151px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:164px;white-space:pre;"><span class="cls_1">InitializeComponent();</span></div><div style="position:absolute;left:154px;top:191px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:132px;top:204px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:218px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:231px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:103px;top:256px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">XamlCompilationOptions</span><span class="cls_0">enumeration has two members, </span><span class="cls_5">Compile</span><span class="cls_0">and </span><span class="cls_5">Skip</span><span class="cls_0">, which means</span></div><div style="position:absolute;left:87px;top:274px;white-space:pre;"><span class="cls_0">that you can use </span><span class="cls_5">XamlCompilation</span><span class="cls_0">as an assembly attribute to enable XAML compilation for all clas-</span></div><div style="position:absolute;left:87px;top:291px;white-space:pre;"><span class="cls_0">ses in the project, but skip XAML compilation for individual classes by using the </span><span class="cls_5">Skip</span><span class="cls_0">member.</span></div><div style="position:absolute;left:103px;top:318px;white-space:pre;"><span class="cls_0">When you do </span><span class="cls_9">not</span><span class="cls_0"> </span><span class="cls_0">choose to compile the XAML, the entire XAML file is bound into the executable as</span></div><div style="position:absolute;left:87px;top:335px;white-space:pre;"><span class="cls_0">an embedded resource, just like the Edgar Allan Poe story in the </span><span class="cls_13">BlackCat</span><span class="cls_0"> </span><span class="cls_0">program in Chapter 4. In-</span></div><div style="position:absolute;left:87px;top:352px;white-space:pre;"><span class="cls_0">deed, you can get access to the XAML file at run time by using the </span><span class="cls_5">GetManifestResourceStream</span></div><div style="position:absolute;left:87px;top:370px;white-space:pre;"><span class="cls_0">method. That’s similar to what the </span><span class="cls_5">LoadFromXaml</span><span class="cls_0">call in </span><span class="cls_5">InitializeComponent</span><span class="cls_0">does. It loads the</span></div><div style="position:absolute;left:87px;top:387px;white-space:pre;"><span class="cls_0">XAML file and parses it for a second time, instantiating and initializing all the elements in the XAML file</span></div><div style="position:absolute;left:87px;top:404px;white-space:pre;"><span class="cls_0">except for the root element, which already exists.</span></div><div style="position:absolute;left:103px;top:431px;white-space:pre;"><span class="cls_0">When you choose to compile the XAML, this process is streamlined somewhat, but the </span><span class="cls_5">LoadFrom-</span></div><div style="position:absolute;left:87px;top:448px;white-space:pre;"><span class="cls_5">Xaml</span><span class="cls_0">method still needs to instantiate all the elements and build a visual tree.</span></div><div style="position:absolute;left:55px;top:488px;white-space:pre;"><span class="cls_11">Platform</span><span class="cls_12"> </span><span class="cls_11">specificity</span><span class="cls_12"> </span><span class="cls_11">in</span><span class="cls_12"> </span><span class="cls_11">the</span><span class="cls_12"> </span><span class="cls_11">XAML</span><span class="cls_12"> </span><span class="cls_11">file</span></div><div style="position:absolute;left:87px;top:536px;white-space:pre;"><span class="cls_0">Here is the XAML file for a program named </span><span class="cls_13">ScaryColorList</span><span class="cls_0"> </span><span class="cls_0">that’s similar to a sni</span><span class="cls_0">ppet of XAML that you</span></div><div style="position:absolute;left:87px;top:554px;white-space:pre;"><span class="cls_0">saw earlier. But now the repetition is even scarier because each color item is surrounded by a </span><span class="cls_5">Frame</span><span class="cls_0">:</span></div><div style="position:absolute;left:87px;top:579px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:592px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:606px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">ScaryColorList.ScaryColorListPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:619px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:632px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:646px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div><div style="position:absolute;left:177px;top:659px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame </span><span class="cls_14">OutlineColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Accent</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:199px;top:672px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:222px;top:686px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">Orientation</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Horizontal</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:244px;top:699px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div><div style="position:absolute;left:267px;top:712px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">Color</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Red</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:267px;top:726px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Red</span><span class="cls_1">"</span></div><div style="position:absolute;left:306px;top:739px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:244px;top:752px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div><div style="position:absolute;left:222px;top:766px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:199px;top:779px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame.Content</span><span class="cls_4">></span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">147</span></div><div style="position:absolute;left:201px;top:71px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:98px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame </span><span class="cls_14">OutlineColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Accent</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:223px;top:111px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:246px;top:124px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">Orientation</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Horizontal</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:268px;top:138px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div><div style="position:absolute;left:291px;top:151px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">Color</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Green</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:313px;top:164px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Green</span><span class="cls_1">"</span></div><div style="position:absolute;left:353px;top:178px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:268px;top:191px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div><div style="position:absolute;left:246px;top:204px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:223px;top:218px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:231px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:258px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame </span><span class="cls_14">OutlineColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Accent</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:223px;top:271px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:246px;top:284px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">Orientation</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Horizontal</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:268px;top:298px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div><div style="position:absolute;left:291px;top:311px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">Color</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Blue</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:291px;top:324px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Blue</span><span class="cls_1">"</span></div><div style="position:absolute;left:330px;top:338px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:268px;top:351px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div><div style="position:absolute;left:246px;top:364px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:223px;top:378px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:391px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:404px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout.Children</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:418px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:431px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:444px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:470px;white-space:pre;"><span class="cls_0">The code-behind file contains only the standard call to </span><span class="cls_5">InitializeComponent</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:496px;white-space:pre;"><span class="cls_0">Aside from the repetitious markup, this program has a more practical problem: When it runs on iOS,</span></div><div style="position:absolute;left:111px;top:514px;white-space:pre;"><span class="cls_0">the top item overlaps the status bar. This problem can be fixed with a call to </span><span class="cls_5">Device.OnPlatform</span><span class="cls_0">in</span></div><div style="position:absolute;left:111px;top:531px;white-space:pre;"><span class="cls_0">the page’s constructor (just as you saw in Chapter 2). Because </span><span class="cls_5">Device.OnPlatform</span><span class="cls_0">sets the </span><span class="cls_5">Padding</span></div><div style="position:absolute;left:111px;top:548px;white-space:pre;"><span class="cls_0">property on the page and doesn’t require anything in the XAML file, it could go either before or after</span></div><div style="position:absolute;left:111px;top:566px;white-space:pre;"><span class="cls_0">the </span><span class="cls_5">InitializeComponent</span><span class="cls_0">call. Here’s one way to do it:</span></div><div style="position:absolute;left:111px;top:591px;white-space:pre;"><span class="cls_4">public partial class </span><span class="cls_2">ScaryColorListPage </span><span class="cls_1">: </span><span class="cls_2">ContentPage</span></div><div style="position:absolute;left:111px;top:604px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:618px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">ScaryColorListPage()</span></div><div style="position:absolute;left:133px;top:631px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:644px;white-space:pre;"><span class="cls_1">Padding = </span><span class="cls_2">Device</span><span class="cls_1">.OnPlatform(</span><span class="cls_4">new </span><span class="cls_2">Thickness</span><span class="cls_1">(0, 20, 0, 0),</span></div><div style="position:absolute;left:313px;top:658px;white-space:pre;"><span class="cls_4">new </span><span class="cls_2">Thickness</span><span class="cls_1">(0),</span></div><div style="position:absolute;left:313px;top:671px;white-space:pre;"><span class="cls_4">new </span><span class="cls_2">Thickness</span><span class="cls_1">(0));</span></div><div style="position:absolute;left:156px;top:698px;white-space:pre;"><span class="cls_1">InitializeComponent();</span></div><div style="position:absolute;left:133px;top:711px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:724px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:127px;top:750px;white-space:pre;"><span class="cls_0">Or, you could set a uniform </span><span class="cls_5">Padding</span><span class="cls_0">value for all three platforms right in the root element of the</span></div><div style="position:absolute;left:111px;top:767px;white-space:pre;"><span class="cls_0">XAML file:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">148</span></div><div style="position:absolute;left:87px;top:71px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:84px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:98px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">ScaryColorList.ScaryColorListPage</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:111px;white-space:pre;"><span class="cls_14">Padding</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">0, 20, 0, 0</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:124px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:138px;white-space:pre;"><span class="cls_4">…</span></div><div style="position:absolute;left:109px;top:151px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:164px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:190px;white-space:pre;"><span class="cls_0">That sets the </span><span class="cls_5">Padding</span><span class="cls_0">property for the page. The </span><span class="cls_5">ThicknessTypeConverter</span><span class="cls_0">class requires the values</span></div><div style="position:absolute;left:87px;top:207px;white-space:pre;"><span class="cls_0">to be separated by commas, but you have the same flexibility as with the </span><span class="cls_5">Thickness</span><span class="cls_0">constructor. You</span></div><div style="position:absolute;left:87px;top:224px;white-space:pre;"><span class="cls_0">can specify four values in the order left, top, right, and bottom; two values (the first for left and right,</span></div><div style="position:absolute;left:87px;top:242px;white-space:pre;"><span class="cls_0">and the second for top and bottom); or one value.</span></div><div style="position:absolute;left:103px;top:268px;white-space:pre;"><span class="cls_0">However, you can also specify platform-specific values right in the XAML file by using the </span><span class="cls_5">OnPlat-</span></div><div style="position:absolute;left:87px;top:286px;white-space:pre;"><span class="cls_5">form</span><span class="cls_0">class, whose name suggests that it is similar in function to the </span><span class="cls_5">Device.OnPlatform</span><span class="cls_0">static</span></div><div style="position:absolute;left:87px;top:303px;white-space:pre;"><span class="cls_0">method.</span></div><div style="position:absolute;left:103px;top:330px;white-space:pre;"><span class="cls_5">OnPlatform</span><span class="cls_0">is a very interesting class, and it’s worthwhile to gain a sense of how it works. The class</span></div><div style="position:absolute;left:87px;top:347px;white-space:pre;"><span class="cls_0">is generic, and it has three properties of type </span><span class="cls_5">T</span><span class="cls_0">, as well as an implicit conversion of itself to </span><span class="cls_5">T</span><span class="cls_0">that</span></div><div style="position:absolute;left:87px;top:364px;white-space:pre;"><span class="cls_0">makes use of the </span><span class="cls_5">Device.OS</span><span class="cls_0">value:</span></div><div style="position:absolute;left:87px;top:390px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">OnPlatform</span><span class="cls_1"><T></span></div><div style="position:absolute;left:87px;top:403px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:416px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">T iOS { </span><span class="cls_4">get</span><span class="cls_1">; </span><span class="cls_4">set</span><span class="cls_1">; }</span></div><div style="position:absolute;left:109px;top:443px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">T Android { </span><span class="cls_4">get</span><span class="cls_1">; </span><span class="cls_4">set</span><span class="cls_1">; }</span></div><div style="position:absolute;left:109px;top:470px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">T WinPhone { </span><span class="cls_4">get</span><span class="cls_1">; </span><span class="cls_4">set</span><span class="cls_1">; }</span></div><div style="position:absolute;left:109px;top:496px;white-space:pre;"><span class="cls_4">public static implicit operator </span><span class="cls_1">T(</span><span class="cls_2">OnPlatform</span><span class="cls_1"><T> onPlatform)</span></div><div style="position:absolute;left:109px;top:510px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:523px;white-space:pre;"><span class="cls_3">// returns one of the three properties based on Device.OS</span></div><div style="position:absolute;left:109px;top:536px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:550px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:103px;top:575px;white-space:pre;"><span class="cls_0">In theory, you might use the </span><span class="cls_5">OnPlatform<T></span><span class="cls_0">class in code, perhaps like this in the constructor of a</span></div><div style="position:absolute;left:87px;top:592px;white-space:pre;"><span class="cls_5">ContentPage</span><span class="cls_0">derivative:</span></div><div style="position:absolute;left:87px;top:618px;white-space:pre;"><span class="cls_1">Padding = </span><span class="cls_4">new </span><span class="cls_2">OnPlatform</span><span class="cls_1"><</span><span class="cls_2">Thickness</span><span class="cls_1">></span></div><div style="position:absolute;left:87px;top:631px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:644px;white-space:pre;"><span class="cls_1">iOS = </span><span class="cls_4">new </span><span class="cls_2">Thickness</span><span class="cls_1">(0, 20, 0, 0),</span></div><div style="position:absolute;left:109px;top:658px;white-space:pre;"><span class="cls_1">Android = </span><span class="cls_4">new </span><span class="cls_2">Thickness</span><span class="cls_1">(0),</span></div><div style="position:absolute;left:109px;top:671px;white-space:pre;"><span class="cls_1">WinPhone = </span><span class="cls_4">new </span><span class="cls_2">Thickness</span><span class="cls_1">(0)</span></div><div style="position:absolute;left:87px;top:684px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:87px;top:710px;white-space:pre;"><span class="cls_0">You can set an instance of this </span><span class="cls_5">OnPlatform</span><span class="cls_0">class directly to the </span><span class="cls_5">Padding</span><span class="cls_0">property because the </span><span class="cls_5">On-</span></div><div style="position:absolute;left:87px;top:727px;white-space:pre;"><span class="cls_5">Platform</span><span class="cls_0">class defines an implicit conversion of itself to the generic argument (in this case</span></div><div style="position:absolute;left:87px;top:744px;white-space:pre;"><span class="cls_5">Thickness</span><span class="cls_0">).</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">149</span></div><div style="position:absolute;left:127px;top:72px;white-space:pre;"><span class="cls_0">However, you shouldn’t use </span><span class="cls_5">OnPlatform</span><span class="cls_0">in code. Use </span><span class="cls_5">Device.OnPlatform</span><span class="cls_0">instead. </span><span class="cls_5">OnPlatform</span></div><div style="position:absolute;left:111px;top:90px;white-space:pre;"><span class="cls_0">is designed for XAML, and the only really tricky part is figuring out how to specify the generic type</span></div><div style="position:absolute;left:111px;top:107px;white-space:pre;"><span class="cls_0">argument.</span></div><div style="position:absolute;left:127px;top:134px;white-space:pre;"><span class="cls_0">Fortunately, the XAML 2009 specification includes an attribute designed specifically for generic clas-</span></div><div style="position:absolute;left:111px;top:151px;white-space:pre;"><span class="cls_0">ses, called </span><span class="cls_5">TypeArguments</span><span class="cls_0">. Because it’s part of XAML itself, it’s used with an </span><span class="cls_5">x</span><span class="cls_0">prefix, so it appears as</span></div><div style="position:absolute;left:111px;top:168px;white-space:pre;"><span class="cls_5">x:TypeArguments</span><span class="cls_0">. Here’s how </span><span class="cls_5">OnPlatform</span><span class="cls_0">is used in XAML to select among three </span><span class="cls_5">Thickness</span></div><div style="position:absolute;left:111px;top:186px;white-space:pre;"><span class="cls_0">values:</span></div><div style="position:absolute;left:111px;top:211px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Thickness</span><span class="cls_1">"</span></div><div style="position:absolute;left:178px;top:224px;white-space:pre;"><span class="cls_14">iOS</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">0, 20, 0, 0</span><span class="cls_1">"</span></div><div style="position:absolute;left:178px;top:238px;white-space:pre;"><span class="cls_14">Android</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">0</span><span class="cls_1">"</span></div><div style="position:absolute;left:178px;top:251px;white-space:pre;"><span class="cls_14">WinPhone</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">0</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:111px;top:276px;white-space:pre;"><span class="cls_0">In this example (and in the previous code example), the </span><span class="cls_5">Android</span><span class="cls_0">and </span><span class="cls_5">WinPhone</span><span class="cls_0">settings aren’t re-</span></div><div style="position:absolute;left:111px;top:294px;white-space:pre;"><span class="cls_0">quired because they are the defaults. Notice that the </span><span class="cls_5">Thickness</span><span class="cls_0">strings can be set directly to the</span></div><div style="position:absolute;left:111px;top:311px;white-space:pre;"><span class="cls_0">properties because those properties are of type </span><span class="cls_5">Thickness</span><span class="cls_0">, and hence the XAML parser will use the</span></div><div style="position:absolute;left:111px;top:328px;white-space:pre;"><span class="cls_5">ThicknessTypeConverter</span><span class="cls_0">for converting those strings.</span></div><div style="position:absolute;left:127px;top:355px;white-space:pre;"><span class="cls_0">Now that we have the </span><span class="cls_5">OnPlatform</span><span class="cls_0">markup, how do we set it to the </span><span class="cls_5">Padding</span><span class="cls_0">property of the</span></div><div style="position:absolute;left:111px;top:372px;white-space:pre;"><span class="cls_5">Page</span><span class="cls_0">? By expressing </span><span class="cls_5">Padding</span><span class="cls_0">using property-element syntax, of course!</span></div><div style="position:absolute;left:111px;top:398px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:411px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:424px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">ScaryColorList.ScaryColorListPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:451px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage.Padding</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:464px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Thickness</span><span class="cls_1">"</span></div><div style="position:absolute;left:223px;top:478px;white-space:pre;"><span class="cls_14">iOS</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">0, 20, 0, 0</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:133px;top:491px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage.Padding</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:518px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:531px;white-space:pre;"><span class="cls_4">…</span></div><div style="position:absolute;left:133px;top:544px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage.Content</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:558px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:583px;white-space:pre;"><span class="cls_0">This is how the </span><span class="cls_13">ScaryColorList</span><span class="cls_0"> </span><span class="cls_0">program appears in the collection of samples from this book and here’s</span></div><div style="position:absolute;left:111px;top:600px;white-space:pre;"><span class="cls_0">how it looks:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:87px;top:71px;width:492px;height:295px;z-index:0;"><img src="images\image85.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image86.png" width="708" height="864" alt=""></div><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">150</span></div><div style="position:absolute;left:103px;top:374px;white-space:pre;"><span class="cls_0">Similar to </span><span class="cls_5">OnDevice</span><span class="cls_0">, </span><span class="cls_5">OnIdiom</span><span class="cls_0">distinguishes between </span><span class="cls_5">Phone</span><span class="cls_0">and </span><span class="cls_5">Tablet</span><span class="cls_0">. For reasons that will be-</span></div><div style="position:absolute;left:87px;top:391px;white-space:pre;"><span class="cls_0">come apparent in the next chapter, you should try to restrict the use of </span><span class="cls_5">OnDevice</span><span class="cls_0">and </span><span class="cls_5">OnIdiom</span><span class="cls_0">to</span></div><div style="position:absolute;left:87px;top:408px;white-space:pre;"><span class="cls_0">small chunks of markup rather than large blocks. Their use shouldn’t become a structural element in</span></div><div style="position:absolute;left:87px;top:426px;white-space:pre;"><span class="cls_0">your XAML files.</span></div><div style="position:absolute;left:55px;top:465px;white-space:pre;"><span class="cls_11">The</span><span class="cls_12"> </span><span class="cls_11">content</span><span class="cls_12"> </span><span class="cls_11">property</span><span class="cls_12"> </span><span class="cls_11">attribute</span></div><div style="position:absolute;left:87px;top:514px;white-space:pre;"><span class="cls_0">The XAML file in the </span><span class="cls_13">ScaryColorList</span><span class="cls_0"> </span><span class="cls_0">program is actually somewhat longer than it needs to be. You can</span></div><div style="position:absolute;left:87px;top:531px;white-space:pre;"><span class="cls_0">delete the </span><span class="cls_5">ContentPage.Content</span><span class="cls_0">tags, all the </span><span class="cls_5">StackLayout.Children</span><span class="cls_0">tags, and all the</span></div><div style="position:absolute;left:87px;top:548px;white-space:pre;"><span class="cls_5">Frame.Content</span><span class="cls_0">tags, and the program will work the same:</span></div><div style="position:absolute;left:87px;top:574px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:587px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:600px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">ScaryColorList.ScaryColorListPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:627px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage.Padding</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:640px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Thickness</span><span class="cls_1">"</span></div><div style="position:absolute;left:199px;top:654px;white-space:pre;"><span class="cls_14">iOS</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">0, 20, 0, 0</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:109px;top:667px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage.Padding</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:694px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:707px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame </span><span class="cls_14">OutlineColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Accent</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:720px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">Orientation</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Horizontal</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:177px;top:734px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">Color</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Red</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:177px;top:747px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Red</span><span class="cls_1">"</span></div><div style="position:absolute;left:216px;top:760px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:154px;top:774px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">151</span></div><div style="position:absolute;left:156px;top:71px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:98px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame </span><span class="cls_14">OutlineColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Accent</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:111px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">Orientation</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Horizontal</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:124px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">Color</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Green</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:201px;top:138px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Green</span><span class="cls_1">"</span></div><div style="position:absolute;left:240px;top:151px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:164px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:178px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:204px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame </span><span class="cls_14">OutlineColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Accent</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:218px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">Orientation</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Horizontal</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:231px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">Color</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Blue</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:201px;top:244px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Blue</span><span class="cls_1">"</span></div><div style="position:absolute;left:240px;top:258px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:271px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:284px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:298px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:311px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:336px;white-space:pre;"><span class="cls_0">It looks a lot cleaner now. The only property element left is for the </span><span class="cls_5">Padding</span><span class="cls_0">property of </span><span class="cls_5">ContentPage</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:363px;white-space:pre;"><span class="cls_0">As with almost everything about XAML syntax, this elimination of some property elements is sup-</span></div><div style="position:absolute;left:111px;top:380px;white-space:pre;"><span class="cls_0">ported by the underlying classes. Every class used in XAML is allowed to define one property as a </span><span class="cls_9">con-</span></div><div style="position:absolute;left:111px;top:398px;white-space:pre;"><span class="cls_9">tent</span><span class="cls_0"> </span><span class="cls_9">property</span><span class="cls_0"> </span><span class="cls_0">(sometimes also called the class’s </span><span class="cls_9">default</span><span class="cls_0"> </span><span class="cls_9">property</span><span class="cls_0">). For this content property, the prop-</span></div><div style="position:absolute;left:111px;top:415px;white-space:pre;"><span class="cls_0">erty-element tags are not required, and any XML content within the start and end tags is automatically</span></div><div style="position:absolute;left:111px;top:432px;white-space:pre;"><span class="cls_0">assigned to this property. Very conveniently, the content property of </span><span class="cls_5">ContentPage</span><span class="cls_0">is </span><span class="cls_5">Content</span><span class="cls_0">, the</span></div><div style="position:absolute;left:111px;top:450px;white-space:pre;"><span class="cls_0">content property of </span><span class="cls_5">StackLayout</span><span class="cls_0">is </span><span class="cls_5">Children</span><span class="cls_0">, and the content property of </span><span class="cls_5">Frame</span><span class="cls_0">is </span><span class="cls_5">Content</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:476px;white-space:pre;"><span class="cls_0">These content properties are documented, but you need to know where to look. A class specifies its</span></div><div style="position:absolute;left:111px;top:494px;white-space:pre;"><span class="cls_0">content property by using the </span><span class="cls_5">ContentPropertyAttribute</span><span class="cls_0">. If this attribute is attached to a class, it</span></div><div style="position:absolute;left:111px;top:511px;white-space:pre;"><span class="cls_0">appears in the online Xamarin.Forms API d</span><span class="cls_0">ocumentation along with the class declaration. Here’s how it</span></div><div style="position:absolute;left:111px;top:528px;white-space:pre;"><span class="cls_0">appears in the documentation for </span><span class="cls_5">ContentPage</span><span class="cls_0">:</span></div><div style="position:absolute;left:111px;top:554px;white-space:pre;"><span class="cls_1">[Xamarin.Forms.ContentProperty("Content")]</span></div><div style="position:absolute;left:111px;top:567px;white-space:pre;"><span class="cls_1">public class ContentPage : TemplatedPage</span></div><div style="position:absolute;left:111px;top:592px;white-space:pre;"><span class="cls_0">If you say it aloud, it sounds a bit redundant: The </span><span class="cls_5">Content</span><span class="cls_0">property is the content property of</span></div><div style="position:absolute;left:111px;top:610px;white-space:pre;"><span class="cls_5">ContentPage</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:636px;white-space:pre;"><span class="cls_0">The declaration for the </span><span class="cls_5">Frame</span><span class="cls_0">class is similar:</span></div><div style="position:absolute;left:111px;top:662px;white-space:pre;"><span class="cls_1">[Xamarin.Forms.ContentProperty("Content")]</span></div><div style="position:absolute;left:111px;top:675px;white-space:pre;"><span class="cls_1">public class Frame : ContentView</span></div><div style="position:absolute;left:127px;top:700px;white-space:pre;"><span class="cls_5">StackLayout</span><span class="cls_0">doesn’t have a </span><span class="cls_5">ContentProperty</span><span class="cls_0">attribute applied, but </span><span class="cls_5">StackLayout</span><span class="cls_0">derives from</span></div><div style="position:absolute;left:111px;top:718px;white-space:pre;"><span class="cls_5">Layout<View></span><span class="cls_0">, and </span><span class="cls_5">Layout<T></span><span class="cls_0">has a </span><span class="cls_5">ContentProperty</span><span class="cls_0">attribute:</span></div><div style="position:absolute;left:111px;top:743px;white-space:pre;"><span class="cls_1">[Xamarin.Forms.ContentProperty("Children")]</span></div><div style="position:absolute;left:111px;top:756px;white-space:pre;"><span class="cls_1">public abstract class Layout<T> : </span><a href="http://iosapi.xamarin.com/monodoc.ashx?link=T%3aXamarin.Forms.Layout"><span class="cls_1">Layout, </span>IViewContainer<T></a></div><div style="position:absolute;left:111px;top:770px;white-space:pre;"><span class="cls_1">where T : View</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image87.png" width="708" height="864" alt=""></div><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">152</span></div><div style="position:absolute;left:87px;top:72px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">ContentProperty</span><span class="cls_0">attribute is inherited by the classes that derive from </span><span class="cls_5">Layout<T></span><span class="cls_0">, so </span><span class="cls_5">Children</span></div><div style="position:absolute;left:87px;top:90px;white-space:pre;"><span class="cls_0">is the content property of </span><span class="cls_5">StackLayout</span><span class="cls_0">.</span></div><div style="position:absolute;left:103px;top:116px;white-space:pre;"><span class="cls_0">Certainly, there’s no problem if you include the property elements when they’re not required, but in</span></div><div style="position:absolute;left:87px;top:134px;white-space:pre;"><span class="cls_0">most cases they will no longer appear in the sample programs in this book.</span></div><div style="position:absolute;left:55px;top:173px;white-space:pre;"><span class="cls_11">Formatted</span><span class="cls_12"> </span><span class="cls_11">text</span></div><div style="position:absolute;left:87px;top:222px;white-space:pre;"><span class="cls_0">Text displayed by a XAML file might involve just a word or two, but sometimes an entire paragraph is</span></div><div style="position:absolute;left:87px;top:239px;white-space:pre;"><span class="cls_0">required, perhaps with some embedded character formatting. Specifying character formatting is not</span></div><div style="position:absolute;left:87px;top:256px;white-space:pre;"><span class="cls_0">always as obvious, or as easy, in XAML as might be suggested by our familiarity with HTML.</span></div><div style="position:absolute;left:103px;top:283px;white-space:pre;"><span class="cls_0">The </span><span class="cls_13">TextVariations</span><span class="cls_0"> </span><span class="cls_0">solution has a XAML file that contains seven </span><span class="cls_5">Label</span><span class="cls_0">views in a scrollable</span></div><div style="position:absolute;left:87px;top:300px;white-space:pre;"><span class="cls_5">StackLayout</span><span class="cls_0">:</span></div><div style="position:absolute;left:87px;top:326px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:339px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:352px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">TextVariations.TextVariationsPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:379px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage.Padding</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:392px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Thickness</span><span class="cls_1">"</span></div><div style="position:absolute;left:199px;top:406px;white-space:pre;"><span class="cls_14">iOS</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">0, 20, 0, 0</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:109px;top:419px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage.Padding</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:446px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ScrollView</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:459px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:472px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:132px;top:486px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:499px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ScrollView</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:512px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:538px;white-space:pre;"><span class="cls_0">Each of the seven </span><span class="cls_5">Label</span><span class="cls_0">views shows a somewhat different way of defining the displayed text. For ref-</span></div><div style="position:absolute;left:87px;top:555px;white-space:pre;"><span class="cls_0">eren</span><span class="cls_0">ce purposes, here’s the program running on all three platforms:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:111px;top:71px;width:492px;height:295px;z-index:0;"><img src="images\image88.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image89.png" width="708" height="864" alt=""></div><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">153</span></div><div style="position:absolute;left:127px;top:374px;white-space:pre;"><span class="cls_0">The simplest approach involves just setting a few words to the </span><span class="cls_5">Text</span><span class="cls_0">attribute of the </span><span class="cls_5">Label</span><span class="cls_0">element:</span></div><div style="position:absolute;left:178px;top:399px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span></div><div style="position:absolute;left:218px;top:412px;white-space:pre;"><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Single lines of text are easy.</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:127px;top:438px;white-space:pre;"><span class="cls_0">You can also set the </span><span class="cls_5">Text</span><span class="cls_0">property by breaking it out as a property element:</span></div><div style="position:absolute;left:178px;top:463px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:476px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.Text</span><span class="cls_4">></span></div><div style="position:absolute;left:223px;top:490px;white-space:pre;"><span class="cls_1">Text can also be content of the Text property.</span></div><div style="position:absolute;left:201px;top:503px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.Text</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:516px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:542px;white-space:pre;"><span class="cls_5">Text</span><span class="cls_0">is the content property of </span><span class="cls_5">Label</span><span class="cls_0">, so you don’t need the </span><span class="cls_5">Label.Text</span><span class="cls_0">tags:</span></div><div style="position:absolute;left:178px;top:567px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:580px;white-space:pre;"><span class="cls_1">Text is the content property of Label.</span></div><div style="position:absolute;left:178px;top:594px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:619px;white-space:pre;"><span class="cls_0">When you set text as the content of the </span><span class="cls_5">Label</span><span class="cls_0">(whether you use the </span><span class="cls_5">Label.Text</span><span class="cls_0">tags or not), the text</span></div><div style="position:absolute;left:111px;top:636px;white-space:pre;"><span class="cls_0">is trimmed: all white space, including carriage returns, is removed from the beginning and end of the</span></div><div style="position:absolute;left:111px;top:654px;white-space:pre;"><span class="cls_0">text. However, all embedded white space is retained, including end-of-line characters.</span></div><div style="position:absolute;left:127px;top:680px;white-space:pre;"><span class="cls_0">When you set the </span><span class="cls_5">Text</span><span class="cls_0">property as a property attribute, all white space within the quotation marks</span></div><div style="position:absolute;left:111px;top:698px;white-space:pre;"><span class="cls_0">is retained, but if the text occupies more than one line in the XAML file, each end-of-line character (or</span></div><div style="position:absolute;left:111px;top:715px;white-space:pre;"><span class="cls_0">character sequence) is converted to a single space.</span></div><div style="position:absolute;left:127px;top:742px;white-space:pre;"><span class="cls_0">As a result, displaying a whole paragraph of uniformly formatted text is somewhat problematic. The</span></div><div style="position:absolute;left:111px;top:759px;white-space:pre;"><span class="cls_0">most foolproof approach is setting </span><span class="cls_5">Text</span><span class="cls_0">as a property attribute. You can put the whole paragraph as a</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">154</span></div><div style="position:absolute;left:87px;top:72px;white-space:pre;"><span class="cls_0">single line in the XAML file, but if you prefer to use multiple lines, you should left justify the whole par-</span></div><div style="position:absolute;left:87px;top:90px;white-space:pre;"><span class="cls_0">agraph in the XAML file surrounded by quotation marks, like so:</span></div><div style="position:absolute;left:154px;top:115px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span></div><div style="position:absolute;left:194px;top:128px;white-space:pre;"><span class="cls_14">Text</span><span class="cls_4">=</span></div><div style="position:absolute;left:87px;top:142px;white-space:pre;"><span class="cls_1">"</span><span class="cls_4">Perhaps the best way to define a paragraph of</span></div><div style="position:absolute;left:87px;top:155px;white-space:pre;"><span class="cls_4">uniformly formatted text is by setting the Text</span></div><div style="position:absolute;left:87px;top:168px;white-space:pre;"><span class="cls_4">property as an attribute and left justifying</span></div><div style="position:absolute;left:87px;top:182px;white-space:pre;"><span class="cls_4">the block of text in the XAML file. End-of-line</span></div><div style="position:absolute;left:87px;top:195px;white-space:pre;"><span class="cls_4">characters are converted to a space character.</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:87px;top:220px;white-space:pre;"><span class="cls_0">The end-of-line characters are converted to space characters so the individual lines are properly con-</span></div><div style="position:absolute;left:87px;top:238px;white-space:pre;"><span class="cls_0">catenated. But watch out: Don’t leave any stray characters at the end or beginning of the individual</span></div><div style="position:absolute;left:87px;top:255px;white-space:pre;"><span class="cls_0">lines. Those will show up as extraneous characters within the paragraph.</span></div><div style="position:absolute;left:103px;top:282px;white-space:pre;"><span class="cls_0">When multiple lines of text are specified as content of the </span><span class="cls_5">Label</span><span class="cls_0">, only white space at the beginning</span></div><div style="position:absolute;left:87px;top:299px;white-space:pre;"><span class="cls_0">and end of the text is trimmed. All embedded white space is retained, including end-of-line characters:</span></div><div style="position:absolute;left:154px;top:324px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:338px;white-space:pre;"><span class="cls_1">Text as content has the curse</span></div><div style="position:absolute;left:87px;top:351px;white-space:pre;"><span class="cls_1">Of breaks at each line's close.</span></div><div style="position:absolute;left:87px;top:364px;white-space:pre;"><span class="cls_1">That's a format great for verse</span></div><div style="position:absolute;left:87px;top:378px;white-space:pre;"><span class="cls_1">But not the best for prose.</span></div><div style="position:absolute;left:154px;top:391px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:416px;white-space:pre;"><span class="cls_0">This text is rendered as four separate lines. If you’re displaying lists or poetry in your Xamarin.Forms</span></div><div style="position:absolute;left:87px;top:434px;white-space:pre;"><span class="cls_0">application, th</span><span class="cls_0">at’s exactly what you want. Otherwise, probably not.</span></div><div style="position:absolute;left:103px;top:460px;white-space:pre;"><span class="cls_0">If your line or paragraph of text requires some nonuniform paragraph formatting, you’ll want to use</span></div><div style="position:absolute;left:87px;top:478px;white-space:pre;"><span class="cls_0">the </span><span class="cls_5">FormattedText</span><span class="cls_0">property of </span><span class="cls_5">Label</span><span class="cls_0">. As you might recall, you set this to a </span><span class="cls_5">FormattedString</span><span class="cls_0">ob-</span></div><div style="position:absolute;left:87px;top:495px;white-space:pre;"><span class="cls_0">ject and then set multiple </span><span class="cls_5">Span</span><span class="cls_0">objects to the </span><span class="cls_5">Spans</span><span class="cls_0">collection of the </span><span class="cls_5">FormattedString</span><span class="cls_0">. In XAML,</span></div><div style="position:absolute;left:87px;top:512px;white-space:pre;"><span class="cls_0">you need property-element tags for </span><span class="cls_5">Label.FormattedString</span><span class="cls_0">, but </span><span class="cls_5">Spans</span><span class="cls_0">is the content property of</span></div><div style="position:absolute;left:87px;top:530px;white-space:pre;"><span class="cls_5">FormattedString</span><span class="cls_0">:</span></div><div style="position:absolute;left:154px;top:555px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:177px;top:568px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.FormattedText</span><span class="cls_4">></span></div><div style="position:absolute;left:199px;top:582px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">FormattedString</span><span class="cls_4">></span></div><div style="position:absolute;left:222px;top:595px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">A single line with </span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:222px;top:608px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">bold</span><span class="cls_1">" </span><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Bold</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:222px;top:622px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">" </span><span class="cls_4">and </span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:222px;top:635px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">italic</span><span class="cls_1">" </span><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Italic</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:222px;top:648px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">" </span><span class="cls_4">and </span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:222px;top:662px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">large</span><span class="cls_1">" </span><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:222px;top:675px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">" </span><span class="cls_4">text.</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:199px;top:688px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">FormattedString</span><span class="cls_4">></span></div><div style="position:absolute;left:177px;top:702px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.FormattedText</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:715px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:740px;white-space:pre;"><span class="cls_0">Notice that the </span><span class="cls_5">Text</span><span class="cls_0">properties of the nonformatted items have spaces at the end or beginning of the</span></div><div style="position:absolute;left:87px;top:758px;white-space:pre;"><span class="cls_0">text string, or both, so that the items don’t run into each other.</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 7</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">XAML vs. code</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">155</span></div><div style="position:absolute;left:127px;top:72px;white-space:pre;"><span class="cls_0">In the general case, however, you might be working with an entire paragraph. You can set the </span><span class="cls_5">Text</span></div><div style="position:absolute;left:111px;top:90px;white-space:pre;"><span class="cls_0">attribute of </span><span class="cls_5">Span</span><span class="cls_0">to a long line, or you can wrap it on multiple lines. As with </span><span class="cls_5">Label</span><span class="cls_0">, keep the entire</span></div><div style="position:absolute;left:111px;top:107px;white-space:pre;"><span class="cls_0">block left justified in the XAML file:</span></div><div style="position:absolute;left:178px;top:132px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:146px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.FormattedText</span><span class="cls_4">></span></div><div style="position:absolute;left:223px;top:159px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">FormattedString</span><span class="cls_4">></span></div><div style="position:absolute;left:246px;top:172px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span></div><div style="position:absolute;left:111px;top:186px;white-space:pre;"><span class="cls_1">"</span><span class="cls_4">A paragraph of formatted text requires left justifying</span></div><div style="position:absolute;left:111px;top:199px;white-space:pre;"><span class="cls_4">it within the XAML file. But the text can include multiple</span></div><div style="position:absolute;left:111px;top:212px;white-space:pre;"><span class="cls_4">kinds of character formatting, including </span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:246px;top:226px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">bold</span><span class="cls_1">" </span><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Bold</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:246px;top:239px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">" </span><span class="cls_4">and </span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:246px;top:252px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">italic</span><span class="cls_1">" </span><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Italic</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:246px;top:266px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">" </span><span class="cls_4">and </span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:246px;top:279px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">large</span><span class="cls_1">" </span><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:246px;top:292px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span></div><div style="position:absolute;left:111px;top:306px;white-space:pre;"><span class="cls_1">" </span><span class="cls_4">and whatever combinations you might desire to adorn</span></div><div style="position:absolute;left:111px;top:319px;white-space:pre;"><span class="cls_4">your glorious prose.</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:223px;top:332px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">FormattedString</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:346px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.FormattedText</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:359px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:384px;white-space:pre;"><span class="cls_0">You’ll notice in the screenshot that the text with the large font size is aligned with the regular text on</span></div><div style="position:absolute;left:111px;top:402px;white-space:pre;"><span class="cls_0">the baseline, which is the typographically proper approach, and the line spacing is adjusted to accom-</span></div><div style="position:absolute;left:111px;top:419px;white-space:pre;"><span class="cls_0">modate the larger text.</span></div><div style="position:absolute;left:127px;top:446px;white-space:pre;"><span class="cls_0">In most Xamarin.Forms programs, neither XAML nor code exist in isolation but work together. Ele-</span></div><div style="position:absolute;left:111px;top:463px;white-space:pre;"><span class="cls_0">ments in XAML can trigger events handled in code, and code can modify elements in XAML. In the</span></div><div style="position:absolute;left:111px;top:480px;white-space:pre;"><span class="cls_0">next chapter you’ll see how this works.</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image90.png" width="708" height="864" alt=""></div><div style="position:absolute;left:55px;top:74px;white-space:pre;"><span class="cls_7">Chapter 8</span></div><div style="position:absolute;left:55px;top:94px;white-space:pre;"><span class="cls_8">Code</span><span class="cls_15"> </span><span class="cls_8">and</span></div><div style="position:absolute;left:214px;top:94px;white-space:pre;"><span class="cls_8">XAML</span></div><div style="position:absolute;left:318px;top:94px;white-space:pre;"><span class="cls_8">in</span></div><div style="position:absolute;left:357px;top:94px;white-space:pre;"><span class="cls_8">harmony</span></div><div style="position:absolute;left:87px;top:168px;white-space:pre;"><span class="cls_0">A code file and a XAML file always exist as a pair. The two files complement each other. Despite being</span></div><div style="position:absolute;left:87px;top:186px;white-space:pre;"><span class="cls_0">referred to as the “code</span><span class="cls_0">-</span><span class="cls_0">behind” file to the XAML, very often the code is prominent in taking on the</span></div><div style="position:absolute;left:87px;top:203px;white-space:pre;"><span class="cls_0">more active and interactive parts of the application. This implies that the code-behind file must be able</span></div><div style="position:absolute;left:87px;top:220px;white-space:pre;"><span class="cls_0">to refer to elements defined in XAML with as much ease as objects instantiated in code. Likewise, ele-</span></div><div style="position:absolute;left:87px;top:238px;white-space:pre;"><span class="cls_0">ments in XAML must be able to fire events that are handled in code-based event </span><span class="cls_0">handlers. That’s what</span></div><div style="position:absolute;left:87px;top:255px;white-space:pre;"><span class="cls_0">this chapter is all about.</span></div><div style="position:absolute;left:103px;top:282px;white-space:pre;"><span class="cls_0">But first, let’s explore a couple of unusual techniques for instantiating objects in a XAML file.</span></div><div style="position:absolute;left:55px;top:321px;white-space:pre;"><span class="cls_11">Passing</span><span class="cls_12"> </span><span class="cls_11">arguments</span></div><div style="position:absolute;left:87px;top:370px;white-space:pre;"><span class="cls_0">When you run an application containing a XAML file, each element in the XAML file is instantiated with</span></div><div style="position:absolute;left:87px;top:387px;white-space:pre;"><span class="cls_0">a call to the parameterless constructor of the corresponding class or structure. The load process contin-</span></div><div style="position:absolute;left:87px;top:404px;white-space:pre;"><span class="cls_0">ues with initialization of the resultant object by setting properties from attribute values. This seems rea-</span></div><div style="position:absolute;left:87px;top:422px;white-space:pre;"><span class="cls_0">sonable. However, developers using XAML sometimes have a need to instantiate objects with construc-</span></div><div style="position:absolute;left:87px;top:439px;white-space:pre;"><span class="cls_0">tors that require arguments or by calling a static creation method. These needs usually don’t involve</span></div><div style="position:absolute;left:87px;top:456px;white-space:pre;"><span class="cls_0">the API itself, but instead involve external data classes referenced by the XAML file that interact with</span></div><div style="position:absolute;left:87px;top:474px;white-space:pre;"><span class="cls_0">the API.</span></div><div style="position:absolute;left:103px;top:500px;white-space:pre;"><span class="cls_0">The 2009 XAML specification introduced an </span><span class="cls_5">x:Arguments</span><span class="cls_0">element and an </span><span class="cls_5">x:FactoryMethod</span><span class="cls_0">at-</span></div><div style="position:absolute;left:87px;top:518px;white-space:pre;"><span class="cls_0">tribute for these cases, and Xamarin.Forms supports them. These techniques are not often used in ordi-</span></div><div style="position:absolute;left:87px;top:535px;white-space:pre;"><span class="cls_0">nary circumstances, but you should see how they work in case the need arises.</span></div><div style="position:absolute;left:87px;top:568px;white-space:pre;"><span class="cls_16">Constructors</span><span class="cls_17"> </span><span class="cls_16">witharguments</span></div><div style="position:absolute;left:87px;top:599px;white-space:pre;"><span class="cls_0">To pass arguments to a constructor of an element in XAML, the element must be separated into start</span></div><div style="position:absolute;left:87px;top:616px;white-space:pre;"><span class="cls_0">and end tags. Follow the start tag of the element with </span><span class="cls_5">x:Arguments</span><span class="cls_0">start and end tags. Within those</span></div><div style="position:absolute;left:87px;top:634px;white-space:pre;"><span class="cls_5">x:Arguments</span><span class="cls_0">tags, include one or more constructor arguments.</span></div><div style="position:absolute;left:103px;top:660px;white-space:pre;"><span class="cls_0">But how do you specify multiple arguments of common types, such as </span><span class="cls_5">double</span><span class="cls_0">or </span><span class="cls_5">int</span><span class="cls_0">? Do you sep-</span></div><div style="position:absolute;left:87px;top:678px;white-space:pre;"><span class="cls_0">arate the arguments with commas?</span></div><div style="position:absolute;left:103px;top:704px;white-space:pre;"><span class="cls_0">No. Each argument must be delimited with start and end tags. Fortunately, the XAML 2009 specifi-</span></div><div style="position:absolute;left:87px;top:722px;white-space:pre;"><span class="cls_0">cation defines XML elements for common basic types. You can use these tags to clarify the types of el-</span></div><div style="position:absolute;left:87px;top:739px;white-space:pre;"><span class="cls_0">ements, to specify generic types in </span><span class="cls_5">OnPlatform</span><span class="cls_0">, or to delimit constructor arguments. Here’s the com-</span></div><div style="position:absolute;left:87px;top:756px;white-space:pre;"><span class="cls_0">plete set supported by Xamarin.Forms. Notice that they duplicate the .NET type names rather than the</span></div><div style="position:absolute;left:87px;top:774px;white-space:pre;"><span class="cls_0">C# type names:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">157</span></div><div style="position:absolute;left:125px;top:71px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:149px;top:73px;white-space:pre;"><span class="cls_5">x:Object</span></div><div style="position:absolute;left:125px;top:97px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:149px;top:99px;white-space:pre;"><span class="cls_5">x:Boolean</span></div><div style="position:absolute;left:125px;top:124px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:149px;top:126px;white-space:pre;"><span class="cls_5">x:Byte</span></div><div style="position:absolute;left:125px;top:151px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:149px;top:153px;white-space:pre;"><span class="cls_5">x:Int16</span></div><div style="position:absolute;left:125px;top:177px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:149px;top:179px;white-space:pre;"><span class="cls_5">x:Int32</span></div><div style="position:absolute;left:125px;top:204px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:149px;top:206px;white-space:pre;"><span class="cls_5">x:Int64</span></div><div style="position:absolute;left:125px;top:231px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:149px;top:233px;white-space:pre;"><span class="cls_5">x:Single</span></div><div style="position:absolute;left:125px;top:257px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:149px;top:259px;white-space:pre;"><span class="cls_5">x:Double</span></div><div style="position:absolute;left:125px;top:284px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:149px;top:286px;white-space:pre;"><span class="cls_5">x:Decimal</span></div><div style="position:absolute;left:125px;top:311px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:149px;top:313px;white-space:pre;"><span class="cls_5">x:Char</span></div><div style="position:absolute;left:125px;top:337px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:149px;top:339px;white-space:pre;"><span class="cls_5">x:String</span></div><div style="position:absolute;left:125px;top:364px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:149px;top:366px;white-space:pre;"><span class="cls_5">x:TimeSpan</span></div><div style="position:absolute;left:125px;top:391px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:149px;top:393px;white-space:pre;"><span class="cls_5">x:Array</span></div><div style="position:absolute;left:125px;top:419px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:149px;top:419px;white-space:pre;"><span class="cls_5">x:DateTime</span><span class="cls_0">(supported by Xamarin.Forms but not the XAML 2009 specification)</span></div><div style="position:absolute;left:111px;top:446px;white-space:pre;"><span class="cls_0">You’ll be </span><span class="cls_0">hard-pressed </span><span class="cls_0">to find a use for all of these, but you’ll certainly discover uses for some of them.</span></div><div style="position:absolute;left:127px;top:472px;white-space:pre;"><span class="cls_0">The </span><span class="cls_13">ParameteredConstructorDemo</span><span class="cls_0"> </span><span class="cls_0">sample demonstrates the use of </span><span class="cls_5">x:Arguments</span><span class="cls_0">with argu-</span></div><div style="position:absolute;left:111px;top:490px;white-space:pre;"><span class="cls_0">ments delimited by </span><span class="cls_5">x:Double</span><span class="cls_0">tags using three different constructors of the </span><span class="cls_5">Color</span><span class="cls_0">structure. The con-</span></div><div style="position:absolute;left:111px;top:507px;white-space:pre;"><span class="cls_0">structor with three parameters requires red, green, and blue values ranging from 0 to 1. The construc-</span></div><div style="position:absolute;left:111px;top:524px;white-space:pre;"><span class="cls_0">tor with four parameters adds an alpha channel as the fourth parameter (which is set here to 0.5), and</span></div><div style="position:absolute;left:111px;top:542px;white-space:pre;"><span class="cls_0">the constructor with a single parameter indicates a gray shade from 0 (black) to 1 (white):</span></div><div style="position:absolute;left:111px;top:567px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:580px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:594px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">ParameteredConstructorDemo.ParameteredConstructorDemoPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:620px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:634px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">WidthRequest</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">100</span><span class="cls_1">"</span></div><div style="position:absolute;left:206px;top:647px;white-space:pre;"><span class="cls_14">HeightRequest</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">100</span><span class="cls_1">"</span></div><div style="position:absolute;left:206px;top:660px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:206px;top:674px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:687px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView.Color</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:700px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Color</span><span class="cls_4">></span></div><div style="position:absolute;left:223px;top:714px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Arguments</span><span class="cls_4">></span></div><div style="position:absolute;left:246px;top:727px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Double</span><span class="cls_4">></span><span class="cls_1">1</span><span class="cls_4"></</span><span class="cls_6">x:Double</span><span class="cls_4">></span></div><div style="position:absolute;left:246px;top:740px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Double</span><span class="cls_4">></span><span class="cls_1">0</span><span class="cls_4"></</span><span class="cls_6">x:Double</span><span class="cls_4">></span></div><div style="position:absolute;left:246px;top:754px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Double</span><span class="cls_4">></span><span class="cls_1">0</span><span class="cls_4"></</span><span class="cls_6">x:Double</span><span class="cls_4">></span></div><div style="position:absolute;left:223px;top:767px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">x:Arguments</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:780px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Color</span><span class="cls_4">></span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">158</span></div><div style="position:absolute;left:154px;top:71px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView.Color</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:84px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:111px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">WidthRequest</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">100</span><span class="cls_1">"</span></div><div style="position:absolute;left:182px;top:124px;white-space:pre;"><span class="cls_14">HeightRequest</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">100</span><span class="cls_1">"</span></div><div style="position:absolute;left:182px;top:138px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:182px;top:151px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:164px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView.Color</span><span class="cls_4">></span></div><div style="position:absolute;left:177px;top:178px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Color</span><span class="cls_4">></span></div><div style="position:absolute;left:199px;top:191px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Arguments</span><span class="cls_4">></span></div><div style="position:absolute;left:222px;top:204px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Double</span><span class="cls_4">></span><span class="cls_1">0</span><span class="cls_4"></</span><span class="cls_6">x:Double</span><span class="cls_4">></span></div><div style="position:absolute;left:222px;top:218px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Double</span><span class="cls_4">></span><span class="cls_1">0</span><span class="cls_4"></</span><span class="cls_6">x:Double</span><span class="cls_4">></span></div><div style="position:absolute;left:222px;top:231px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Double</span><span class="cls_4">></span><span class="cls_1">1</span><span class="cls_4"></</span><span class="cls_6">x:Double</span><span class="cls_4">></span></div><div style="position:absolute;left:222px;top:244px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Double</span><span class="cls_4">></span><span class="cls_1">0.5</span><span class="cls_4"></</span><span class="cls_6">x:Double</span><span class="cls_4">></span></div><div style="position:absolute;left:199px;top:258px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">x:Arguments</span><span class="cls_4">></span></div><div style="position:absolute;left:177px;top:271px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Color</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:284px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView.Color</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:298px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:324px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">WidthRequest</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">100</span><span class="cls_1">"</span></div><div style="position:absolute;left:182px;top:338px;white-space:pre;"><span class="cls_14">HeightRequest</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">100</span><span class="cls_1">"</span></div><div style="position:absolute;left:182px;top:351px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:182px;top:364px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:378px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView.Color</span><span class="cls_4">></span></div><div style="position:absolute;left:177px;top:391px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Color</span><span class="cls_4">></span></div><div style="position:absolute;left:199px;top:404px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Arguments</span><span class="cls_4">></span></div><div style="position:absolute;left:222px;top:418px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Double</span><span class="cls_4">></span><span class="cls_1">0.5</span><span class="cls_4"></</span><span class="cls_6">x:Double</span><span class="cls_4">></span></div><div style="position:absolute;left:199px;top:431px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">x:Arguments</span><span class="cls_4">></span></div><div style="position:absolute;left:177px;top:444px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Color</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:458px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView.Color</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:471px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:484px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:498px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:523px;white-space:pre;"><span class="cls_0">The number of elements within the </span><span class="cls_5">x:Arguments</span><span class="cls_0">tags, and the types of these elements, must match</span></div><div style="position:absolute;left:87px;top:540px;white-space:pre;"><span class="cls_0">one of the constructors of the class or structure. Here’s the result:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:111px;top:71px;width:492px;height:295px;z-index:0;"><img src="images\image91.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image92.png" width="708" height="864" alt=""></div><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">159</span></div><div style="position:absolute;left:111px;top:374px;white-space:pre;"><span class="cls_0">The blue </span><span class="cls_5">BoxView</span><span class="cls_0">is light against the light background and dark against the dark background because</span></div><div style="position:absolute;left:111px;top:391px;white-space:pre;"><span class="cls_0">it’s 50 percent transparent and lets the background show through.</span></div><div style="position:absolute;left:111px;top:424px;white-space:pre;"><span class="cls_16">Can</span><span class="cls_17"> </span><span class="cls_16">I</span><span class="cls_17"> </span><span class="cls_16">call</span><span class="cls_17"> </span><span class="cls_16">methodsfrom</span><span class="cls_17"> </span><span class="cls_16">XAML?</span></div><div style="position:absolute;left:111px;top:455px;white-space:pre;"><span class="cls_0">At one time, the answer to this question was “Don’t be ridiculous,” but now it’s a qualified “Yes.” Don’t</span></div><div style="position:absolute;left:111px;top:472px;white-space:pre;"><span class="cls_0">get too excited, though. The only methods you can call in XAML are those that return objects (or val-</span></div><div style="position:absolute;left:111px;top:489px;white-space:pre;"><span class="cls_0">ues) of the same type as the class (or structure) that defines the method. These methods must be pub-</span></div><div style="position:absolute;left:111px;top:507px;white-space:pre;"><span class="cls_0">lic and static. They are sometimes called </span><span class="cls_9">creation</span><span class="cls_0"> </span><span class="cls_9">methods</span><span class="cls_0"> </span><span class="cls_0">or </span><span class="cls_9">factory</span><span class="cls_0"> </span><span class="cls_9">methods</span><span class="cls_0">. You can instantiate an</span></div><div style="position:absolute;left:111px;top:524px;white-space:pre;"><span class="cls_0">element in XAML through a call to one of these methods by specifying the method’s name using the</span></div><div style="position:absolute;left:111px;top:541px;white-space:pre;"><span class="cls_5">x:FactoryMethod</span><span class="cls_0">attribute and its arguments using the </span><span class="cls_5">x:Arguments</span><span class="cls_0">element.</span></div><div style="position:absolute;left:127px;top:568px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">Color</span><span class="cls_0">structure defines seven static methods that return </span><span class="cls_5">Color</span><span class="cls_0">values, so these qualify. This</span></div><div style="position:absolute;left:111px;top:585px;white-space:pre;"><span class="cls_0">XAML file makes use of three of them:</span></div><div style="position:absolute;left:111px;top:611px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:624px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:638px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">FactoryMethodDemo.FactoryMethodDemoPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:664px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:678px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">WidthRequest</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">100</span><span class="cls_1">"</span></div><div style="position:absolute;left:206px;top:691px;white-space:pre;"><span class="cls_14">HeightRequest</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">100</span><span class="cls_1">"</span></div><div style="position:absolute;left:206px;top:704px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:206px;top:718px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:731px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView.Color</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:744px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Color </span><span class="cls_14">x:FactoryMethod</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">FromRgb</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:223px;top:758px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Arguments</span><span class="cls_4">></span></div><div style="position:absolute;left:246px;top:771px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Int32</span><span class="cls_4">></span><span class="cls_1">255</span><span class="cls_4"></</span><span class="cls_6">x:Int32</span><span class="cls_4">></span></div><div style="position:absolute;left:246px;top:784px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Int32</span><span class="cls_4">></span><span class="cls_1">0</span><span class="cls_4"></</span><span class="cls_6">x:Int32</span><span class="cls_4">></span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">160</span></div><div style="position:absolute;left:222px;top:71px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Int32</span><span class="cls_4">></span><span class="cls_1">0</span><span class="cls_4"></</span><span class="cls_6">x:Int32</span><span class="cls_4">></span></div><div style="position:absolute;left:199px;top:84px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">x:Arguments</span><span class="cls_4">></span></div><div style="position:absolute;left:177px;top:98px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Color</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:111px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView.Color</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:124px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:151px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">WidthRequest</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">100</span><span class="cls_1">"</span></div><div style="position:absolute;left:182px;top:164px;white-space:pre;"><span class="cls_14">HeightRequest</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">100</span><span class="cls_1">"</span></div><div style="position:absolute;left:182px;top:178px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:182px;top:191px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:204px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView.Color</span><span class="cls_4">></span></div><div style="position:absolute;left:177px;top:218px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Color </span><span class="cls_14">x:FactoryMethod</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">FromRgb</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:199px;top:231px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Arguments</span><span class="cls_4">></span></div><div style="position:absolute;left:222px;top:244px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Double</span><span class="cls_4">></span><span class="cls_1">0</span><span class="cls_4"></</span><span class="cls_6">x:Double</span><span class="cls_4">></span></div><div style="position:absolute;left:222px;top:258px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Double</span><span class="cls_4">></span><span class="cls_1">1.0</span><span class="cls_4"></</span><span class="cls_6">x:Double</span><span class="cls_4">></span></div><div style="position:absolute;left:222px;top:271px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Double</span><span class="cls_4">></span><span class="cls_1">0</span><span class="cls_4"></</span><span class="cls_6">x:Double</span><span class="cls_4">></span></div><div style="position:absolute;left:199px;top:284px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">x:Arguments</span><span class="cls_4">></span></div><div style="position:absolute;left:177px;top:298px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Color</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:311px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView.Color</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:324px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:351px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">WidthRequest</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">100</span><span class="cls_1">"</span></div><div style="position:absolute;left:182px;top:364px;white-space:pre;"><span class="cls_14">HeightRequest</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">100</span><span class="cls_1">"</span></div><div style="position:absolute;left:182px;top:378px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:182px;top:391px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:404px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView.Color</span><span class="cls_4">></span></div><div style="position:absolute;left:177px;top:418px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Color </span><span class="cls_14">x:FactoryMethod</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">FromHsla</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:199px;top:431px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Arguments</span><span class="cls_4">></span></div><div style="position:absolute;left:222px;top:444px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Double</span><span class="cls_4">></span><span class="cls_1">0.67</span><span class="cls_4"></</span><span class="cls_6">x:Double</span><span class="cls_4">></span></div><div style="position:absolute;left:222px;top:458px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Double</span><span class="cls_4">></span><span class="cls_1">1.0</span><span class="cls_4"></</span><span class="cls_6">x:Double</span><span class="cls_4">></span></div><div style="position:absolute;left:222px;top:471px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Double</span><span class="cls_4">></span><span class="cls_1">0.5</span><span class="cls_4"></</span><span class="cls_6">x:Double</span><span class="cls_4">></span></div><div style="position:absolute;left:222px;top:484px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Double</span><span class="cls_4">></span><span class="cls_1">1.0</span><span class="cls_4"></</span><span class="cls_6">x:Double</span><span class="cls_4">></span></div><div style="position:absolute;left:199px;top:498px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">x:Arguments</span><span class="cls_4">></span></div><div style="position:absolute;left:177px;top:511px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Color</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:524px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView.Color</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:538px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:551px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:564px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:103px;top:590px;white-space:pre;"><span class="cls_0">The first two static methods invoked here are both named </span><span class="cls_5">Color.FromRgb</span><span class="cls_0">, but the types of ele-</span></div><div style="position:absolute;left:87px;top:607px;white-space:pre;"><span class="cls_0">ments within the </span><span class="cls_5">x:Arguments</span><span class="cls_0">tags distinguish between </span><span class="cls_5">int</span><span class="cls_0">arguments that range from 0 to 255 and</span></div><div style="position:absolute;left:87px;top:624px;white-space:pre;"><span class="cls_5">double</span><span class="cls_0">arguments that range from 0 to 1. The third one is the </span><span class="cls_5">Color.FromHsla</span><span class="cls_0">method, which cre-</span></div><div style="position:absolute;left:87px;top:642px;white-space:pre;"><span class="cls_0">ates a </span><span class="cls_5">Color</span><span class="cls_0">value from hue, saturation, luminosity, and alpha components. Interestingly, this is the</span></div><div style="position:absolute;left:87px;top:659px;white-space:pre;"><span class="cls_0">only way to define a </span><span class="cls_5">Color</span><span class="cls_0">value from HSL values in a XAML file by using the Xamarin.Forms API.</span></div><div style="position:absolute;left:87px;top:676px;white-space:pre;"><span class="cls_0">Here’s the result:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:111px;top:71px;width:492px;height:295px;z-index:0;"><img src="images\image93.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image94.png" width="708" height="864" alt=""></div><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">161</span></div><div style="position:absolute;left:79px;top:391px;white-space:pre;"><span class="cls_11">The</span><span class="cls_12"> </span><span class="cls_11">x:Name</span><span class="cls_12"> </span><span class="cls_11">attribute</span></div><div style="position:absolute;left:111px;top:439px;white-space:pre;"><span class="cls_0">In most real applications, the code-behind file needs to reference elements defined in the XAML file.</span></div><div style="position:absolute;left:111px;top:456px;white-space:pre;"><span class="cls_0">You saw one way to do this in the </span><span class="cls_13">CodePlusXaml</span><span class="cls_0"> </span><span class="cls_0">program in the previous chapter: If the code-behind</span></div><div style="position:absolute;left:111px;top:474px;white-space:pre;"><span class="cls_0">file has knowledge of the layout of the visual tree defined in the XAML file, it can start from the root</span></div><div style="position:absolute;left:111px;top:491px;white-space:pre;"><span class="cls_0">element (the page itself) and locate specific elements within the tree. This process is called “walking the</span></div><div style="position:absolute;left:111px;top:508px;white-space:pre;"><span class="cls_0">tree” and can be useful for locating particular elements on a page.</span></div><div style="position:absolute;left:127px;top:535px;white-space:pre;"><span class="cls_0">Generally, a better approach is to give elements in the XAML file a name similar to a variable name.</span></div><div style="position:absolute;left:111px;top:552px;white-space:pre;"><span class="cls_0">To do this you use an attribute that is intrinsic to XAML, called </span><span class="cls_5">Name</span><span class="cls_0">. Because the prefix </span><span class="cls_5">x</span><span class="cls_0">is almost uni-</span></div><div style="position:absolute;left:111px;top:570px;white-space:pre;"><span class="cls_0">versally used for attributes intrinsic to XAML, this </span><span class="cls_5">Name</span><span class="cls_0">attribute is commonly referred to as </span><span class="cls_5">x:Name</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:596px;white-space:pre;"><span class="cls_0">The </span><span class="cls_13">XamlClock</span><span class="cls_0"> </span><span class="cls_0">project demonstrates the use of </span><span class="cls_5">x:Name</span><span class="cls_0">. Here is the XamlClockPage.xaml file con-</span></div><div style="position:absolute;left:111px;top:614px;white-space:pre;"><span class="cls_0">taining two </span><span class="cls_5">Label</span><span class="cls_0">controls, named </span><span class="cls_5">timeLabel</span><span class="cls_0">and </span><span class="cls_5">dateLabel</span><span class="cls_0">:</span></div><div style="position:absolute;left:111px;top:639px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:652px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:666px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">XamlClock.XamlClockPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:679px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:692px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">timeLabel</span><span class="cls_1">"</span></div><div style="position:absolute;left:195px;top:706px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:195px;top:719px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:195px;top:732px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">EndAndExpand</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:156px;top:759px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">dateLabel</span><span class="cls_1">"</span></div><div style="position:absolute;left:195px;top:772px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:195px;top:786px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">StartAndExpand</span><span class="cls_1">" </span><span class="cls_4">/></span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">162</span></div><div style="position:absolute;left:109px;top:71px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:84px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:103px;top:110px;white-space:pre;"><span class="cls_0">The rules for </span><span class="cls_5">x:Name</span><span class="cls_0">are the same as for C# variable names. (You’ll see why shortly.) The name must</span></div><div style="position:absolute;left:87px;top:127px;white-space:pre;"><span class="cls_0">begin with a letter or an underscore and can contain only letters, underscores, and numbers.</span></div><div style="position:absolute;left:103px;top:154px;white-space:pre;"><span class="cls_0">Like the clock program in Chapter 5, </span><span class="cls_13">XamlClock</span><span class="cls_0"> </span><span class="cls_0">uses </span><span class="cls_5">Device.StartTimer</span><span class="cls_0">to fire a periodic event</span></div><div style="position:absolute;left:87px;top:171px;white-space:pre;"><span class="cls_0">for updating the time and date. Here’s the </span><span class="cls_5">XamlClockPage</span><span class="cls_0">code-behind file:</span></div><div style="position:absolute;left:87px;top:196px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">XamlClock</span></div><div style="position:absolute;left:87px;top:210px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:223px;white-space:pre;"><span class="cls_4">public partial class </span><span class="cls_2">XamlClockPage</span></div><div style="position:absolute;left:109px;top:236px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:250px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">XamlClockPage()</span></div><div style="position:absolute;left:132px;top:263px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:276px;white-space:pre;"><span class="cls_1">InitializeComponent();</span></div><div style="position:absolute;left:154px;top:303px;white-space:pre;"><span class="cls_2">Device</span><span class="cls_1">.StartTimer(</span><span class="cls_2">TimeSpan</span><span class="cls_1">.FromSeconds(1), OnTimerTick);</span></div><div style="position:absolute;left:132px;top:316px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:132px;top:343px;white-space:pre;"><span class="cls_4">bool </span><span class="cls_1">OnTimerTick()</span></div><div style="position:absolute;left:132px;top:356px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:370px;white-space:pre;"><span class="cls_2">DateTime </span><span class="cls_1">dt = </span><span class="cls_2">DateTime</span><span class="cls_1">.Now;</span></div><div style="position:absolute;left:154px;top:383px;white-space:pre;"><span class="cls_1">timeLabel.Text = dt.ToString(</span><span class="cls_6">"T"</span><span class="cls_1">);</span></div><div style="position:absolute;left:154px;top:396px;white-space:pre;"><span class="cls_1">dateLabel.Text = dt.ToString(</span><span class="cls_6">"D"</span><span class="cls_1">);</span></div><div style="position:absolute;left:154px;top:410px;white-space:pre;"><span class="cls_4">return true</span><span class="cls_1">;</span></div><div style="position:absolute;left:132px;top:423px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:436px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:450px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:475px;white-space:pre;"><span class="cls_0">This timer callback method is called once per second. The method must return </span><span class="cls_5">true</span><span class="cls_0">to continue the</span></div><div style="position:absolute;left:87px;top:492px;white-space:pre;"><span class="cls_0">timer. If it returns </span><span class="cls_5">false</span><span class="cls_0">, the timer stops and must be restarted with another call to </span><span class="cls_5">Device.Start-</span></div><div style="position:absolute;left:87px;top:510px;white-space:pre;"><span class="cls_5">Timer</span><span class="cls_0">.</span></div><div style="position:absolute;left:103px;top:536px;white-space:pre;"><span class="cls_0">The callback method references </span><span class="cls_5">timeLabel</span><span class="cls_0">and </span><span class="cls_5">dateLabel</span><span class="cls_0">as though they were normal variables</span></div><div style="position:absolute;left:87px;top:554px;white-space:pre;"><span class="cls_0">and sets the </span><span class="cls_5">Text</span><span class="cls_0">properties of each:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:111px;top:71px;width:492px;height:295px;z-index:0;"><img src="images\image95.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image96.png" width="708" height="864" alt=""></div><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">163</span></div><div style="position:absolute;left:111px;top:374px;white-space:pre;"><span class="cls_0">This is no</span><span class="cls_0">t a visually impressive clock, but it’s definitely functional.</span></div><div style="position:absolute;left:127px;top:400px;white-space:pre;"><span class="cls_0">How is it that the code-behind file can reference the elements identified with </span><span class="cls_5">x:Name</span><span class="cls_0">? Is it magic?</span></div><div style="position:absolute;left:111px;top:418px;white-space:pre;"><span class="cls_0">Of course not. The mechanism is very evident when you examine the XamlClockPage.xaml.g.cs file that</span></div><div style="position:absolute;left:111px;top:435px;white-space:pre;"><span class="cls_0">the XAML parser generates from the XAML file as the project is being built:</span></div><div style="position:absolute;left:111px;top:460px;white-space:pre;"><span class="cls_3">//------------------------------------------------------------------------------</span></div><div style="position:absolute;left:111px;top:474px;white-space:pre;"><span class="cls_3">// <auto-generated></span></div><div style="position:absolute;left:111px;top:487px;white-space:pre;"><span class="cls_3">//</span></div><div style="position:absolute;left:150px;top:487px;white-space:pre;"><span class="cls_3">This code was generated by a tool.</span></div><div style="position:absolute;left:111px;top:500px;white-space:pre;"><span class="cls_3">//</span></div><div style="position:absolute;left:150px;top:500px;white-space:pre;"><span class="cls_3">Runtime Version:4.0.30319.42000</span></div><div style="position:absolute;left:111px;top:514px;white-space:pre;"><span class="cls_3">//</span></div><div style="position:absolute;left:111px;top:527px;white-space:pre;"><span class="cls_3">//</span></div><div style="position:absolute;left:150px;top:527px;white-space:pre;"><span class="cls_3">Changes to this file may cause incorrect behavior and will be lost if</span></div><div style="position:absolute;left:111px;top:540px;white-space:pre;"><span class="cls_3">//</span></div><div style="position:absolute;left:150px;top:540px;white-space:pre;"><span class="cls_3">the code is regenerated.</span></div><div style="position:absolute;left:111px;top:554px;white-space:pre;"><span class="cls_3">// </auto-generated></span></div><div style="position:absolute;left:111px;top:567px;white-space:pre;"><span class="cls_3">//------------------------------------------------------------------------------</span></div><div style="position:absolute;left:111px;top:594px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">XamlClock {</span></div><div style="position:absolute;left:133px;top:607px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">System;</span></div><div style="position:absolute;left:133px;top:620px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Xamarin.Forms;</span></div><div style="position:absolute;left:133px;top:634px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Xamarin.Forms.Xaml;</span></div><div style="position:absolute;left:133px;top:660px;white-space:pre;"><span class="cls_4">public partial class </span><span class="cls_2">XamlClockPage </span><span class="cls_1">: </span><span class="cls_4">global</span><span class="cls_1">::Xamarin.Forms.ContentPage {</span></div><div style="position:absolute;left:156px;top:687px;white-space:pre;"><span class="cls_1">[System.CodeDom.Compiler.</span><span class="cls_2">GeneratedCodeAttribute</span><span class="cls_1">(</span><span class="cls_6">"Xamarin.Forms.Build.Tasks.XamlG"</span><span class="cls_1">,</span></div><div style="position:absolute;left:426px;top:700px;white-space:pre;"><span class="cls_6">"0.0.0.0"</span><span class="cls_1">)]</span></div><div style="position:absolute;left:156px;top:714px;white-space:pre;"><span class="cls_4">private global</span><span class="cls_1">::Xamarin.Forms.Label timeLabel;</span></div><div style="position:absolute;left:156px;top:740px;white-space:pre;"><span class="cls_1">[System.CodeDom.Compiler.</span><span class="cls_2">GeneratedCodeAttribute</span><span class="cls_1">(</span><span class="cls_6">"Xamarin.Forms.Build.Tasks.XamlG"</span><span class="cls_1">,</span></div><div style="position:absolute;left:426px;top:754px;white-space:pre;"><span class="cls_6">"0.0.0.0"</span><span class="cls_1">)]</span></div><div style="position:absolute;left:156px;top:767px;white-space:pre;"><span class="cls_4">private global</span><span class="cls_1">::Xamarin.Forms.Label dateLabel;</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">164</span></div><div style="position:absolute;left:132px;top:71px;white-space:pre;"><span class="cls_1">[System.CodeDom.Compiler.</span><span class="cls_2">GeneratedCodeAttribute</span><span class="cls_1">(</span><span class="cls_6">"Xamarin.Forms.Build.Tasks.XamlG"</span><span class="cls_1">,</span></div><div style="position:absolute;left:402px;top:84px;white-space:pre;"><span class="cls_6">"0.0.0.0"</span><span class="cls_1">)]</span></div><div style="position:absolute;left:132px;top:98px;white-space:pre;"><span class="cls_4">private void </span><span class="cls_1">InitializeComponent() {</span></div><div style="position:absolute;left:154px;top:111px;white-space:pre;"><span class="cls_4">this</span><span class="cls_1">.LoadFromXaml(</span><span class="cls_4">typeof</span><span class="cls_1">(</span><span class="cls_2">XamlClockPage</span><span class="cls_1">));</span></div><div style="position:absolute;left:154px;top:124px;white-space:pre;"><span class="cls_1">timeLabel = </span><span class="cls_4">this</span><span class="cls_1">.FindByName<</span><span class="cls_4">global</span><span class="cls_1">::Xamarin.Forms.Label>(</span><span class="cls_6">"timeLabel"</span><span class="cls_1">);</span></div><div style="position:absolute;left:154px;top:138px;white-space:pre;"><span class="cls_1">dateLabel = </span><span class="cls_4">this</span><span class="cls_1">.FindByName<</span><span class="cls_4">global</span><span class="cls_1">::Xamarin.Forms.Label>(</span><span class="cls_6">"dateLabel"</span><span class="cls_1">);</span></div><div style="position:absolute;left:132px;top:151px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:164px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:178px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:203px;white-space:pre;"><span class="cls_0">It might be a little hard to see because of the attributes and fully qualified types, but as the build-time</span></div><div style="position:absolute;left:87px;top:220px;white-space:pre;"><span class="cls_0">XAML parser chews through the XAML file, every </span><span class="cls_5">x:Name</span><span class="cls_0">attribute becomes a private field in this gen-</span></div><div style="position:absolute;left:87px;top:238px;white-space:pre;"><span class="cls_0">erated code file. This allows code in the code-behind file to reference these names as though they were</span></div><div style="position:absolute;left:87px;top:255px;white-space:pre;"><span class="cls_0">normal fields</span><span class="cls_0">—</span><span class="cls_0">which they definitely are. However, the fields are initially </span><span class="cls_5">null</span><span class="cls_0">. Only when </span><span class="cls_5">Initial-</span></div><div style="position:absolute;left:87px;top:272px;white-space:pre;"><span class="cls_5">izeComponent</span><span class="cls_0">is called at run time are the two fields set via the </span><span class="cls_5">FindByName</span><span class="cls_0">method, which is de-</span></div><div style="position:absolute;left:87px;top:290px;white-space:pre;"><span class="cls_0">fined in the </span><span class="cls_5">NameScopeExtensions</span><span class="cls_0">class. If the constructor of your code-behind file tries to reference</span></div><div style="position:absolute;left:87px;top:307px;white-space:pre;"><span class="cls_0">these two fields prior to the </span><span class="cls_5">InitializeComponent</span><span class="cls_0">call, they will have </span><span class="cls_5">null</span><span class="cls_0">values.</span></div><div style="position:absolute;left:103px;top:334px;white-space:pre;"><span class="cls_0">This generated code file also implies another rule for </span><span class="cls_5">x:Name</span><span class="cls_0">values that is now very obvious but</span></div><div style="position:absolute;left:87px;top:351px;white-space:pre;"><span class="cls_0">rarely stated explicitly: the names cannot duplicate names of fields or properties defined in the code-</span></div><div style="position:absolute;left:87px;top:368px;white-space:pre;"><span class="cls_0">behind file.</span></div><div style="position:absolute;left:103px;top:395px;white-space:pre;"><span class="cls_0">Because these are private fields, they can be accessed only from the code-behind file and not from</span></div><div style="position:absolute;left:87px;top:412px;white-space:pre;"><span class="cls_0">other classes. If a </span><span class="cls_5">ContentPage</span><span class="cls_0">derivative needs to expose public fields or properties to other classes,</span></div><div style="position:absolute;left:87px;top:430px;white-space:pre;"><span class="cls_0">you must define those yourself.</span></div><div style="position:absolute;left:103px;top:456px;white-space:pre;"><span class="cls_0">Obviously, </span><span class="cls_5">x:Name</span><span class="cls_0">values must be unique within a XAML page. This can sometimes be a problem if</span></div><div style="position:absolute;left:87px;top:474px;white-space:pre;"><span class="cls_0">you’re using </span><span class="cls_5">OnPlatform</span><span class="cls_0">for platform-specific elemen</span><span class="cls_0">ts in the XAML file. For example, here’s a XAML</span></div><div style="position:absolute;left:87px;top:491px;white-space:pre;"><span class="cls_0">file that expresses the </span><span class="cls_5">iOS</span><span class="cls_0">, </span><span class="cls_5">Android</span><span class="cls_0">, and </span><span class="cls_5">WinPhone</span><span class="cls_0">properties of </span><span class="cls_5">OnPlatform</span><span class="cls_0">as property elements</span></div><div style="position:absolute;left:87px;top:508px;white-space:pre;"><span class="cls_0">to select one of three </span><span class="cls_5">Label</span><span class="cls_0">views:</span></div><div style="position:absolute;left:87px;top:534px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:547px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:560px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">PlatformSpecificLabels.PlatformSpecificLabelsPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:587px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">View</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:600px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform.iOS</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:614px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">This is an iOS device</span><span class="cls_1">"</span></div><div style="position:absolute;left:194px;top:627px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:194px;top:640px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:132px;top:654px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">OnPlatform.iOS</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:680px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform.Android</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:694px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">This is an Android device</span><span class="cls_1">"</span></div><div style="position:absolute;left:194px;top:707px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:194px;top:720px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:132px;top:734px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">OnPlatform.Android</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:760px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform.WinPhone</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:774px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">This is an Windows device</span><span class="cls_1">"</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">165</span></div><div style="position:absolute;left:218px;top:71px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:218px;top:84px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:156px;top:98px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">OnPlatform.WinPhone</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:111px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">OnPlatform</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:124px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:150px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">x:TypeArguments</span><span class="cls_0">attribute of </span><span class="cls_5">OnPlatform</span><span class="cls_0">must match the type of the target property exactly.</span></div><div style="position:absolute;left:111px;top:167px;white-space:pre;"><span class="cls_0">This </span><span class="cls_5">OnPlatform</span><span class="cls_0">element is implicitly being set to the </span><span class="cls_5">Content</span><span class="cls_0">property of </span><span class="cls_5">ContentPage</span><span class="cls_0">, and this</span></div><div style="position:absolute;left:111px;top:184px;white-space:pre;"><span class="cls_5">Content</span><span class="cls_0">property is of type </span><span class="cls_5">View</span><span class="cls_0">, so the </span><span class="cls_5">x:TypeArguments</span><span class="cls_0">attribute of </span><span class="cls_5">OnPlatform</span><span class="cls_0">must specify</span></div><div style="position:absolute;left:111px;top:202px;white-space:pre;"><span class="cls_5">View</span><span class="cls_0">. However, the properties of </span><span class="cls_5">OnPlatform</span><span class="cls_0">can be set to any class that derives from that type. The</span></div><div style="position:absolute;left:111px;top:219px;white-space:pre;"><span class="cls_0">objects set to the </span><span class="cls_5">iOS</span><span class="cls_0">, </span><span class="cls_5">Android</span><span class="cls_0">, and </span><span class="cls_5">WinPhone</span><span class="cls_0">properties can in fact be different types just as long as</span></div><div style="position:absolute;left:111px;top:236px;white-space:pre;"><span class="cls_0">they all derive from </span><span class="cls_5">View</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:263px;white-space:pre;"><span class="cls_0">Although that XAML file works, it’s not exactly optimum. All three </span><span class="cls_5">Label</span><span class="cls_0">views are instantiated and</span></div><div style="position:absolute;left:111px;top:280px;white-space:pre;"><span class="cls_0">initialized, but only one is set to the </span><span class="cls_5">Content</span><span class="cls_0">property of the </span><span class="cls_5">ContentPage</span><span class="cls_0">. The problem with this</span></div><div style="position:absolute;left:111px;top:298px;white-space:pre;"><span class="cls_0">approach arises if you need to refer to the </span><span class="cls_5">Label</span><span class="cls_0">from the code-behind file and you give each of them</span></div><div style="position:absolute;left:111px;top:315px;white-space:pre;"><span class="cls_0">the same name, like so:</span></div><div style="position:absolute;left:127px;top:342px;white-space:pre;"><span class="cls_9">The</span><span class="cls_0"> </span><span class="cls_9">following</span><span class="cls_0"> </span><span class="cls_9">XAML</span><span class="cls_0"> </span><span class="cls_9">file</span><span class="cls_0"> </span><span class="cls_9">does</span><span class="cls_0"> </span><span class="cls_9">not</span><span class="cls_0"> </span><span class="cls_9">work!</span></div><div style="position:absolute;left:111px;top:367px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:380px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:394px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">PlatformSpecificLabels.PlatformSpecificLabelsPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:420px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">View</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:434px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform.iOS</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:447px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">deviceLabel</span><span class="cls_1">"</span></div><div style="position:absolute;left:218px;top:460px;white-space:pre;"><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">This is an iOS device</span><span class="cls_1">"</span></div><div style="position:absolute;left:218px;top:474px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:218px;top:487px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:156px;top:500px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">OnPlatform.iOS</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:527px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform.Android</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:540px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">deviceLabel</span><span class="cls_1">"</span></div><div style="position:absolute;left:218px;top:554px;white-space:pre;"><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">This is an Android device</span><span class="cls_1">"</span></div><div style="position:absolute;left:218px;top:567px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:218px;top:580px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:156px;top:594px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">OnPlatform.Android</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:620px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform.WinPhone</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:634px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">deviceLabel</span><span class="cls_1">"</span></div><div style="position:absolute;left:218px;top:647px;white-space:pre;"><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">This is a Windows device</span><span class="cls_1">"</span></div><div style="position:absolute;left:218px;top:660px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:218px;top:674px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:156px;top:687px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">OnPlatform.WinPhone</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:700px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">OnPlatform</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:714px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:739px;white-space:pre;"><span class="cls_0">This will not work because multiple elements cannot have the same name.</span></div><div style="position:absolute;left:127px;top:766px;white-space:pre;"><span class="cls_0">You could give them different names and handle the three names in the code-behind file by using</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:87px;top:407px;width:492px;height:295px;z-index:0;"><img src="images\image97.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image98.png" width="708" height="864" alt=""></div><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">166</span></div><div style="position:absolute;left:87px;top:72px;white-space:pre;"><span class="cls_5">Device.OnPlatform</span><span class="cls_0">, but a better solution is to keep the platform-specific markup as small as possi-</span></div><div style="position:absolute;left:87px;top:90px;white-space:pre;"><span class="cls_0">ble. In this example, all the </span><span class="cls_5">Label</span><span class="cls_0">properties are the same except for </span><span class="cls_5">Text,</span><span class="cls_0">so only the </span><span class="cls_5">Text</span><span class="cls_0">property</span></div><div style="position:absolute;left:87px;top:107px;white-space:pre;"><span class="cls_0">needs to be pla</span><span class="cls_0">tform specific. Here’s the version of the </span><span class="cls_13">PlatformSpecificLabels</span><span class="cls_0"> </span><span class="cls_0">program that is in-</span></div><div style="position:absolute;left:87px;top:124px;white-space:pre;"><span class="cls_0">cluded with the sample code for this chapter. It has a single </span><span class="cls_5">Label</span><span class="cls_0">, and everything is platform inde-</span></div><div style="position:absolute;left:87px;top:142px;white-space:pre;"><span class="cls_0">pendent except for the </span><span class="cls_5">Text</span><span class="cls_0">property:</span></div><div style="position:absolute;left:87px;top:167px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:180px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:194px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">PlatformSpecificLabels.PlatformSpecificLabelsPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:220px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">deviceLabel</span><span class="cls_1">"</span></div><div style="position:absolute;left:149px;top:234px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:149px;top:247px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:260px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.Text</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:274px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">x:String</span><span class="cls_1">"</span></div><div style="position:absolute;left:222px;top:287px;white-space:pre;"><span class="cls_14">iOS</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">This is an iOS device</span><span class="cls_1">"</span></div><div style="position:absolute;left:222px;top:300px;white-space:pre;"><span class="cls_14">Android</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">This is an Android device</span><span class="cls_1">"</span></div><div style="position:absolute;left:222px;top:314px;white-space:pre;"><span class="cls_14">WinPhone</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">This is a Windows device</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:132px;top:327px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.Text</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:340px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:354px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:379px;white-space:pre;"><span class="cls_0">Here’s what it looks like:</span></div><div style="position:absolute;left:103px;top:710px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">Text</span><span class="cls_0">property is the content property for </span><span class="cls_5">Label</span><span class="cls_0">, so you don’t need the </span><span class="cls_5">Label.Text</span><span class="cls_0">tags in</span></div><div style="position:absolute;left:87px;top:727px;white-space:pre;"><span class="cls_0">the previous example. This works as well:</span></div><div style="position:absolute;left:87px;top:752px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:766px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:779px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">PlatformSpecificLabels.PlatformSpecificLabelsPage</span><span class="cls_1">"</span><span class="cls_4">></span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image99.png" width="708" height="864" alt=""></div><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">167</span></div><div style="position:absolute;left:133px;top:84px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">deviceLabel</span><span class="cls_1">"</span></div><div style="position:absolute;left:173px;top:98px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:173px;top:111px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:124px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">x:String</span><span class="cls_1">"</span></div><div style="position:absolute;left:223px;top:138px;white-space:pre;"><span class="cls_14">iOS</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">This is an iOS device</span><span class="cls_1">"</span></div><div style="position:absolute;left:223px;top:151px;white-space:pre;"><span class="cls_14">Android</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">This is an Android device</span><span class="cls_1">"</span></div><div style="position:absolute;left:223px;top:164px;white-space:pre;"><span class="cls_14">WinPhone</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">This is a Windows device</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:133px;top:178px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:191px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:79px;top:228px;white-space:pre;"><span class="cls_11">Custom</span><span class="cls_12"> </span><span class="cls_11">XAML-based</span><span class="cls_12"> </span><span class="cls_11">views</span></div><div style="position:absolute;left:111px;top:276px;white-space:pre;"><span class="cls_0">The </span><span class="cls_13">ScaryColorList</span><span class="cls_0"> </span><span class="cls_0">program in the previous chapter listed a few colors in a </span><span class="cls_5">StackLayout</span><span class="cls_0">using</span></div><div style="position:absolute;left:111px;top:294px;white-space:pre;"><span class="cls_5">Frame</span><span class="cls_0">, </span><span class="cls_5">BoxView</span><span class="cls_0">, and </span><span class="cls_5">Label</span><span class="cls_0">. Even with just three colors, the repetitive markup was starting to look</span></div><div style="position:absolute;left:111px;top:311px;white-space:pre;"><span class="cls_0">very ominous. Unfortunately there is no XAML markup that duplicates the C# </span><span class="cls_5">for</span><span class="cls_0">and </span><span class="cls_5">while</span><span class="cls_0">loops, so</span></div><div style="position:absolute;left:111px;top:328px;white-space:pre;"><span class="cls_0">your choice is to use code for generating multiple similar items, or to find a better way to do it in</span></div><div style="position:absolute;left:111px;top:346px;white-space:pre;"><span class="cls_0">markup.</span></div><div style="position:absolute;left:127px;top:372px;white-space:pre;"><span class="cls_0">In this book, you’ll see several ways to list colors in XAML, and eventually, a ve</span><span class="cls_0">ry clean and elegant</span></div><div style="position:absolute;left:111px;top:390px;white-space:pre;"><span class="cls_0">way to do this job will become clear. But that requires a few more steps into learning Xamarin.Forms.</span></div><div style="position:absolute;left:111px;top:407px;white-space:pre;"><span class="cls_0">Until then, we’ll be looking at some other approaches that you might find useful in similar circum-</span></div><div style="position:absolute;left:111px;top:424px;white-space:pre;"><span class="cls_0">stances.</span></div><div style="position:absolute;left:127px;top:451px;white-space:pre;"><span class="cls_0">One strategy is to create a custom view that has the sole purpose of displaying a color with a name</span></div><div style="position:absolute;left:111px;top:468px;white-space:pre;"><span class="cls_0">and a colored box. And while we’re at it, let’s display the hexadecimal RGB values of the colors as well.</span></div><div style="position:absolute;left:111px;top:486px;white-space:pre;"><span class="cls_0">You can then use that custom view in a XAML page file for the individual colors.</span></div><div style="position:absolute;left:127px;top:512px;white-space:pre;"><span class="cls_0">What might a reference to such a custom view look like in XAML?</span></div><div style="position:absolute;left:127px;top:539px;white-space:pre;"><span class="cls_0">Or the better question is: How would you </span><span class="cls_9">like</span><span class="cls_0"> </span><span class="cls_0">it to look?</span></div><div style="position:absolute;left:127px;top:566px;white-space:pre;"><span class="cls_0">If the markup looked something like this, the repetition is not bad at all, and not so much worse</span></div><div style="position:absolute;left:111px;top:583px;white-space:pre;"><span class="cls_0">than explicitly defining an array of </span><span class="cls_5">Color</span><span class="cls_0">values in code:</span></div><div style="position:absolute;left:111px;top:608px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:622px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">MyColorView </span><span class="cls_14">Color</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Red</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:133px;top:635px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">MyColorView </span><span class="cls_14">Color</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Green</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:133px;top:648px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">MyColorView </span><span class="cls_14">Color</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Blue</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:133px;top:662px;white-space:pre;"><span class="cls_4">…</span></div><div style="position:absolute;left:111px;top:675px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:700px;white-space:pre;"><span class="cls_0">Well, actually, it won’t look exactly like that. </span><span class="cls_5">MyColorView</span><span class="cls_0">is obviously a custom class and not part of</span></div><div style="position:absolute;left:111px;top:718px;white-space:pre;"><span class="cls_0">the Xamarin.Forms API. Therefore, it cannot appear in the XAML file without a namespace prefix that is</span></div><div style="position:absolute;left:111px;top:735px;white-space:pre;"><span class="cls_0">defined in an XML namespace declaration.</span></div><div style="position:absolute;left:127px;top:762px;white-space:pre;"><span class="cls_0">With this XML prefix applied, there won’t be any confusion about this custom view being pa</span><span class="cls_0">rt of the</span></div><div style="position:absolute;left:111px;top:779px;white-space:pre;"><span class="cls_0">Xamarin.Forms API, so let’s give it a more dignified name of </span><span class="cls_5">ColorView</span><span class="cls_0">rather than </span><span class="cls_5">MyColorView</span><span class="cls_0">.</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">168</span></div><div style="position:absolute;left:103px;top:72px;white-space:pre;"><span class="cls_0">This hypothetical </span><span class="cls_5">ColorView</span><span class="cls_0">class is an example of a fairly easy custom view because it consists</span></div><div style="position:absolute;left:87px;top:90px;white-space:pre;"><span class="cls_0">solely of existing views</span><span class="cls_0">—</span><span class="cls_0">specifically </span><span class="cls_5">Label</span><span class="cls_0">, </span><span class="cls_5">Frame</span><span class="cls_0">, and </span><span class="cls_5">BoxView</span><span class="cls_0">—</span><span class="cls_0">arranged in a particular way using</span></div><div style="position:absolute;left:87px;top:107px;white-space:pre;"><span class="cls_5">StackLayout</span><span class="cls_0">. Xamarin.Forms defines a view designed specifically for the purpose of parenting such</span></div><div style="position:absolute;left:87px;top:124px;white-space:pre;"><span class="cls_0">an arrangement of views, and it’s called </span><span class="cls_5">ContentView</span><span class="cls_0">. Like </span><span class="cls_5">ContentPage</span><span class="cls_0">, </span><span class="cls_5">ContentView</span><span class="cls_0">has a </span><span class="cls_5">Con-</span></div><div style="position:absolute;left:87px;top:142px;white-space:pre;"><span class="cls_5">tent</span><span class="cls_0">property that you can set to a visual tree of other views. You can define the contents of the </span><span class="cls_5">Con-</span></div><div style="position:absolute;left:87px;top:159px;white-space:pre;"><span class="cls_5">tentView</span><span class="cls_0">in code, but it’s more fun to do it in XAML.</span></div><div style="position:absolute;left:103px;top:186px;white-space:pre;"><span class="cls_0">Let’s put together a solution named </span><span class="cls_13">ColorViewList</span><span class="cls_0">. This solution will have two sets of XAML and</span></div><div style="position:absolute;left:87px;top:203px;white-space:pre;"><span class="cls_0">code-behind files, the first for a class named </span><span class="cls_5">ColorViewListPage</span><span class="cls_0">, which derives from </span><span class="cls_5">ContentPage</span></div><div style="position:absolute;left:87px;top:220px;white-space:pre;"><span class="cls_0">(as usual), and the second for a class named </span><span class="cls_5">ColorView</span><span class="cls_0">, which derives from </span><span class="cls_5">ContentView</span><span class="cls_0">.</span></div><div style="position:absolute;left:103px;top:247px;white-space:pre;"><span class="cls_0">To create the </span><span class="cls_5">ColorView</span><span class="cls_0">class in Visual Studio, use the same procedure as when adding a new</span></div><div style="position:absolute;left:87px;top:264px;white-space:pre;"><span class="cls_0">XAML page to the </span><span class="cls_13">ColorViewList</span><span class="cls_0"> </span><span class="cls_0">project: Right-click the project name in the </span><span class="cls_13">Solution</span><span class="cls_0"> </span><span class="cls_13">Explorer</span><span class="cls_0">, and</span></div><div style="position:absolute;left:87px;top:282px;white-space:pre;"><span class="cls_0">select </span><span class="cls_13">Add</span><span class="cls_0"> </span><span class="cls_13">></span><span class="cls_0"> </span><span class="cls_13">New</span><span class="cls_0"> </span><span class="cls_13">Item</span><span class="cls_0"> </span><span class="cls_0">from the context menu. In the </span><span class="cls_13">Add</span><span class="cls_0"> </span><span class="cls_13">New</span><span class="cls_0"> </span><span class="cls_13">Item</span><span class="cls_0"> </span><span class="cls_0">dialog, select </span><span class="cls_13">Visual</span><span class="cls_0"> </span><span class="cls_13">C#</span><span class="cls_0"> </span><span class="cls_13">></span></div><div style="position:absolute;left:87px;top:299px;white-space:pre;"><span class="cls_13">Cross-Platform</span><span class="cls_0"> </span><span class="cls_0">at the left and then </span><span class="cls_13">Forms</span><span class="cls_0"> </span><span class="cls_13">Xaml</span><span class="cls_0"> </span><span class="cls_13">Page</span><span class="cls_0">. Enter the name ColorView.cs. But right away,</span></div><div style="position:absolute;left:87px;top:316px;white-space:pre;"><span class="cls_0">before you forget, go into the ColorView.xaml file and change the </span><span class="cls_5">ContentPage</span><span class="cls_0">start and end tags to</span></div><div style="position:absolute;left:87px;top:334px;white-space:pre;"><span class="cls_5">ContentView</span><span class="cls_0">. In the ColorView.xaml.cs file, change the base class to </span><span class="cls_5">ContentView</span><span class="cls_0">.</span></div><div style="position:absolute;left:103px;top:360px;white-space:pre;"><span class="cls_0">The process is a little easier in Xamarin Studio. From the tool menu for the </span><span class="cls_13">ColorViewList</span><span class="cls_0"> </span><span class="cls_0">project,</span></div><div style="position:absolute;left:87px;top:378px;white-space:pre;"><span class="cls_0">select </span><span class="cls_13">Add</span><span class="cls_0"> </span><span class="cls_13">></span><span class="cls_0"> </span><span class="cls_13">New</span><span class="cls_0"> </span><span class="cls_13">File</span><span class="cls_0">. In the </span><span class="cls_13">New</span><span class="cls_0"> </span><span class="cls_13">File</span><span class="cls_0"> </span><span class="cls_0">dialog, select </span><span class="cls_13">Forms</span><span class="cls_0"> </span><span class="cls_0">at the left and </span><span class="cls_13">Forms</span><span class="cls_0"> </span><span class="cls_13">ContentView</span><span class="cls_0"> </span><span class="cls_13">Xaml</span></div><div style="position:absolute;left:87px;top:395px;white-space:pre;"><span class="cls_0">(not </span><span class="cls_13">Forms</span><span class="cls_0"> </span><span class="cls_13">ContentPage</span><span class="cls_0"> </span><span class="cls_13">Xaml</span><span class="cls_0">). Give it a name of ColorView.</span></div><div style="position:absolute;left:103px;top:422px;white-space:pre;"><span class="cls_0">You’ll also need to create a XAML file an</span><span class="cls_0">d code-behind file for the </span><span class="cls_5">ColorViewListPage</span><span class="cls_0">class, as</span></div><div style="position:absolute;left:87px;top:439px;white-space:pre;"><span class="cls_0">usual.</span></div><div style="position:absolute;left:103px;top:466px;white-space:pre;"><span class="cls_0">The ColorView.xaml file describes the layout of the individual color items but without any actual</span></div><div style="position:absolute;left:87px;top:483px;white-space:pre;"><span class="cls_0">color values. Instead, the </span><span class="cls_5">BoxView</span><span class="cls_0">and two </span><span class="cls_5">Label</span><span class="cls_0">views are given names:</span></div><div style="position:absolute;left:87px;top:508px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentView </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:522px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:535px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">ColorViewList.ColorView</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:562px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Frame </span><span class="cls_14">OutlineColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Accent</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:575px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">Orientation</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Horizontal</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:588px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">boxView</span><span class="cls_1">"</span></div><div style="position:absolute;left:205px;top:602px;white-space:pre;"><span class="cls_14">WidthRequest</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">70</span><span class="cls_1">"</span></div><div style="position:absolute;left:205px;top:615px;white-space:pre;"><span class="cls_14">HeightRequest</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">70</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:154px;top:642px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:177px;top:655px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">colorNameLabel</span><span class="cls_1">"</span></div><div style="position:absolute;left:216px;top:668px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:216px;top:682px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:177px;top:708px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">colorValueLabel</span><span class="cls_1">"</span></div><div style="position:absolute;left:216px;top:722px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:154px;top:735px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:748px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:762px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Frame</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:775px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentView</span><span class="cls_4">></span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">169</span></div><div style="position:absolute;left:111px;top:72px;white-space:pre;"><span class="cls_0">In a real-</span><span class="cls_0">life program, you’ll have plenty </span><span class="cls_0">of time later to fine-</span><span class="cls_0">tune the visuals. Initially, you’ll just want</span></div><div style="position:absolute;left:111px;top:90px;white-space:pre;"><span class="cls_0">to get all the named views in there.</span></div><div style="position:absolute;left:127px;top:116px;white-space:pre;"><span class="cls_0">Besides the visuals, this </span><span class="cls_5">ColorView</span><span class="cls_0">class will need a new property to set the color. This property</span></div><div style="position:absolute;left:111px;top:134px;white-space:pre;"><span class="cls_0">must be defined in the code-behind file. At first, it seems reasonable to give </span><span class="cls_5">ColorView</span><span class="cls_0">a property</span></div><div style="position:absolute;left:111px;top:151px;white-space:pre;"><span class="cls_0">named </span><span class="cls_5">Color</span><span class="cls_0">of type </span><span class="cls_5">Color</span><span class="cls_0">(as the earlier XAML snippet with </span><span class="cls_5">MyColorView</span><span class="cls_0">seems to suggest). But</span></div><div style="position:absolute;left:111px;top:168px;white-space:pre;"><span class="cls_0">the </span><span class="cls_5">ColorView</span><span class="cls_0">class needs to display the color </span><span class="cls_9">name</span><span class="cls_0">, and it can’t get the color name from a </span><span class="cls_5">Color</span></div><div style="position:absolute;left:111px;top:186px;white-space:pre;"><span class="cls_0">value.</span></div><div style="position:absolute;left:127px;top:212px;white-space:pre;"><span class="cls_0">Instead, it makes more sense to define a property named </span><span class="cls_5">ColorName</span><span class="cls_0">of type </span><span class="cls_5">string</span><span class="cls_0">. The code-</span></div><div style="position:absolute;left:111px;top:230px;white-space:pre;"><span class="cls_0">behind file can then use reflection to obtain the static field of the </span><span class="cls_5">Color</span><span class="cls_0">class corresponding to that</span></div><div style="position:absolute;left:111px;top:247px;white-space:pre;"><span class="cls_0">name.</span></div><div style="position:absolute;left:127px;top:274px;white-space:pre;"><span class="cls_0">But wait: Xamarin.Forms includes a public </span><span class="cls_5">ColorTypeConverter</span><span class="cls_0">class that the XAML parser uses to</span></div><div style="position:absolute;left:111px;top:291px;white-space:pre;"><span class="cls_0">convert a text color name like “Red” or “Blue” into a </span><span class="cls_5">Color</span><span class="cls_0">value. Why not take advantage of that?</span></div><div style="position:absolute;left:127px;top:318px;white-space:pre;"><span class="cls_0">Here’s the code</span><span class="cls_0">-behind file for </span><span class="cls_5">ColorView</span><span class="cls_0">. It defines a </span><span class="cls_5">ColorName</span><span class="cls_0">property with a </span><span class="cls_5">set</span><span class="cls_0">accessor</span></div><div style="position:absolute;left:111px;top:335px;white-space:pre;"><span class="cls_0">that sets the </span><span class="cls_5">Text</span><span class="cls_0">property of the </span><span class="cls_5">colorNameLabel</span><span class="cls_0">to the color name, and then uses </span><span class="cls_5">ColorType-</span></div><div style="position:absolute;left:111px;top:352px;white-space:pre;"><span class="cls_5">Converter</span><span class="cls_0">to convert the name to a </span><span class="cls_5">Color</span><span class="cls_0">value. This </span><span class="cls_5">Color</span><span class="cls_0">value is then used to set the </span><span class="cls_5">Color</span></div><div style="position:absolute;left:111px;top:370px;white-space:pre;"><span class="cls_0">property of </span><span class="cls_5">boxView</span><span class="cls_0">and the </span><span class="cls_5">Text</span><span class="cls_0">property of the </span><span class="cls_5">colorValueLabel</span><span class="cls_0">to the RGB values:</span></div><div style="position:absolute;left:111px;top:395px;white-space:pre;"><span class="cls_4">public partial class </span><span class="cls_2">ColorView </span><span class="cls_1">: </span><span class="cls_2">ContentView</span></div><div style="position:absolute;left:111px;top:408px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:422px;white-space:pre;"><span class="cls_4">string </span><span class="cls_1">colorName;</span></div><div style="position:absolute;left:133px;top:435px;white-space:pre;"><span class="cls_2">ColorTypeConverter </span><span class="cls_1">colorTypeConv = </span><span class="cls_4">new </span><span class="cls_2">ColorTypeConverter</span><span class="cls_1">();</span></div><div style="position:absolute;left:133px;top:462px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">ColorView()</span></div><div style="position:absolute;left:133px;top:475px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:488px;white-space:pre;"><span class="cls_1">InitializeComponent();</span></div><div style="position:absolute;left:133px;top:502px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:133px;top:528px;white-space:pre;"><span class="cls_4">public string </span><span class="cls_1">ColorName</span></div><div style="position:absolute;left:133px;top:542px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:555px;white-space:pre;"><span class="cls_4">set</span></div><div style="position:absolute;left:156px;top:568px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:582px;white-space:pre;"><span class="cls_3">// Set the name.</span></div><div style="position:absolute;left:178px;top:595px;white-space:pre;"><span class="cls_1">colorName = </span><span class="cls_4">value</span><span class="cls_1">;</span></div><div style="position:absolute;left:178px;top:608px;white-space:pre;"><span class="cls_1">colorNameLabel.Text = </span><span class="cls_4">value</span><span class="cls_1">;</span></div><div style="position:absolute;left:178px;top:635px;white-space:pre;"><span class="cls_3">// Get the actual Color and set the other views.</span></div><div style="position:absolute;left:178px;top:648px;white-space:pre;"><span class="cls_2">Color </span><span class="cls_1">color = (</span><span class="cls_2">Color</span><span class="cls_1">)colorTypeConv.ConvertFrom(colorName);</span></div><div style="position:absolute;left:178px;top:662px;white-space:pre;"><span class="cls_1">boxView.Color = color;</span></div><div style="position:absolute;left:178px;top:675px;white-space:pre;"><span class="cls_1">colorValueLabel.Text = </span><span class="cls_2">String</span><span class="cls_1">.Format(</span><span class="cls_6">"{0:X2}-{1:X2}-{2:X2}"</span><span class="cls_1">,</span></div><div style="position:absolute;left:386px;top:688px;white-space:pre;"><span class="cls_1">(</span><span class="cls_4">int</span><span class="cls_1">)(255 * color.R),</span></div><div style="position:absolute;left:386px;top:702px;white-space:pre;"><span class="cls_1">(</span><span class="cls_4">int</span><span class="cls_1">)(255 * color.G),</span></div><div style="position:absolute;left:386px;top:715px;white-space:pre;"><span class="cls_1">(</span><span class="cls_4">int</span><span class="cls_1">)(255 * color.B));</span></div><div style="position:absolute;left:156px;top:728px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:156px;top:742px;white-space:pre;"><span class="cls_4">get</span></div><div style="position:absolute;left:156px;top:755px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:768px;white-space:pre;"><span class="cls_4">return </span><span class="cls_1">colorName;</span></div><div style="position:absolute;left:156px;top:782px;white-space:pre;"><span class="cls_1">}</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">170</span></div><div style="position:absolute;left:109px;top:71px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:84px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:103px;top:110px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">ColorView</span><span class="cls_0">class is finished. Now let’s look at </span><span class="cls_5">ColorViewListPage</span><span class="cls_0">. The ColorViewList-</span></div><div style="position:absolute;left:87px;top:127px;white-space:pre;"><span class="cls_0">Page.xaml file must list multiple </span><span class="cls_5">ColorView</span><span class="cls_0">instances, so it needs a new XML namespace declaration</span></div><div style="position:absolute;left:87px;top:144px;white-space:pre;"><span class="cls_0">with a new namespace prefix to reference the </span><span class="cls_5">ColorView</span><span class="cls_0">element.</span></div><div style="position:absolute;left:103px;top:171px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">ColorView</span><span class="cls_0">class is part of the same project as </span><span class="cls_5">ColorViewListPage</span><span class="cls_0">. Generally, programmers</span></div><div style="position:absolute;left:87px;top:188px;white-space:pre;"><span class="cls_0">use an XML namespace prefix of </span><span class="cls_5">local</span><span class="cls_0">for such cases. The new namespace declaration appears in the</span></div><div style="position:absolute;left:87px;top:206px;white-space:pre;"><span class="cls_0">root element of the XAML file (like the other two) with the following format:</span></div><div style="position:absolute;left:87px;top:231px;white-space:pre;"><span class="cls_14">xmlns:local</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">clr-namespace:ColorViewList;assembly=ColorViewList</span><span class="cls_1">"</span></div><div style="position:absolute;left:87px;top:256px;white-space:pre;"><span class="cls_0">In the general case, a custom XML namespace declaration for XAML must specify a common language</span></div><div style="position:absolute;left:87px;top:274px;white-space:pre;"><span class="cls_0">runtime (CLR) namespace</span><span class="cls_0">—</span><span class="cls_0">also known as the .NET namespace</span><span class="cls_0">—</span><span class="cls_0">and an assembly. The keywords to</span></div><div style="position:absolute;left:87px;top:291px;white-space:pre;"><span class="cls_0">specify these are </span><span class="cls_5">clr-namespace</span><span class="cls_0">and </span><span class="cls_5">assembly</span><span class="cls_0">. Often the CLR namespace is the same as the assem-</span></div><div style="position:absolute;left:87px;top:308px;white-space:pre;"><span class="cls_0">bly, as they are in this case, but they do</span><span class="cls_0">n’t need to be. The two parts are connected by a semicolon.</span></div><div style="position:absolute;left:103px;top:335px;white-space:pre;"><span class="cls_0">Notice that a colon follows </span><span class="cls_5">clr-namespace</span><span class="cls_0">, but an equal sign follows </span><span class="cls_5">assembly</span><span class="cls_0">. This apparent</span></div><div style="position:absolute;left:87px;top:352px;white-space:pre;"><span class="cls_0">inconsistency is deliberate: the format of the namespace declaration is intended to mimic a URI found</span></div><div style="position:absolute;left:87px;top:370px;white-space:pre;"><span class="cls_0">in conventional namespace declarations, in which a colon follows the URI scheme name.</span></div><div style="position:absolute;left:103px;top:396px;white-space:pre;"><span class="cls_0">You use the same syntax for referencing objects in external portable class libraries. The only differ-</span></div><div style="position:absolute;left:87px;top:414px;white-space:pre;"><span class="cls_0">ence in those cases is that the project also needs a reference to tha</span><span class="cls_0">t external PCL. (You’ll see an exam-</span></div><div style="position:absolute;left:87px;top:431px;white-space:pre;"><span class="cls_0">ple in Chapter 10, “XAML markup extensions.”).</span></div><div style="position:absolute;left:103px;top:458px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">local</span><span class="cls_0">prefix is common for code in the same assembly, and in that case the </span><span class="cls_5">assembly</span><span class="cls_0">part is</span></div><div style="position:absolute;left:87px;top:475px;white-space:pre;"><span class="cls_0">not required:</span></div><div style="position:absolute;left:87px;top:500px;white-space:pre;"><span class="cls_14">xmlns:local</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">clr-namespace:ColorViewList</span><span class="cls_1">"</span></div><div style="position:absolute;left:87px;top:526px;white-space:pre;"><span class="cls_0">For a XAML file in a PCL, you can include the </span><span class="cls_5">assembly</span><span class="cls_0">part to reference something in the same as-</span></div><div style="position:absolute;left:87px;top:543px;white-space:pre;"><span class="cls_0">sembly if you want but it’s not necessary. For a XAML file in an SAP, however, you must </span><span class="cls_9">not</span><span class="cls_0"> </span><span class="cls_0">include the</span></div><div style="position:absolute;left:87px;top:560px;white-space:pre;"><span class="cls_5">assembly</span><span class="cls_0">part to reference a local class because there is no assembly associated with an SAP. The</span></div><div style="position:absolute;left:87px;top:578px;white-space:pre;"><span class="cls_0">code in the SAP is actually part of the individual platform assemblies, and those all have different</span></div><div style="position:absolute;left:87px;top:595px;white-space:pre;"><span class="cls_0">names.</span></div><div style="position:absolute;left:103px;top:622px;white-space:pre;"><span class="cls_0">Here’s the XAML for the </span><span class="cls_5">ColorViewListPage</span><span class="cls_0">class. The code-behind file contains nothing beyond</span></div><div style="position:absolute;left:87px;top:639px;white-space:pre;"><span class="cls_0">the </span><span class="cls_5">InitializeComponent</span><span class="cls_0">call:</span></div><div style="position:absolute;left:87px;top:664px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:678px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:691px;white-space:pre;"><span class="cls_14">xmlns:local</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">clr-namespace:ColorViewList</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:704px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">ColorViewList.ColorViewListPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:731px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage.Padding</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:744px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Thickness</span><span class="cls_1">"</span></div><div style="position:absolute;left:199px;top:758px;white-space:pre;"><span class="cls_14">iOS</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">0, 20, 0, 0</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:109px;top:771px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage.Padding</span><span class="cls_4">></span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:111px;top:439px;width:492px;height:295px;z-index:0;"><img src="images\image100.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image101.png" width="708" height="864" alt=""></div><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">171</span></div><div style="position:absolute;left:133px;top:71px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ScrollView</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:84px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">Padding</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">6, 0</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:98px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">local:ColorView </span><span class="cls_14">ColorName</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Aqua</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:111px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">local:ColorView </span><span class="cls_14">ColorName</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Black</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:124px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">local:ColorView </span><span class="cls_14">ColorName</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Blue</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:138px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">local:ColorView </span><span class="cls_14">ColorName</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Fuchsia</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:151px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">local:ColorView </span><span class="cls_14">ColorName</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Gray</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:164px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">local:ColorView </span><span class="cls_14">ColorName</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Green</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:178px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">local:ColorView </span><span class="cls_14">ColorName</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Lime</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:191px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">local:ColorView </span><span class="cls_14">ColorName</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Maroon</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:204px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">local:ColorView </span><span class="cls_14">ColorName</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Navy</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:218px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">local:ColorView </span><span class="cls_14">ColorName</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Olive</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:231px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">local:ColorView </span><span class="cls_14">ColorName</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Purple</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:244px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">local:ColorView </span><span class="cls_14">ColorName</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Pink</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:258px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">local:ColorView </span><span class="cls_14">ColorName</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Red</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:271px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">local:ColorView </span><span class="cls_14">ColorName</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Silver</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:284px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">local:ColorView </span><span class="cls_14">ColorName</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Teal</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:298px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">local:ColorView </span><span class="cls_14">ColorName</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">White</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:311px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">local:ColorView </span><span class="cls_14">ColorName</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Yellow</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:156px;top:324px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:338px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ScrollView</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:351px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:376px;white-space:pre;"><span class="cls_0">This is not quite as odious as the earlier example seemed to suggest, and it demonstrates how you can</span></div><div style="position:absolute;left:111px;top:394px;white-space:pre;"><span class="cls_0">encapsulate visuals in their own XAML-based classes. Notice that the </span><span class="cls_5">StackLayout</span><span class="cls_0">is the child of a</span></div><div style="position:absolute;left:111px;top:411px;white-space:pre;"><span class="cls_5">ScrollView</span><span class="cls_0">, so the list can be scrolled:</span></div><div style="position:absolute;left:111px;top:742px;white-space:pre;"><span class="cls_0">However, there is one aspect of the </span><span class="cls_13">ColorViewList</span><span class="cls_0"> </span><span class="cls_0">project that does not qualify as a “best practice.” It</span></div><div style="position:absolute;left:111px;top:759px;white-space:pre;"><span class="cls_0">is the definition of the </span><span class="cls_5">ColorName</span><span class="cls_0">property in </span><span class="cls_5">ColorView</span><span class="cls_0">. This should really be implemented as a</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image102.png" width="708" height="864" alt=""></div><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">172</span></div><div style="position:absolute;left:87px;top:72px;white-space:pre;"><span class="cls_5">BindableProperty</span><span class="cls_0">object. Delving into bindable objects and bindable properties is a high priority</span></div><div style="position:absolute;left:87px;top:90px;white-space:pre;"><span class="cls_0">and will be explored in Chapter 11, “The bindable infrastructure.”</span></div><div style="position:absolute;left:55px;top:129px;white-space:pre;"><span class="cls_11">Events</span><span class="cls_12"> </span><span class="cls_11">and</span><span class="cls_12"> </span><span class="cls_11">handlers</span></div><div style="position:absolute;left:87px;top:178px;white-space:pre;"><span class="cls_0">When you tap a Xamarin.Forms </span><span class="cls_5">Button</span><span class="cls_0">, it fires a </span><span class="cls_5">Clicked</span><span class="cls_0">event. You can instantiate a </span><span class="cls_5">Button</span><span class="cls_0">in</span></div><div style="position:absolute;left:87px;top:195px;white-space:pre;"><span class="cls_0">XAML, but the </span><span class="cls_5">Clicked</span><span class="cls_0">event handler itself must reside in the code-behind file. The </span><span class="cls_5">Button</span><span class="cls_0">is only</span></div><div style="position:absolute;left:87px;top:212px;white-space:pre;"><span class="cls_0">one of a bunch of views that exist primarily to generate events, so the process of handling events is</span></div><div style="position:absolute;left:87px;top:230px;white-space:pre;"><span class="cls_0">crucial to coordinating XAML and code files.</span></div><div style="position:absolute;left:103px;top:256px;white-space:pre;"><span class="cls_0">Attaching an event handler to an event in XAML is as simple as setting a property; it is, in fact, visu-</span></div><div style="position:absolute;left:87px;top:274px;white-space:pre;"><span class="cls_0">ally indistinguishable from a property setting. The </span><span class="cls_13">XamlKeypad</span><span class="cls_0"> </span><span class="cls_0">project is a XAML version of the </span><span class="cls_13">Per-</span></div><div style="position:absolute;left:87px;top:291px;white-space:pre;"><span class="cls_13">sistentKeypad</span><span class="cls_0"> </span><span class="cls_0">project from Chapter 6. It illustrates setting event handlers in XAML and handling these</span></div><div style="position:absolute;left:87px;top:308px;white-space:pre;"><span class="cls_0">events in the code-behind file. It also includes logic to save keypad entries when the program is termi-</span></div><div style="position:absolute;left:87px;top:326px;white-space:pre;"><span class="cls_0">nated.</span></div><div style="position:absolute;left:103px;top:352px;white-space:pre;"><span class="cls_0">If you take a look back at the constructor code of the </span><span class="cls_5">SimplestKeypadPage</span><span class="cls_0">or </span><span class="cls_5">PersistentKey-</span></div><div style="position:absolute;left:87px;top:370px;white-space:pre;"><span class="cls_5">padPage</span><span class="cls_0">classes, you’ll see a couple of loops to create the buttons that make up the numeric part of</span></div><div style="position:absolute;left:87px;top:387px;white-space:pre;"><span class="cls_0">the keypad. Of course, this is precisely the type of thing you can’t do in XAML, but look at how much</span></div><div style="position:absolute;left:87px;top:404px;white-space:pre;"><span class="cls_0">cleaner the markup in </span><span class="cls_5">XamlKeypadPage</span><span class="cls_0">is when compared with that code:</span></div><div style="position:absolute;left:87px;top:430px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:443px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:456px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">XamlKeypad.XamlKeypadPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:483px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:182px;top:496px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:523px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">displayLabel</span><span class="cls_1">"</span></div><div style="position:absolute;left:171px;top:536px;white-space:pre;"><span class="cls_14">Font</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:171px;top:550px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:171px;top:563px;white-space:pre;"><span class="cls_14">HorizontalTextAlignment</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">End</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:132px;top:590px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">backspaceButton</span><span class="cls_1">"</span></div><div style="position:absolute;left:177px;top:603px;white-space:pre;"><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_14">&#x21E6;</span><span class="cls_1">"</span></div><div style="position:absolute;left:177px;top:616px;white-space:pre;"><span class="cls_14">Font</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:177px;top:630px;white-space:pre;"><span class="cls_14">IsEnabled</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">False</span><span class="cls_1">"</span></div><div style="position:absolute;left:177px;top:643px;white-space:pre;"><span class="cls_14">Clicked</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">OnBackspaceButtonClicked</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:132px;top:670px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">Orientation</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Horizontal</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:683px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">7</span><span class="cls_1">" </span><span class="cls_14">StyleId</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">7</span><span class="cls_1">" </span><span class="cls_14">Font</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:199px;top:696px;white-space:pre;"><span class="cls_14">Clicked</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">OnDigitButtonClicked</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:154px;top:710px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">8</span><span class="cls_1">" </span><span class="cls_14">StyleId</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">8</span><span class="cls_1">" </span><span class="cls_14">Font</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:199px;top:723px;white-space:pre;"><span class="cls_14">Clicked</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">OnDigitButtonClicked</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:154px;top:736px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">9</span><span class="cls_1">" </span><span class="cls_14">StyleId</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">9</span><span class="cls_1">" </span><span class="cls_14">Font</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:199px;top:750px;white-space:pre;"><span class="cls_14">Clicked</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">OnDigitButtonClicked</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:132px;top:763px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">173</span></div><div style="position:absolute;left:156px;top:71px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">Orientation</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Horizontal</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:84px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">4</span><span class="cls_1">" </span><span class="cls_14">StyleId</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">4</span><span class="cls_1">" </span><span class="cls_14">Font</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:223px;top:98px;white-space:pre;"><span class="cls_14">Clicked</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">OnDigitButtonClicked</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:111px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">5</span><span class="cls_1">" </span><span class="cls_14">StyleId</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">5</span><span class="cls_1">" </span><span class="cls_14">Font</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:223px;top:124px;white-space:pre;"><span class="cls_14">Clicked</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">OnDigitButtonClicked</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:138px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">6</span><span class="cls_1">" </span><span class="cls_14">StyleId</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">6</span><span class="cls_1">" </span><span class="cls_14">Font</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:223px;top:151px;white-space:pre;"><span class="cls_14">Clicked</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">OnDigitButtonClicked</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:156px;top:164px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:191px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">Orientation</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Horizontal</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:204px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">1</span><span class="cls_1">" </span><span class="cls_14">StyleId</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">1</span><span class="cls_1">" </span><span class="cls_14">Font</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:223px;top:218px;white-space:pre;"><span class="cls_14">Clicked</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">OnDigitButtonClicked</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:231px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">2</span><span class="cls_1">" </span><span class="cls_14">StyleId</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">2</span><span class="cls_1">" </span><span class="cls_14">Font</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:223px;top:244px;white-space:pre;"><span class="cls_14">Clicked</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">OnDigitButtonClicked</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:258px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">3</span><span class="cls_1">" </span><span class="cls_14">StyleId</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">3</span><span class="cls_1">" </span><span class="cls_14">Font</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:223px;top:271px;white-space:pre;"><span class="cls_14">Clicked</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">OnDigitButtonClicked</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:156px;top:284px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:311px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">0</span><span class="cls_1">" </span><span class="cls_14">StyleId</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">0</span><span class="cls_1">" </span><span class="cls_14">Font</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:201px;top:324px;white-space:pre;"><span class="cls_14">Clicked</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">OnDigitButtonClicked</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:133px;top:351px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:364px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:390px;white-space:pre;"><span class="cls_0">The file is a lot shorter than it would have been had the three properties on each numeric </span><span class="cls_5">Button</span></div><div style="position:absolute;left:111px;top:407px;white-space:pre;"><span class="cls_0">been formatted into three lines, but packing these all together makes the uniformity of the markup</span></div><div style="position:absolute;left:111px;top:424px;white-space:pre;"><span class="cls_0">very obvious and provides clarity rather than obscurity.</span></div><div style="position:absolute;left:127px;top:451px;white-space:pre;"><span class="cls_0">The big question is this: Which would you rather maintain and modify? The code in the </span><span class="cls_5">Simplest-</span></div><div style="position:absolute;left:111px;top:468px;white-space:pre;"><span class="cls_5">KeypadPage</span><span class="cls_0">or </span><span class="cls_5">PersistentKeypadPage</span><span class="cls_0">constructors or the markup in the </span><span class="cls_5">XamlKeypadPage</span><span class="cls_0">XAML</span></div><div style="position:absolute;left:111px;top:486px;white-space:pre;"><span class="cls_0">file?</span></div><div style="position:absolute;left:127px;top:512px;white-space:pre;"><span class="cls_0">Here’s the screenshot. You’ll see that these keys are now arranged in calculator order rather than</span></div><div style="position:absolute;left:111px;top:530px;white-space:pre;"><span class="cls_0">telephone order:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:87px;top:71px;width:492px;height:295px;z-index:0;"><img src="images\image103.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image104.png" width="708" height="864" alt=""></div><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">174</span></div><div style="position:absolute;left:103px;top:374px;white-space:pre;"><span class="cls_0">The backspace button has its </span><span class="cls_5">Clicked</span><span class="cls_0">event set to the </span><span class="cls_5">OnBackspaceButtonClicked</span><span class="cls_0">handler,</span></div><div style="position:absolute;left:87px;top:391px;white-space:pre;"><span class="cls_0">while the digit buttons share the </span><span class="cls_5">OnDigitButtonClicked</span><span class="cls_0">handler. As you’ll recall, the </span><span class="cls_5">StyleId</span><span class="cls_0">prop-</span></div><div style="position:absolute;left:87px;top:408px;white-space:pre;"><span class="cls_0">erty is often used to distinguish views sharing the same event handler, which means that the two event</span></div><div style="position:absolute;left:87px;top:426px;white-space:pre;"><span class="cls_0">handlers can be implemented in the code-behind file exactly the same as in the code-only program:</span></div><div style="position:absolute;left:87px;top:451px;white-space:pre;"><span class="cls_4">public partial class </span><span class="cls_2">XamlKeypadPage</span></div><div style="position:absolute;left:87px;top:464px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:478px;white-space:pre;"><span class="cls_2">App </span><span class="cls_1">app = </span><span class="cls_2">Application</span><span class="cls_1">.Current </span><span class="cls_4">as </span><span class="cls_2">App</span><span class="cls_1">;</span></div><div style="position:absolute;left:109px;top:504px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">XamlKeypadPage()</span></div><div style="position:absolute;left:109px;top:518px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:531px;white-space:pre;"><span class="cls_1">InitializeComponent();</span></div><div style="position:absolute;left:132px;top:558px;white-space:pre;"><span class="cls_1">displayLabel.Text = app.DisplayLabelText;</span></div><div style="position:absolute;left:132px;top:571px;white-space:pre;"><span class="cls_1">backspaceButton.IsEnabled = displayLabel.Text != </span><span class="cls_4">null </span><span class="cls_1">&&</span></div><div style="position:absolute;left:289px;top:584px;white-space:pre;"><span class="cls_1">displayLabel.Text.Length > 0;</span></div><div style="position:absolute;left:109px;top:598px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:624px;white-space:pre;"><span class="cls_4">void </span><span class="cls_1">OnDigitButtonClicked(</span><span class="cls_4">object </span><span class="cls_1">sender, </span><span class="cls_2">EventArgs </span><span class="cls_1">args)</span></div><div style="position:absolute;left:109px;top:638px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:651px;white-space:pre;"><span class="cls_2">Button </span><span class="cls_1">button = (</span><span class="cls_2">Button</span><span class="cls_1">)sender;</span></div><div style="position:absolute;left:132px;top:664px;white-space:pre;"><span class="cls_1">displayLabel.Text += (</span><span class="cls_4">string</span><span class="cls_1">)button.StyleId;</span></div><div style="position:absolute;left:132px;top:678px;white-space:pre;"><span class="cls_1">backspaceButton.IsEnabled = </span><span class="cls_4">true</span><span class="cls_1">;</span></div><div style="position:absolute;left:132px;top:704px;white-space:pre;"><span class="cls_1">app.DisplayLabelText = displayLabel.Text;</span></div><div style="position:absolute;left:109px;top:718px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:744px;white-space:pre;"><span class="cls_4">void </span><span class="cls_1">OnBackspaceButtonClicked(</span><span class="cls_4">object </span><span class="cls_1">sender, </span><span class="cls_2">EventArgs </span><span class="cls_1">args)</span></div><div style="position:absolute;left:109px;top:758px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:771px;white-space:pre;"><span class="cls_4">string </span><span class="cls_1">text = displayLabel.Text;</span></div><div style="position:absolute;left:132px;top:784px;white-space:pre;"><span class="cls_1">displayLabel.Text = text.Substring(0, text.Length - 1);</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image105.png" width="708" height="864" alt=""></div><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">175</span></div><div style="position:absolute;left:156px;top:71px;white-space:pre;"><span class="cls_1">backspaceButton.IsEnabled = displayLabel.Text.Length > 0;</span></div><div style="position:absolute;left:156px;top:98px;white-space:pre;"><span class="cls_1">app.DisplayLabelText = displayLabel.Text;</span></div><div style="position:absolute;left:133px;top:111px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:124px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:150px;white-space:pre;"><span class="cls_0">Part of the job of the </span><span class="cls_5">LoadFromXaml</span><span class="cls_0">method called by </span><span class="cls_5">InitializeComponent</span><span class="cls_0">involves attaching</span></div><div style="position:absolute;left:111px;top:167px;white-space:pre;"><span class="cls_0">these event handlers to the objects instantiated from the XAML file.</span></div><div style="position:absolute;left:127px;top:194px;white-space:pre;"><span class="cls_0">The </span><span class="cls_13">XamlKeypad</span><span class="cls_0"> </span><span class="cls_0">project also includes the code that was added to the page and </span><span class="cls_5">App</span><span class="cls_0">classes in </span><span class="cls_13">Per-</span></div><div style="position:absolute;left:111px;top:211px;white-space:pre;"><span class="cls_13">sistentKeypad</span><span class="cls_0"> </span><span class="cls_0">to save the keypad text when the program is terminated. The </span><span class="cls_5">App</span><span class="cls_0">class in </span><span class="cls_13">XamlKeypad</span></div><div style="position:absolute;left:111px;top:228px;white-space:pre;"><span class="cls_0">is basically the same as the one in </span><span class="cls_13">PersistentKeypad</span><span class="cls_0">.</span></div><div style="position:absolute;left:79px;top:268px;white-space:pre;"><span class="cls_11">Tap</span><span class="cls_12"> </span><span class="cls_11">gestures</span></div><div style="position:absolute;left:111px;top:316px;white-space:pre;"><span class="cls_0">The Xamarin.Forms </span><span class="cls_5">Button</span><span class="cls_0">responds to finger taps, but you can actually get finger taps from any class</span></div><div style="position:absolute;left:111px;top:334px;white-space:pre;"><span class="cls_0">that derives from </span><span class="cls_5">View</span><span class="cls_0">, including </span><span class="cls_5">Label</span><span class="cls_0">, </span><span class="cls_5">BoxView</span><span class="cls_0">, and </span><span class="cls_5">Frame</span><span class="cls_0">. These tap events are not built into the</span></div><div style="position:absolute;left:111px;top:351px;white-space:pre;"><span class="cls_5">View</span><span class="cls_0">class, but the </span><span class="cls_5">View</span><span class="cls_0">class defines a property named </span><span class="cls_5">GestureRecognizers</span><span class="cls_0">. Taps are enabled by</span></div><div style="position:absolute;left:111px;top:368px;white-space:pre;"><span class="cls_0">adding an object to this </span><span class="cls_5">GestureRecognizers</span><span class="cls_0">collection. An instance of any class that derives from</span></div><div style="position:absolute;left:111px;top:386px;white-space:pre;"><span class="cls_5">GestureRecognizer</span><span class="cls_0">can be added to this collection, but undoubtedly the most useful is </span><span class="cls_5">TapGes-</span></div><div style="position:absolute;left:111px;top:403px;white-space:pre;"><span class="cls_5">tureRecognizer</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:430px;white-space:pre;"><span class="cls_0">Here’s how to add a </span><span class="cls_5">TapGestureRecognizer</span><span class="cls_0">to a </span><span class="cls_5">BoxView</span><span class="cls_0">in code:</span></div><div style="position:absolute;left:111px;top:455px;white-space:pre;"><span class="cls_2">BoxView </span><span class="cls_1">boxView = </span><span class="cls_4">new </span><span class="cls_2">BoxView</span></div><div style="position:absolute;left:111px;top:468px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:482px;white-space:pre;"><span class="cls_1">Color = </span><span class="cls_2">Color</span><span class="cls_1">.Blue</span></div><div style="position:absolute;left:111px;top:495px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:111px;top:508px;white-space:pre;"><span class="cls_2">TapGestureRecognizer </span><span class="cls_1">tapGesture = </span><span class="cls_4">new </span><span class="cls_2">TapGestureRecognizer</span><span class="cls_1">();</span></div><div style="position:absolute;left:111px;top:522px;white-space:pre;"><span class="cls_1">tapGesture.Tapped += OnBoxViewTapped;</span></div><div style="position:absolute;left:111px;top:535px;white-space:pre;"><span class="cls_1">boxView.GestureRecognizers.Add(tapGesture);</span></div><div style="position:absolute;left:111px;top:560px;white-space:pre;"><span class="cls_5">TapGestureRecognizer</span><span class="cls_0">also defines a </span><span class="cls_5">NumberOfTapsRequired</span><span class="cls_0">property with a default value of 1.</span></div><div style="position:absolute;left:111px;top:578px;white-space:pre;"><span class="cls_0">Set it to 2 to implement double taps.</span></div><div style="position:absolute;left:127px;top:604px;white-space:pre;"><span class="cls_0">To generate </span><span class="cls_5">Tapped</span><span class="cls_0">events, the </span><span class="cls_5">View</span><span class="cls_0">object must have its </span><span class="cls_5">IsEnabled</span><span class="cls_0">property set to </span><span class="cls_5">true</span><span class="cls_0">, its </span><span class="cls_5">Is-</span></div><div style="position:absolute;left:111px;top:622px;white-space:pre;"><span class="cls_5">Visible</span><span class="cls_0">property set to </span><span class="cls_5">true</span><span class="cls_0">(or it won’t be visible at all), and its </span><span class="cls_5">InputTransparent</span><span class="cls_0">property set to</span></div><div style="position:absolute;left:111px;top:639px;white-space:pre;"><span class="cls_5">false</span><span class="cls_0">. These are all default conditions.</span></div><div style="position:absolute;left:127px;top:666px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">Tapped</span><span class="cls_0">handler looks just like a </span><span class="cls_5">Clicked</span><span class="cls_0">handler for the </span><span class="cls_5">Button</span><span class="cls_0">:</span></div><div style="position:absolute;left:111px;top:691px;white-space:pre;"><span class="cls_4">void </span><span class="cls_1">OnBoxViewTapped(</span><span class="cls_4">object </span><span class="cls_1">sender, </span><span class="cls_2">EventArgs </span><span class="cls_1">args)</span></div><div style="position:absolute;left:111px;top:704px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:718px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:111px;top:731px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:756px;white-space:pre;"><span class="cls_0">As you know, the </span><span class="cls_5">sender</span><span class="cls_0">argument of an event handler is normally the object that fires the event,</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">176</span></div><div style="position:absolute;left:87px;top:72px;white-space:pre;"><span class="cls_0">which in this case would be the </span><span class="cls_5">TapGestureRecognizer</span><span class="cls_0">object. That would not be of much use. In-</span></div><div style="position:absolute;left:87px;top:90px;white-space:pre;"><span class="cls_0">stead, the </span><span class="cls_5">sender</span><span class="cls_0">argument to the </span><span class="cls_5">Tapped</span><span class="cls_0">handler is the view being tapped, in this case the </span><span class="cls_5">BoxView</span><span class="cls_0">.</span></div><div style="position:absolute;left:87px;top:107px;white-space:pre;"><span class="cls_0">That’s </span><span class="cls_9">much</span><span class="cls_0"> </span><span class="cls_0">more useful!</span></div><div style="position:absolute;left:103px;top:134px;white-space:pre;"><span class="cls_0">Like </span><span class="cls_5">Button</span><span class="cls_0">, </span><span class="cls_5">TapGestureRecognizer</span><span class="cls_0">also defines </span><span class="cls_5">Command</span><span class="cls_0">and </span><span class="cls_5">CommandParameter</span><span class="cls_0">properties;</span></div><div style="position:absolute;left:87px;top:151px;white-space:pre;"><span class="cls_0">these are used when implementing the MVVM design pattern, and they are discussed in a later chap-</span></div><div style="position:absolute;left:87px;top:168px;white-space:pre;"><span class="cls_0">ter.</span></div><div style="position:absolute;left:103px;top:195px;white-space:pre;"><span class="cls_5">TapGestureRecognizer</span><span class="cls_0">also defines properties named </span><span class="cls_5">TappedCallback</span><span class="cls_0">and </span><span class="cls_5">TappedCallback-</span></div><div style="position:absolute;left:87px;top:212px;white-space:pre;"><span class="cls_5">Parameter</span><span class="cls_0">and a constructor that includes a </span><span class="cls_5">TappedCallback</span><span class="cls_0">argument. These are all deprecated</span></div><div style="position:absolute;left:87px;top:230px;white-space:pre;"><span class="cls_0">and should not be used.</span></div><div style="position:absolute;left:103px;top:256px;white-space:pre;"><span class="cls_0">In XAML, you can attach a </span><span class="cls_5">TapGestureRecognizer</span><span class="cls_0">to a view by expressing the </span><span class="cls_5">GestureRecog-</span></div><div style="position:absolute;left:87px;top:274px;white-space:pre;"><span class="cls_5">nizers</span><span class="cls_0">collection as a property element:</span></div><div style="position:absolute;left:87px;top:299px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">Color</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Blue</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:312px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView.GestureRecognizers</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:326px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">TapGestureRecognizer </span><span class="cls_14">Tapped</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">OnBoxViewTapped</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:109px;top:339px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView.GestureRecognizers</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:352px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:378px;white-space:pre;"><span class="cls_0">As usual, the XAML is a little shorter than the equivalent code.</span></div><div style="position:absolute;left:103px;top:404px;white-space:pre;"><span class="cls_0">Let’s make a program that’s inspired by one of the first standalone computer g</span><span class="cls_0">ames.</span></div><div style="position:absolute;left:103px;top:431px;white-space:pre;"><span class="cls_0">The Xamarin.Forms version of this game is called </span><span class="cls_13">MonkeyTap</span><span class="cls_0"> </span><span class="cls_0">because it’s an imitation game. It</span></div><div style="position:absolute;left:87px;top:448px;white-space:pre;"><span class="cls_0">contains four </span><span class="cls_5">BoxView</span><span class="cls_0">elements, colored red, blue, yellow, and green. When the game begins, one of</span></div><div style="position:absolute;left:87px;top:466px;white-space:pre;"><span class="cls_0">the </span><span class="cls_5">BoxView</span><span class="cls_0">elements flashes, and you must then tap that </span><span class="cls_5">BoxView</span><span class="cls_0">. That </span><span class="cls_5">BoxView</span><span class="cls_0">flashes again fol-</span></div><div style="position:absolute;left:87px;top:483px;white-space:pre;"><span class="cls_0">lowed by another one, and now you must tap both in sequence. Then those two flashes are followed</span></div><div style="position:absolute;left:87px;top:500px;white-space:pre;"><span class="cls_0">by a third and so forth. (The original had sound as well, but </span><span class="cls_13">MonkeyTap</span><span class="cls_0"> </span><span class="cls_0">does not.) It’s a rather cruel</span></div><div style="position:absolute;left:87px;top:518px;white-space:pre;"><span class="cls_0">game because there is no way to win. The game just keeps on getting harder and harder until you lose.</span></div><div style="position:absolute;left:103px;top:544px;white-space:pre;"><span class="cls_0">The MonkeyTapPage.xaml file instantiates the four </span><span class="cls_5">BoxView</span><span class="cls_0">elements and a </span><span class="cls_5">Button</span><span class="cls_0">in the center</span></div><div style="position:absolute;left:87px;top:562px;white-space:pre;"><span class="cls_0">labeled “Begin”.</span></div><div style="position:absolute;left:87px;top:587px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:600px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:614px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">MonkeyTap.MonkeyTapPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:640px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage.Padding</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:654px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Thickness</span><span class="cls_1">"</span></div><div style="position:absolute;left:199px;top:667px;white-space:pre;"><span class="cls_14">iOS</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">0, 20, 0, 0</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:109px;top:680px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage.Padding</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:707px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:720px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">boxview0</span><span class="cls_1">"</span></div><div style="position:absolute;left:182px;top:734px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">FillAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:747px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView.GestureRecognizers</span><span class="cls_4">></span></div><div style="position:absolute;left:177px;top:760px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">TapGestureRecognizer </span><span class="cls_14">Tapped</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">OnBoxViewTapped</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:154px;top:774px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView.GestureRecognizers</span><span class="cls_4">></span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">177</span></div><div style="position:absolute;left:156px;top:71px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:98px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">boxview1</span><span class="cls_1">"</span></div><div style="position:absolute;left:206px;top:111px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">FillAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:124px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView.GestureRecognizers</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:138px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">TapGestureRecognizer </span><span class="cls_14">Tapped</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">OnBoxViewTapped</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:151px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView.GestureRecognizers</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:164px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:191px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">startGameButton</span><span class="cls_1">"</span></div><div style="position:absolute;left:201px;top:204px;white-space:pre;"><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Begin</span><span class="cls_1">"</span></div><div style="position:absolute;left:201px;top:218px;white-space:pre;"><span class="cls_14">Font</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:201px;top:231px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:201px;top:244px;white-space:pre;"><span class="cls_14">Clicked</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">OnStartGameButtonClicked</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:156px;top:271px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">boxview2</span><span class="cls_1">"</span></div><div style="position:absolute;left:206px;top:284px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">FillAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:298px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView.GestureRecognizers</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:311px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">TapGestureRecognizer </span><span class="cls_14">Tapped</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">OnBoxViewTapped</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:324px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView.GestureRecognizers</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:338px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:364px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">boxview3</span><span class="cls_1">"</span></div><div style="position:absolute;left:206px;top:378px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">FillAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:391px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">BoxView.GestureRecognizers</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:404px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">TapGestureRecognizer </span><span class="cls_14">Tapped</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">OnBoxViewTapped</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:418px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView.GestureRecognizers</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:431px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">BoxView</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:444px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:458px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:127px;top:483px;white-space:pre;"><span class="cls_0">All four </span><span class="cls_5">BoxView</span><span class="cls_0">elements here have a </span><span class="cls_5">TapGestureRecognizer</span><span class="cls_0">attached, but they aren’t yet as-</span></div><div style="position:absolute;left:111px;top:500px;white-space:pre;"><span class="cls_0">signed colors. That’s handled in the code</span><span class="cls_0">-behind file because the colors won</span><span class="cls_0">’t stay constant. The colors</span></div><div style="position:absolute;left:111px;top:518px;white-space:pre;"><span class="cls_0">need to be changed for the flashing effect.</span></div><div style="position:absolute;left:127px;top:544px;white-space:pre;"><span class="cls_0">The code-</span><span class="cls_0">behind file begins with some constants and variable fields. (You’ll notice that one of them</span></div><div style="position:absolute;left:111px;top:562px;white-space:pre;"><span class="cls_0">is flagged as protected; in the next chapter, a class will derive from this one and require access to this</span></div><div style="position:absolute;left:111px;top:579px;white-space:pre;"><span class="cls_0">field. Some methods are defined as protected as well.)</span></div><div style="position:absolute;left:111px;top:604px;white-space:pre;"><span class="cls_4">public partial class </span><span class="cls_2">MonkeyTapPage</span></div><div style="position:absolute;left:111px;top:618px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:631px;white-space:pre;"><span class="cls_4">const int </span><span class="cls_1">sequenceTime = 750;</span></div><div style="position:absolute;left:336px;top:631px;white-space:pre;"><span class="cls_3">// in msec</span></div><div style="position:absolute;left:133px;top:644px;white-space:pre;"><span class="cls_4">protected const int </span><span class="cls_1">flashDuration = 250;</span></div><div style="position:absolute;left:133px;top:671px;white-space:pre;"><span class="cls_4">const double </span><span class="cls_1">offLuminosity = 0.4;</span></div><div style="position:absolute;left:336px;top:671px;white-space:pre;"><span class="cls_3">// somewhat dimmer</span></div><div style="position:absolute;left:133px;top:684px;white-space:pre;"><span class="cls_4">const double </span><span class="cls_1">onLuminosity = 0.75;</span></div><div style="position:absolute;left:336px;top:684px;white-space:pre;"><span class="cls_3">// much brighter</span></div><div style="position:absolute;left:133px;top:711px;white-space:pre;"><span class="cls_2">BoxView</span><span class="cls_1">[] boxViews;</span></div><div style="position:absolute;left:133px;top:724px;white-space:pre;"><span class="cls_2">Color</span><span class="cls_1">[] colors = { </span><span class="cls_2">Color</span><span class="cls_1">.Red, </span><span class="cls_2">Color</span><span class="cls_1">.Blue, </span><span class="cls_2">Color</span><span class="cls_1">.Yellow, </span><span class="cls_2">Color</span><span class="cls_1">.Green };</span></div><div style="position:absolute;left:133px;top:738px;white-space:pre;"><span class="cls_2">List</span><span class="cls_1"><</span><span class="cls_4">int</span><span class="cls_1">> sequence = </span><span class="cls_4">new </span><span class="cls_2">List</span><span class="cls_1"><</span><span class="cls_4">int</span><span class="cls_1">>();</span></div><div style="position:absolute;left:133px;top:751px;white-space:pre;"><span class="cls_4">int </span><span class="cls_1">sequenceIndex;</span></div><div style="position:absolute;left:133px;top:764px;white-space:pre;"><span class="cls_4">bool </span><span class="cls_1">awaitingTaps;</span></div><div style="position:absolute;left:133px;top:778px;white-space:pre;"><span class="cls_4">bool </span><span class="cls_1">gameEnded;</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">178</span></div><div style="position:absolute;left:109px;top:71px;white-space:pre;"><span class="cls_2">Random </span><span class="cls_1">random = </span><span class="cls_4">new </span><span class="cls_2">Random</span><span class="cls_1">();</span></div><div style="position:absolute;left:109px;top:98px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">MonkeyTapPage()</span></div><div style="position:absolute;left:109px;top:111px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:124px;white-space:pre;"><span class="cls_1">InitializeComponent();</span></div><div style="position:absolute;left:132px;top:138px;white-space:pre;"><span class="cls_1">boxViews = </span><span class="cls_4">new </span><span class="cls_2">BoxView</span><span class="cls_1">[] { boxview0, boxview1, boxview2, boxview3 };</span></div><div style="position:absolute;left:132px;top:151px;white-space:pre;"><span class="cls_1">InitializeBoxViewColors();</span></div><div style="position:absolute;left:109px;top:164px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:191px;white-space:pre;"><span class="cls_4">void </span><span class="cls_1">InitializeBoxViewColors()</span></div><div style="position:absolute;left:109px;top:204px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:218px;white-space:pre;"><span class="cls_4">for </span><span class="cls_1">(</span><span class="cls_4">int </span><span class="cls_1">index = 0; index < 4; index++)</span></div><div style="position:absolute;left:154px;top:231px;white-space:pre;"><span class="cls_1">boxViews[index].Color = colors[index].WithLuminosity(offLuminosity);</span></div><div style="position:absolute;left:109px;top:244px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:258px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:87px;top:271px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:296px;white-space:pre;"><span class="cls_0">The constructor puts all four </span><span class="cls_5">BoxView</span><span class="cls_0">elements in an array; this allows them to be referenced by a sim-</span></div><div style="position:absolute;left:87px;top:314px;white-space:pre;"><span class="cls_0">ple index that has values of 0, 1, 2, and 3. The </span><span class="cls_5">InitializeBoxViewColors</span><span class="cls_0">method sets all the </span><span class="cls_5">Box-</span></div><div style="position:absolute;left:87px;top:331px;white-space:pre;"><span class="cls_5">View</span><span class="cls_0">elements to their slightly dimmed nonflashed state.</span></div><div style="position:absolute;left:103px;top:358px;white-space:pre;"><span class="cls_0">The program is now waiting for the user to press the </span><span class="cls_13">Begin</span><span class="cls_0"> </span><span class="cls_0">button to start the first game. The same</span></div><div style="position:absolute;left:87px;top:375px;white-space:pre;"><span class="cls_5">Button</span><span class="cls_0">handles replays, so it includes a redundant initialization of the </span><span class="cls_5">BoxView</span><span class="cls_0">colors. The </span><span class="cls_5">Button</span></div><div style="position:absolute;left:87px;top:392px;white-space:pre;"><span class="cls_0">handler also prepares for building the sequence of flashed </span><span class="cls_5">BoxView</span><span class="cls_0">elements by clearing the </span><span class="cls_5">se-</span></div><div style="position:absolute;left:87px;top:410px;white-space:pre;"><span class="cls_5">quence</span><span class="cls_0">list and calling </span><span class="cls_5">StartSequence</span><span class="cls_0">:</span></div><div style="position:absolute;left:87px;top:435px;white-space:pre;"><span class="cls_4">public partial class </span><span class="cls_2">MonkeyTapPage</span></div><div style="position:absolute;left:87px;top:448px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:462px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:109px;top:475px;white-space:pre;"><span class="cls_4">protected void </span><span class="cls_1">OnStartGameButtonClicked(</span><span class="cls_4">object </span><span class="cls_1">sender, </span><span class="cls_2">EventArgs </span><span class="cls_1">args)</span></div><div style="position:absolute;left:109px;top:488px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:502px;white-space:pre;"><span class="cls_1">gameEnded = </span><span class="cls_4">false</span><span class="cls_1">;</span></div><div style="position:absolute;left:132px;top:515px;white-space:pre;"><span class="cls_1">startGameButton.IsVisible = </span><span class="cls_4">false</span><span class="cls_1">;</span></div><div style="position:absolute;left:132px;top:528px;white-space:pre;"><span class="cls_1">InitializeBoxViewColors();</span></div><div style="position:absolute;left:132px;top:542px;white-space:pre;"><span class="cls_1">sequence.Clear();</span></div><div style="position:absolute;left:132px;top:555px;white-space:pre;"><span class="cls_1">StartSequence();</span></div><div style="position:absolute;left:109px;top:568px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:595px;white-space:pre;"><span class="cls_4">void </span><span class="cls_1">StartSequence()</span></div><div style="position:absolute;left:109px;top:608px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:622px;white-space:pre;"><span class="cls_1">sequence.Add(random.Next(4));</span></div><div style="position:absolute;left:132px;top:635px;white-space:pre;"><span class="cls_1">sequenceIndex = 0;</span></div><div style="position:absolute;left:132px;top:648px;white-space:pre;"><span class="cls_2">Device</span><span class="cls_1">.StartTimer(</span><span class="cls_2">TimeSpan</span><span class="cls_1">.FromMilliseconds(sequenceTime), OnTimerTick);</span></div><div style="position:absolute;left:109px;top:662px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:675px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:87px;top:688px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:714px;white-space:pre;"><span class="cls_5">StartSequence</span><span class="cls_0">adds a new random integer to the </span><span class="cls_5">sequence</span><span class="cls_0">list, initializes </span><span class="cls_5">sequenceIndex</span><span class="cls_0">to 0,</span></div><div style="position:absolute;left:87px;top:731px;white-space:pre;"><span class="cls_0">and starts the timer.</span></div><div style="position:absolute;left:103px;top:758px;white-space:pre;"><span class="cls_0">In the normal case, the timer tick handler is called for each index in the </span><span class="cls_5">sequence</span><span class="cls_0">list and causes</span></div><div style="position:absolute;left:87px;top:775px;white-space:pre;"><span class="cls_0">the corresponding </span><span class="cls_5">BoxView</span><span class="cls_0">to flash with a call to </span><span class="cls_5">FlashBoxView</span><span class="cls_0">. The timer handler returns </span><span class="cls_5">false</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">179</span></div><div style="position:absolute;left:111px;top:72px;white-space:pre;"><span class="cls_0">when the sequence is at an end, also indicating by setting </span><span class="cls_5">awaitingTaps</span><span class="cls_0">that it’s time for the user to</span></div><div style="position:absolute;left:111px;top:90px;white-space:pre;"><span class="cls_0">imitate the sequence:</span></div><div style="position:absolute;left:111px;top:115px;white-space:pre;"><span class="cls_4">public partial class </span><span class="cls_2">MonkeyTapPage</span></div><div style="position:absolute;left:111px;top:128px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:142px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:133px;top:155px;white-space:pre;"><span class="cls_4">bool </span><span class="cls_1">OnTimerTick()</span></div><div style="position:absolute;left:133px;top:168px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:182px;white-space:pre;"><span class="cls_4">if </span><span class="cls_1">(gameEnded)</span></div><div style="position:absolute;left:178px;top:195px;white-space:pre;"><span class="cls_4">return false</span><span class="cls_1">;</span></div><div style="position:absolute;left:156px;top:222px;white-space:pre;"><span class="cls_1">FlashBoxView(sequence[sequenceIndex]);</span></div><div style="position:absolute;left:156px;top:235px;white-space:pre;"><span class="cls_1">sequenceIndex++;</span></div><div style="position:absolute;left:156px;top:248px;white-space:pre;"><span class="cls_1">awaitingTaps = sequenceIndex == sequence.Count;</span></div><div style="position:absolute;left:156px;top:262px;white-space:pre;"><span class="cls_1">sequenceIndex = awaitingTaps ? 0 : sequenceIndex;</span></div><div style="position:absolute;left:156px;top:275px;white-space:pre;"><span class="cls_4">return </span><span class="cls_1">!awaitingTaps;</span></div><div style="position:absolute;left:133px;top:288px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:133px;top:315px;white-space:pre;"><span class="cls_4">protected virtual void </span><span class="cls_1">FlashBoxView(</span><span class="cls_4">int </span><span class="cls_1">index)</span></div><div style="position:absolute;left:133px;top:328px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:342px;white-space:pre;"><span class="cls_1">boxViews[index].Color = colors[index].WithLuminosity(onLuminosity);</span></div><div style="position:absolute;left:156px;top:355px;white-space:pre;"><span class="cls_2">Device</span><span class="cls_1">.StartTimer(</span><span class="cls_2">TimeSpan</span><span class="cls_1">.FromMilliseconds(flashDuration), () =></span></div><div style="position:absolute;left:178px;top:368px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:201px;top:382px;white-space:pre;"><span class="cls_4">if </span><span class="cls_1">(gameEnded)</span></div><div style="position:absolute;left:223px;top:395px;white-space:pre;"><span class="cls_4">return false</span><span class="cls_1">;</span></div><div style="position:absolute;left:201px;top:422px;white-space:pre;"><span class="cls_1">boxViews[index].Color = colors[index].WithLuminosity(offLuminosity);</span></div><div style="position:absolute;left:201px;top:435px;white-space:pre;"><span class="cls_4">return false</span><span class="cls_1">;</span></div><div style="position:absolute;left:178px;top:448px;white-space:pre;"><span class="cls_1">});</span></div><div style="position:absolute;left:133px;top:462px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:133px;top:475px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:111px;top:488px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:514px;white-space:pre;"><span class="cls_0">The flash is just a quarter second in duration. The </span><span class="cls_5">FlashBoxView</span><span class="cls_0">method first sets the luminosity for</span></div><div style="position:absolute;left:111px;top:531px;white-space:pre;"><span class="cls_0">a b</span><span class="cls_0">right color and creates a “one</span><span class="cls_0">-</span><span class="cls_0">shot” timer, so called because the timer callback method (here</span></div><div style="position:absolute;left:111px;top:548px;white-space:pre;"><span class="cls_0">expressed as a lambda function) returns </span><span class="cls_5">false</span><span class="cls_0">and shuts off the timer after restoring the color’s</span></div><div style="position:absolute;left:111px;top:566px;white-space:pre;"><span class="cls_0">luminosity.</span></div><div style="position:absolute;left:127px;top:592px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">Tapped</span><span class="cls_0">handler for the </span><span class="cls_5">BoxView</span><span class="cls_0">elements ignores the tap if the game is already over (which</span></div><div style="position:absolute;left:111px;top:610px;white-space:pre;"><span class="cls_0">only happens with a mistake by the user), and ends the game if the user taps prematurely without</span></div><div style="position:absolute;left:111px;top:627px;white-space:pre;"><span class="cls_0">waiting for the program to go through the sequence. Otherwise, it just compares the tapped </span><span class="cls_5">BoxView</span></div><div style="position:absolute;left:111px;top:644px;white-space:pre;"><span class="cls_0">with the next one in the sequence, flashes that </span><span class="cls_5">BoxView</span><span class="cls_0">if correct, or ends the game if not:</span></div><div style="position:absolute;left:111px;top:670px;white-space:pre;"><span class="cls_4">public partial class </span><span class="cls_2">MonkeyTapPage</span></div><div style="position:absolute;left:111px;top:683px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:696px;white-space:pre;"><span class="cls_1">…</span></div><div style="position:absolute;left:133px;top:710px;white-space:pre;"><span class="cls_4">protected void </span><span class="cls_1">OnBoxViewTapped(</span><span class="cls_4">object </span><span class="cls_1">sender, </span><span class="cls_2">EventArgs </span><span class="cls_1">args)</span></div><div style="position:absolute;left:133px;top:723px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:736px;white-space:pre;"><span class="cls_4">if </span><span class="cls_1">(gameEnded)</span></div><div style="position:absolute;left:178px;top:750px;white-space:pre;"><span class="cls_4">return</span><span class="cls_1">;</span></div><div style="position:absolute;left:156px;top:776px;white-space:pre;"><span class="cls_4">if </span><span class="cls_1">(!awaitingTaps)</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">180</span></div><div style="position:absolute;left:132px;top:71px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:84px;white-space:pre;"><span class="cls_1">EndGame();</span></div><div style="position:absolute;left:154px;top:98px;white-space:pre;"><span class="cls_4">return</span><span class="cls_1">;</span></div><div style="position:absolute;left:132px;top:111px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:132px;top:138px;white-space:pre;"><span class="cls_2">BoxView </span><span class="cls_1">tappedBoxView = (</span><span class="cls_2">BoxView</span><span class="cls_1">)sender;</span></div><div style="position:absolute;left:132px;top:151px;white-space:pre;"><span class="cls_4">int </span><span class="cls_1">index = </span><span class="cls_2">Array</span><span class="cls_1">.IndexOf(boxViews, tappedBoxView);</span></div><div style="position:absolute;left:132px;top:178px;white-space:pre;"><span class="cls_4">if </span><span class="cls_1">(index != sequence[sequenceIndex])</span></div><div style="position:absolute;left:132px;top:191px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:204px;white-space:pre;"><span class="cls_1">EndGame();</span></div><div style="position:absolute;left:154px;top:218px;white-space:pre;"><span class="cls_4">return</span><span class="cls_1">;</span></div><div style="position:absolute;left:132px;top:231px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:132px;top:258px;white-space:pre;"><span class="cls_1">FlashBoxView(index);</span></div><div style="position:absolute;left:132px;top:284px;white-space:pre;"><span class="cls_1">sequenceIndex++;</span></div><div style="position:absolute;left:132px;top:298px;white-space:pre;"><span class="cls_1">awaitingTaps = sequenceIndex < sequence.Count;</span></div><div style="position:absolute;left:132px;top:324px;white-space:pre;"><span class="cls_4">if </span><span class="cls_1">(!awaitingTaps)</span></div><div style="position:absolute;left:154px;top:338px;white-space:pre;"><span class="cls_1">StartSequence();</span></div><div style="position:absolute;left:109px;top:351px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:378px;white-space:pre;"><span class="cls_4">protected virtual void </span><span class="cls_1">EndGame()</span></div><div style="position:absolute;left:109px;top:391px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:404px;white-space:pre;"><span class="cls_1">gameEnded = </span><span class="cls_4">true</span><span class="cls_1">;</span></div><div style="position:absolute;left:132px;top:431px;white-space:pre;"><span class="cls_4">for </span><span class="cls_1">(</span><span class="cls_4">int </span><span class="cls_1">index = 0; index < 4; index++)</span></div><div style="position:absolute;left:154px;top:444px;white-space:pre;"><span class="cls_1">boxViews[index].Color = </span><span class="cls_2">Color</span><span class="cls_1">.Gray;</span></div><div style="position:absolute;left:132px;top:471px;white-space:pre;"><span class="cls_1">startGameButton.Text = </span><span class="cls_6">"Try again?"</span><span class="cls_1">;</span></div><div style="position:absolute;left:132px;top:484px;white-space:pre;"><span class="cls_1">startGameButton.IsVisible = </span><span class="cls_4">true</span><span class="cls_1">;</span></div><div style="position:absolute;left:109px;top:498px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:511px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:536px;white-space:pre;"><span class="cls_0">If the user manages to “ape” the sequen</span><span class="cls_0">ce all the way through, another call to </span><span class="cls_5">StartSequence</span><span class="cls_0">adds a</span></div><div style="position:absolute;left:87px;top:554px;white-space:pre;"><span class="cls_0">new index to the </span><span class="cls_5">sequence</span><span class="cls_0">list and starts playing that new one. Eventually, though, there will be a call</span></div><div style="position:absolute;left:87px;top:571px;white-space:pre;"><span class="cls_0">to </span><span class="cls_5">EndGame</span><span class="cls_0">, which colors all the boxes gray to emphasize the end, and reenables the </span><span class="cls_5">Button</span><span class="cls_0">for a</span></div><div style="position:absolute;left:87px;top:588px;white-space:pre;"><span class="cls_0">chance to try it again.</span></div><div style="position:absolute;left:103px;top:615px;white-space:pre;"><span class="cls_0">Here’s the program after the </span><span class="cls_5">Button</span><span class="cls_0">has been clicked and hidden:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:111px;top:71px;width:492px;height:295px;z-index:0;"><img src="images\image106.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image107.png" width="708" height="864" alt=""></div><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 8</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Code and XAML in harmony</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">181</span></div><div style="position:absolute;left:127px;top:374px;white-space:pre;"><span class="cls_0">I know, I know. The game is a real drag without sound.</span></div><div style="position:absolute;left:127px;top:400px;white-space:pre;"><span class="cls_0">Let’s take the opportunity in the next chapter to fix that.</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image108.png" width="708" height="864" alt=""></div><div style="position:absolute;left:55px;top:74px;white-space:pre;"><span class="cls_7">Chapter 9</span></div><div style="position:absolute;left:55px;top:94px;white-space:pre;"><span class="cls_8">Platform-specific</span></div><div style="position:absolute;left:331px;top:94px;white-space:pre;"><span class="cls_8">API</span></div><div style="position:absolute;left:394px;top:94px;white-space:pre;"><span class="cls_8">calls</span></div><div style="position:absolute;left:87px;top:168px;white-space:pre;"><span class="cls_0">An emergency has arisen. Anyone playing with the </span><span class="cls_13">MonkeyTap</span><span class="cls_0"> </span><span class="cls_0">game from the previous chapter will</span></div><div style="position:absolute;left:87px;top:186px;white-space:pre;"><span class="cls_0">quickly come to the conclusion that it desperately needs a very basic enhancement, and it simply can-</span></div><div style="position:absolute;left:87px;top:203px;white-space:pre;"><span class="cls_0">not be allowed to exist without it.</span></div><div style="position:absolute;left:103px;top:230px;white-space:pre;"><span class="cls_13">MonkeyTap</span><span class="cls_0"> </span><span class="cls_0">needs sound.</span></div><div style="position:absolute;left:103px;top:256px;white-space:pre;"><span class="cls_0">It do</span><span class="cls_0">esn’t need very sophisticated sound—</span><span class="cls_0">just little beeps to accompany the flashes of the four</span></div><div style="position:absolute;left:87px;top:274px;white-space:pre;"><span class="cls_5">BoxView</span><span class="cls_0">elements. But the Xamarin.Forms API doesn’t support sound, so sound is not something we</span></div><div style="position:absolute;left:87px;top:291px;white-space:pre;"><span class="cls_0">can add to </span><span class="cls_13">MonkeyTap</span><span class="cls_0"> </span><span class="cls_0">with just a couple of API calls. Supporting sound requires going somewhat be-</span></div><div style="position:absolute;left:87px;top:308px;white-space:pre;"><span class="cls_0">yond Xamarin.Forms to make use of platform-specific sound-generation facilities. Figuring out how to</span></div><div style="position:absolute;left:87px;top:326px;white-space:pre;"><span class="cls_0">make sounds in iOS, Android, and Windows Phone is hard enough. But how does a Xamarin.Forms</span></div><div style="position:absolute;left:87px;top:343px;white-space:pre;"><span class="cls_0">program then make calls into the individual platforms?</span></div><div style="position:absolute;left:103px;top:370px;white-space:pre;"><span class="cls_0">Before tackling the complexities of sound, let’s examine the different approaches to making plat-</span></div><div style="position:absolute;left:87px;top:387px;white-space:pre;"><span class="cls_0">form-specific API calls with a much simpler example. The first three short programs shown in this chap-</span></div><div style="position:absolute;left:87px;top:404px;white-space:pre;"><span class="cls_0">ter are all functionally identical: They all display two tiny items of information supplied by the underly-</span></div><div style="position:absolute;left:87px;top:422px;white-space:pre;"><span class="cls_0">ing platform’s operating system that reveal the model of the device running the program and the op-</span></div><div style="position:absolute;left:87px;top:439px;white-space:pre;"><span class="cls_0">erating system version.</span></div><div style="position:absolute;left:55px;top:479px;white-space:pre;"><span class="cls_11">Preprocessing</span><span class="cls_12"> </span><span class="cls_11">in</span><span class="cls_12"> </span><span class="cls_11">the</span><span class="cls_12"> </span><span class="cls_11">Shared</span><span class="cls_12"> </span><span class="cls_11">Asset</span><span class="cls_12"> </span><span class="cls_11">Project</span></div><div style="position:absolute;left:87px;top:527px;white-space:pre;"><span class="cls_0">As you learned in Chapt</span><span class="cls_0">er 2, “Anatomy of an app,” you can use either a Shared Asset Project (SAP) or a</span></div><div style="position:absolute;left:87px;top:544px;white-space:pre;"><span class="cls_0">Portable Class Library (PCL) for the code that is common to all three platforms. An SAP contains code</span></div><div style="position:absolute;left:87px;top:562px;white-space:pre;"><span class="cls_0">files that are shared among the platform projects, while a PCL encloses the common code in a library</span></div><div style="position:absolute;left:87px;top:579px;white-space:pre;"><span class="cls_0">that is accessible only through public types.</span></div><div style="position:absolute;left:103px;top:606px;white-space:pre;"><span class="cls_0">Accessing platform APIs from a Shared Asset Project is a little more straightforward than from a</span></div><div style="position:absolute;left:87px;top:623px;white-space:pre;"><span class="cls_0">Portable Class Library because it involves more traditional programming tools, so let’</span><span class="cls_0">s try that ap-</span></div><div style="position:absolute;left:87px;top:641px;white-space:pre;"><span class="cls_0">proach first. You can create a Xamarin.Forms solution with an SAP using the process described in</span></div><div style="position:absolute;left:87px;top:658px;white-space:pre;"><span class="cls_0">Chapter 2. You can then add a XAML-based </span><span class="cls_5">ContentPage</span><span class="cls_0">class to the SAP the same way you add one</span></div><div style="position:absolute;left:87px;top:675px;white-space:pre;"><span class="cls_0">to a PCL.</span></div><div style="position:absolute;left:103px;top:702px;white-space:pre;"><span class="cls_0">Here’s the XAML file for a project that </span><span class="cls_0">displays platform information, named </span><span class="cls_13">PlatInfoSap1</span><span class="cls_0">:</span></div><div style="position:absolute;left:87px;top:727px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:740px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:160px;top:754px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">PlatInfoSap1.PlatInfoSap1Page</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:780px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">Padding</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">20</span><span class="cls_1">"</span><span class="cls_4">></span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 9</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Platform-specific API calls</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">183</span></div><div style="position:absolute;left:156px;top:71px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:84px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Device Model:</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:111px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentView </span><span class="cls_14">Padding</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">50, 0, 0, 0</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:124px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">modelLabel</span><span class="cls_1">"</span></div><div style="position:absolute;left:240px;top:138px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:240px;top:151px;white-space:pre;"><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Bold</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:164px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentView</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:178px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:204px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:218px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Operating System Version:</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:244px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentView </span><span class="cls_14">Padding</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">50, 0, 0, 0</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:258px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">x:Name</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">versionLabel</span><span class="cls_1">"</span></div><div style="position:absolute;left:240px;top:271px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span></div><div style="position:absolute;left:240px;top:284px;white-space:pre;"><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Bold</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:298px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentView</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:311px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:324px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:338px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:363px;white-space:pre;"><span class="cls_0">The code-behind file must set the </span><span class="cls_5">Text</span><span class="cls_0">properties for </span><span class="cls_5">modelLabel</span><span class="cls_0">and </span><span class="cls_5">versionLabel</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:390px;white-space:pre;"><span class="cls_0">Code files in a Shared Asset Project are extensions of the code in the individual platforms. This</span></div><div style="position:absolute;left:111px;top:407px;white-space:pre;"><span class="cls_0">means that code in the SAP can make use of the C# preprocessor directives </span><span class="cls_5">#if</span><span class="cls_0">, </span><span class="cls_5">#elif</span><span class="cls_0">, </span><span class="cls_5">#else</span><span class="cls_0">, and</span></div><div style="position:absolute;left:111px;top:424px;white-space:pre;"><span class="cls_5">#endif</span><span class="cls_0">with conditional-compilation symbols defined for the three platforms, as demonstrated in</span></div><div style="position:absolute;left:111px;top:442px;white-space:pre;"><span class="cls_0">Chapters 2 and 4. These symbols are:</span></div><div style="position:absolute;left:125px;top:467px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:468px;white-space:pre;"><span class="cls_5">__IOS__</span><span class="cls_0">for iOS</span></div><div style="position:absolute;left:125px;top:494px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:495px;white-space:pre;"><span class="cls_5">__ANDROID__</span><span class="cls_0">for Android</span></div><div style="position:absolute;left:125px;top:521px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:522px;white-space:pre;"><span class="cls_5">WINDOWS_UWP</span><span class="cls_0">for the Universal Windows Platform</span></div><div style="position:absolute;left:125px;top:547px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:548px;white-space:pre;"><span class="cls_5">WINDOWS_APP </span><span class="cls_0">for Windows 8.1</span></div><div style="position:absolute;left:125px;top:574px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:575px;white-space:pre;"><span class="cls_5">WINDOWS_PHONE_APP</span><span class="cls_0">for Windows Phone 8.1</span></div><div style="position:absolute;left:127px;top:602px;white-space:pre;"><span class="cls_0">The APIs involved in obtaining the model and version information are, of course, different for the</span></div><div style="position:absolute;left:111px;top:619px;white-space:pre;"><span class="cls_0">three platforms:</span></div><div style="position:absolute;left:125px;top:645px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:646px;white-space:pre;"><span class="cls_0">For iOS, use the </span><span class="cls_5">UIDevice</span><span class="cls_0">class in the </span><span class="cls_5">UIKit</span><span class="cls_0">namespace.</span></div><div style="position:absolute;left:125px;top:671px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:672px;white-space:pre;"><span class="cls_0">For Android, use various properties of the </span><span class="cls_5">Build</span><span class="cls_0">class in the </span><span class="cls_5">Android.OS</span><span class="cls_0">namespace.</span></div><div style="position:absolute;left:125px;top:698px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:699px;white-space:pre;"><span class="cls_0">For the Windows platforms, use the </span><span class="cls_5">EasClientDeviceInformation</span><span class="cls_0">class in the </span><span class="cls_5">Win-</span></div><div style="position:absolute;left:149px;top:716px;white-space:pre;"><span class="cls_5">dows.Security.ExchangeActiveSyncProvisioning</span><span class="cls_0">namespace.</span></div><div style="position:absolute;left:127px;top:743px;white-space:pre;"><span class="cls_0">Here’s the PlatInfoSap1.xaml.cs code</span><span class="cls_0">-behind file showing how </span><span class="cls_5">modelLabel</span><span class="cls_0">and </span><span class="cls_5">versionLabel</span><span class="cls_0">are</span></div><div style="position:absolute;left:111px;top:760px;white-space:pre;"><span class="cls_0">set based on the conditional-compilation symbols:</span></div><div style="position:absolute;left:111px;top:786px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">System;</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 9</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Platform-specific API calls</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">184</span></div><div style="position:absolute;left:87px;top:71px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Xamarin.Forms;</span></div><div style="position:absolute;left:87px;top:98px;white-space:pre;"><span class="cls_4">#if </span><span class="cls_1">__IOS__</span></div><div style="position:absolute;left:87px;top:111px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">UIKit;</span></div><div style="position:absolute;left:87px;top:138px;white-space:pre;"><span class="cls_4">#elif </span><span class="cls_1">__ANDROID__</span></div><div style="position:absolute;left:87px;top:151px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Android.OS;</span></div><div style="position:absolute;left:87px;top:178px;white-space:pre;"><span class="cls_4">#elif </span><span class="cls_1">WINDOWS_APP || WINDOWS_PHONE_APP || WINDOWS_UWP</span></div><div style="position:absolute;left:87px;top:191px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Windows.Security.ExchangeActiveSyncProvisioning;</span></div><div style="position:absolute;left:87px;top:218px;white-space:pre;"><span class="cls_4">#endif</span></div><div style="position:absolute;left:87px;top:244px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">PlatInfoSap1</span></div><div style="position:absolute;left:87px;top:258px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:271px;white-space:pre;"><span class="cls_4">public partial class </span><span class="cls_2">PlatInfoSap1Page </span><span class="cls_1">: </span><span class="cls_2">ContentPage</span></div><div style="position:absolute;left:109px;top:284px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:298px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">PlatInfoSap1Page ()</span></div><div style="position:absolute;left:132px;top:311px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:324px;white-space:pre;"><span class="cls_1">InitializeComponent ();</span></div><div style="position:absolute;left:87px;top:351px;white-space:pre;"><span class="cls_4">#if </span><span class="cls_1">__IOS__</span></div><div style="position:absolute;left:154px;top:378px;white-space:pre;"><span class="cls_2">UIDevice </span><span class="cls_1">device = </span><span class="cls_4">new </span><span class="cls_2">UIDevice</span><span class="cls_1">();</span></div><div style="position:absolute;left:154px;top:391px;white-space:pre;"><span class="cls_1">modelLabel.Text = device.Model.ToString();</span></div><div style="position:absolute;left:154px;top:404px;white-space:pre;"><span class="cls_1">versionLabel.Text = </span><span class="cls_2">String</span><span class="cls_1">.Format(</span><span class="cls_6">"{0} {1}"</span><span class="cls_1">, device.SystemName,</span></div><div style="position:absolute;left:407px;top:418px;white-space:pre;"><span class="cls_1">device.SystemVersion);</span></div><div style="position:absolute;left:87px;top:444px;white-space:pre;"><span class="cls_4">#elif </span><span class="cls_1">__ANDROID__</span></div><div style="position:absolute;left:154px;top:471px;white-space:pre;"><span class="cls_1">modelLabel.Text = </span><span class="cls_2">String</span><span class="cls_1">.Format(</span><span class="cls_6">"{0} {1}"</span><span class="cls_1">, Build.Manufacturer,</span></div><div style="position:absolute;left:396px;top:484px;white-space:pre;"><span class="cls_1">Build.Model);</span></div><div style="position:absolute;left:154px;top:498px;white-space:pre;"><span class="cls_1">versionLabel.Text = Build.VERSION.Release.ToString();</span></div><div style="position:absolute;left:87px;top:524px;white-space:pre;"><span class="cls_4">#elif </span><span class="cls_1">WINDOWS_APP || WINDOWS_PHONE_APP || WINDOWS_UWP</span></div><div style="position:absolute;left:154px;top:551px;white-space:pre;"><span class="cls_2">EasClientDeviceInformation </span><span class="cls_1">devInfo = </span><span class="cls_4">new </span><span class="cls_2">EasClientDeviceInformation</span><span class="cls_1">();</span></div><div style="position:absolute;left:154px;top:564px;white-space:pre;"><span class="cls_1">modelLabel.Text = </span><span class="cls_2">String</span><span class="cls_1">.Format(</span><span class="cls_6">"{0} {1}"</span><span class="cls_1">, devInfo.SystemManufacturer,</span></div><div style="position:absolute;left:396px;top:578px;white-space:pre;"><span class="cls_1">devInfo.SystemProductName);</span></div><div style="position:absolute;left:154px;top:591px;white-space:pre;"><span class="cls_1">versionLabel.Text = devInfo.OperatingSystem;</span></div><div style="position:absolute;left:87px;top:618px;white-space:pre;"><span class="cls_4">#endif</span></div><div style="position:absolute;left:132px;top:644px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:658px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:671px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:696px;white-space:pre;"><span class="cls_0">Notice that these preprocessor directives are used to select different </span><span class="cls_5">using</span><span class="cls_0">directives as well as to</span></div><div style="position:absolute;left:87px;top:714px;white-space:pre;"><span class="cls_0">make calls to platform-specific APIs. In a program as simple as this, you could simply include the</span></div><div style="position:absolute;left:87px;top:731px;white-space:pre;"><span class="cls_0">namespaces with the class names, </span><span class="cls_0">but for longer blocks of code, you’ll probably want those </span><span class="cls_5">using</span></div><div style="position:absolute;left:87px;top:748px;white-space:pre;"><span class="cls_0">directives.</span></div><div style="position:absolute;left:103px;top:775px;white-space:pre;"><span class="cls_0">And of course it works:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:111px;top:71px;width:492px;height:295px;z-index:0;"><img src="images\image109.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image110.png" width="708" height="864" alt=""></div><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 9</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Platform-specific API calls</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">185</span></div><div style="position:absolute;left:127px;top:374px;white-space:pre;"><span class="cls_0">The advantage of this approach is that you have all the code for the three platforms in one place.</span></div><div style="position:absolute;left:111px;top:391px;white-space:pre;"><span class="cls_0">But the preprocessor directives in the code listing are</span><span class="cls_0">—let’s face it—</span><span class="cls_0">rather ugly, and they harken back</span></div><div style="position:absolute;left:111px;top:408px;white-space:pre;"><span class="cls_0">to a much earlier era in programming. Using preprocessor directives might not seem so bad for short</span></div><div style="position:absolute;left:111px;top:426px;white-space:pre;"><span class="cls_0">and less frequent calls such as this example, but in a larger program you’ll need to juggle blocks of</span></div><div style="position:absolute;left:111px;top:443px;white-space:pre;"><span class="cls_0">platform-specific code and shared code, and the multitude of preprocessor directives can easily be-</span></div><div style="position:absolute;left:111px;top:460px;white-space:pre;"><span class="cls_0">come confusing. Preprocessor directives should be used for little fixes and generally not as structural</span></div><div style="position:absolute;left:111px;top:478px;white-space:pre;"><span class="cls_0">elements in the application.</span></div><div style="position:absolute;left:127px;top:504px;white-space:pre;"><span class="cls_0">Let’s try another approach.</span></div><div style="position:absolute;left:79px;top:544px;white-space:pre;"><span class="cls_11">Parallel</span><span class="cls_12"> </span><span class="cls_11">classes</span><span class="cls_12"> </span><span class="cls_11">and</span><span class="cls_12"> </span><span class="cls_11">the</span><span class="cls_12"> </span><span class="cls_11">Shared</span><span class="cls_12"> </span><span class="cls_11">Asset</span><span class="cls_12"> </span><span class="cls_11">Project</span></div><div style="position:absolute;left:111px;top:592px;white-space:pre;"><span class="cls_0">Although the Shared Asset Project is an extension of the platform projects, the relationship goes both</span></div><div style="position:absolute;left:111px;top:610px;white-space:pre;"><span class="cls_0">ways: just as a platform project can make calls into code in a Shared Asset Project, the SAP can make</span></div><div style="position:absolute;left:111px;top:627px;white-space:pre;"><span class="cls_0">calls into the individual platform projects.</span></div><div style="position:absolute;left:127px;top:654px;white-space:pre;"><span class="cls_0">This means that we can restrict the platform-specific API calls to classes in the individual platform</span></div><div style="position:absolute;left:111px;top:671px;white-space:pre;"><span class="cls_0">projects. If the names and namespaces of these classes in the platform projects are the same, then code</span></div><div style="position:absolute;left:111px;top:688px;white-space:pre;"><span class="cls_0">in the SAP can access these classes in a transparent, platform-independent manner.</span></div><div style="position:absolute;left:127px;top:715px;white-space:pre;"><span class="cls_0">In the </span><span class="cls_13">PlatInfoSap2</span><span class="cls_0"> </span><span class="cls_0">solution, each of the five platform projects has a class named </span><span class="cls_5">PlatformInfo</span></div><div style="position:absolute;left:111px;top:732px;white-space:pre;"><span class="cls_0">that contains two methods that return </span><span class="cls_5">string</span><span class="cls_0">objects, named </span><span class="cls_5">GetModel</span><span class="cls_0">and </span><span class="cls_5">GetVersion</span><span class="cls_0">. </span><span class="cls_0">Here’s the</span></div><div style="position:absolute;left:111px;top:750px;white-space:pre;"><span class="cls_0">version of this class in the iOS project:</span></div><div style="position:absolute;left:111px;top:775px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">System;</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 9</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Platform-specific API calls</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">186</span></div><div style="position:absolute;left:87px;top:71px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">UIKit;</span></div><div style="position:absolute;left:87px;top:98px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">PlatInfoSap2</span></div><div style="position:absolute;left:87px;top:111px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:124px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">PlatformInfo</span></div><div style="position:absolute;left:109px;top:138px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:151px;white-space:pre;"><span class="cls_2">UIDevice </span><span class="cls_1">device = </span><span class="cls_4">new </span><span class="cls_2">UIDevice</span><span class="cls_1">();</span></div><div style="position:absolute;left:132px;top:178px;white-space:pre;"><span class="cls_4">public string </span><span class="cls_1">GetModel()</span></div><div style="position:absolute;left:132px;top:191px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:204px;white-space:pre;"><span class="cls_4">return </span><span class="cls_1">device.Model.ToString();</span></div><div style="position:absolute;left:132px;top:218px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:132px;top:244px;white-space:pre;"><span class="cls_4">public string </span><span class="cls_1">GetVersion()</span></div><div style="position:absolute;left:132px;top:258px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:271px;white-space:pre;"><span class="cls_4">return </span><span class="cls_2">String</span><span class="cls_1">.Format(</span><span class="cls_6">"{0} {1}"</span><span class="cls_1">, device.SystemName,</span></div><div style="position:absolute;left:334px;top:284px;white-space:pre;"><span class="cls_1">device.SystemVersion);</span></div><div style="position:absolute;left:132px;top:298px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:311px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:324px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:350px;white-space:pre;"><span class="cls_0">Notice the namespace name. Although the other classes in this iOS project use the </span><span class="cls_5">PlatInfo-</span></div><div style="position:absolute;left:87px;top:367px;white-space:pre;"><span class="cls_5">Sap2.iOS</span><span class="cls_0">namespace, the namespace for this class is just </span><span class="cls_5">PlatInfoSap2</span><span class="cls_0">. This allows the SAP to ac-</span></div><div style="position:absolute;left:87px;top:384px;white-space:pre;"><span class="cls_0">cess this class directly without any platform specifics.</span></div><div style="position:absolute;left:103px;top:411px;white-space:pre;"><span class="cls_0">Here’s the parallel class in the Android projec</span><span class="cls_0">t. Same namespace, same class name, and same</span></div><div style="position:absolute;left:87px;top:428px;white-space:pre;"><span class="cls_0">method names, but different implementations of these methods using Android API calls:</span></div><div style="position:absolute;left:87px;top:454px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">System;</span></div><div style="position:absolute;left:87px;top:467px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Android.OS;</span></div><div style="position:absolute;left:87px;top:494px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">PlatInfoSap2</span></div><div style="position:absolute;left:87px;top:507px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:520px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">PlatformInfo</span></div><div style="position:absolute;left:109px;top:534px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:547px;white-space:pre;"><span class="cls_4">public string </span><span class="cls_1">GetModel()</span></div><div style="position:absolute;left:132px;top:560px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:574px;white-space:pre;"><span class="cls_4">return </span><span class="cls_2">String</span><span class="cls_1">.Format(</span><span class="cls_6">"{0} {1}"</span><span class="cls_1">, </span><span class="cls_2">Build</span><span class="cls_1">.Manufacturer,</span></div><div style="position:absolute;left:334px;top:587px;white-space:pre;"><span class="cls_2">Build</span><span class="cls_1">.Model);</span></div><div style="position:absolute;left:132px;top:600px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:132px;top:627px;white-space:pre;"><span class="cls_4">public string </span><span class="cls_1">GetVersion()</span></div><div style="position:absolute;left:132px;top:640px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:654px;white-space:pre;"><span class="cls_4">return </span><span class="cls_2">Build</span><span class="cls_1">.</span><span class="cls_2">VERSION</span><span class="cls_1">.Release.ToString();</span></div><div style="position:absolute;left:132px;top:667px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:680px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:694px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:103px;top:719px;white-space:pre;"><span class="cls_0">And here’s the class that exists in three identical copies in the three Windows and Windows Phone</span></div><div style="position:absolute;left:87px;top:736px;white-space:pre;"><span class="cls_0">projects:</span></div><div style="position:absolute;left:87px;top:762px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">System;</span></div><div style="position:absolute;left:87px;top:775px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Windows.Security.ExchangeActiveSyncProvisioning;</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image111.png" width="708" height="864" alt=""></div><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 9</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Platform-specific API calls</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">187</span></div><div style="position:absolute;left:111px;top:84px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">PlatInfoSap2</span></div><div style="position:absolute;left:111px;top:98px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:111px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">PlatformInfo</span></div><div style="position:absolute;left:133px;top:124px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:138px;white-space:pre;"><span class="cls_2">EasClientDeviceInformation </span><span class="cls_1">devInfo = </span><span class="cls_4">new </span><span class="cls_2">EasClientDeviceInformation</span><span class="cls_1">();</span></div><div style="position:absolute;left:156px;top:164px;white-space:pre;"><span class="cls_4">public string </span><span class="cls_1">GetModel()</span></div><div style="position:absolute;left:156px;top:178px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:191px;white-space:pre;"><span class="cls_4">return </span><span class="cls_2">String</span><span class="cls_1">.Format(</span><span class="cls_6">"{0} {1}"</span><span class="cls_1">, devInfo.SystemManufacturer,</span></div><div style="position:absolute;left:358px;top:204px;white-space:pre;"><span class="cls_1">devInfo.SystemProductName);</span></div><div style="position:absolute;left:156px;top:218px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:156px;top:244px;white-space:pre;"><span class="cls_4">public string </span><span class="cls_1">GetVersion()</span></div><div style="position:absolute;left:156px;top:258px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:271px;white-space:pre;"><span class="cls_4">return </span><span class="cls_1">devInfo.OperatingSystem;</span></div><div style="position:absolute;left:156px;top:284px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:133px;top:298px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:311px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:127px;top:336px;white-space:pre;"><span class="cls_0">The XAML file in the </span><span class="cls_13">PlatInfoSap2</span><span class="cls_0"> </span><span class="cls_0">project is basically the same as the one in </span><span class="cls_13">PlatInfoSap1</span><span class="cls_0"> </span><span class="cls_0">project.</span></div><div style="position:absolute;left:111px;top:354px;white-space:pre;"><span class="cls_0">The code-behind file is considerably simpler:</span></div><div style="position:absolute;left:111px;top:379px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">System;</span></div><div style="position:absolute;left:111px;top:392px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Xamarin.Forms;</span></div><div style="position:absolute;left:111px;top:419px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">PlatInfoSap2</span></div><div style="position:absolute;left:111px;top:432px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:446px;white-space:pre;"><span class="cls_4">public partial class </span><span class="cls_2">PlatInfoSap2Page </span><span class="cls_1">: </span><span class="cls_2">ContentPage</span></div><div style="position:absolute;left:133px;top:459px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:472px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">PlatInfoSap2Page ()</span></div><div style="position:absolute;left:156px;top:486px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:499px;white-space:pre;"><span class="cls_1">InitializeComponent ();</span></div><div style="position:absolute;left:178px;top:526px;white-space:pre;"><span class="cls_2">PlatformInfo </span><span class="cls_1">platformInfo = </span><span class="cls_4">new </span><span class="cls_2">PlatformInfo</span><span class="cls_1">();</span></div><div style="position:absolute;left:178px;top:539px;white-space:pre;"><span class="cls_1">modelLabel.Text = platformInfo.GetModel();</span></div><div style="position:absolute;left:178px;top:552px;white-space:pre;"><span class="cls_1">versionLabel.Text = platformInfo.GetVersion();</span></div><div style="position:absolute;left:156px;top:566px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:133px;top:579px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:592px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:618px;white-space:pre;"><span class="cls_0">The particular version of </span><span class="cls_5">PlatformInfo</span><span class="cls_0">that is referenced by the class is the one in the compiled pro-</span></div><div style="position:absolute;left:111px;top:635px;white-space:pre;"><span class="cls_0">ject. </span><span class="cls_0">It’s almost as if we’ve defined a little extension to Xamarin.Forms that resides in the individual</span></div><div style="position:absolute;left:111px;top:652px;white-space:pre;"><span class="cls_0">platform projects.</span></div><div style="position:absolute;left:79px;top:692px;white-space:pre;"><span class="cls_11">DependencyService</span><span class="cls_12"> </span><span class="cls_11">and</span><span class="cls_12"> </span><span class="cls_11">the</span><span class="cls_12"> </span><span class="cls_11">Portable</span><span class="cls_12"> </span><span class="cls_11">Class</span><span class="cls_12"> </span><span class="cls_11">Library</span></div><div style="position:absolute;left:111px;top:740px;white-space:pre;"><span class="cls_0">Can the technique illustrated in the </span><span class="cls_13">PlatInfoSap2</span><span class="cls_0"> </span><span class="cls_0">program be implemented in a solution with a Porta-</span></div><div style="position:absolute;left:111px;top:758px;white-space:pre;"><span class="cls_0">ble Class Library? At first, it doesn’t seem possible. </span><span class="cls_0">Although application projects make calls to libraries</span></div><div style="position:absolute;left:111px;top:775px;white-space:pre;"><span class="cls_0">all the time, libraries generally can’t make calls to applications except in the context of events or</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 9</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Platform-specific API calls</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">188</span></div><div style="position:absolute;left:87px;top:72px;white-space:pre;"><span class="cls_0">callback functions. The PCL is bundled with a device-independent version of .NET and closed up</span></div><div style="position:absolute;left:87px;top:90px;white-space:pre;"><span class="cls_0">tight</span><span class="cls_0">—</span><span class="cls_0">capable only of executing code within itself or other PCLs it might reference.</span></div><div style="position:absolute;left:103px;top:116px;white-space:pre;"><span class="cls_0">But wait: When a Xamarin.Forms application is running, it can use .NET reflection to get access to its</span></div><div style="position:absolute;left:87px;top:134px;white-space:pre;"><span class="cls_0">own assembly and any other assemblies in the program. This means that code in the PCL can use re-</span></div><div style="position:absolute;left:87px;top:151px;white-space:pre;"><span class="cls_0">flection to access classes that exist in the platform assembly from which the PCL is referenced. Those</span></div><div style="position:absolute;left:87px;top:168px;white-space:pre;"><span class="cls_0">classes must be defined as public, of course, but that’s just a</span><span class="cls_0">bout the only requirement.</span></div><div style="position:absolute;left:103px;top:195px;white-space:pre;"><span class="cls_0">Before you start writing code that exploits this technique, you should know that this solution al-</span></div><div style="position:absolute;left:87px;top:212px;white-space:pre;"><span class="cls_0">ready exists in the form of a Xamarin.Forms class named </span><span class="cls_5">DependencyService</span><span class="cls_0">. This class uses .NET</span></div><div style="position:absolute;left:87px;top:230px;white-space:pre;"><span class="cls_0">reflection to search through all the other assemblies in the application</span><span class="cls_0">—</span><span class="cls_0">including the particular plat-</span></div><div style="position:absolute;left:87px;top:247px;white-space:pre;"><span class="cls_0">form assembly itself</span><span class="cls_0">—</span><span class="cls_0">and provide access to platform-specific code.</span></div><div style="position:absolute;left:103px;top:274px;white-space:pre;"><span class="cls_0">The use of </span><span class="cls_5">DependencyService</span><span class="cls_0">is illustrated in the </span><span class="cls_13">DisplayPlatformInfo</span><span class="cls_0"> </span><span class="cls_0">solution, which uses a</span></div><div style="position:absolute;left:87px;top:291px;white-space:pre;"><span class="cls_0">Portable Class Library for the shared code. You begin the process of using </span><span class="cls_5">DependencyService</span><span class="cls_0">by</span></div><div style="position:absolute;left:87px;top:308px;white-space:pre;"><span class="cls_0">defining an interface type in the PCL project that declares the signatures of the methods you want to</span></div><div style="position:absolute;left:87px;top:326px;white-space:pre;"><span class="cls_0">implement in the platform projects. Here’s </span><span class="cls_5">IPlatformInfo</span><span class="cls_0">:</span></div><div style="position:absolute;left:87px;top:351px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">DisplayPlatformInfo</span></div><div style="position:absolute;left:87px;top:364px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:378px;white-space:pre;"><span class="cls_4">public interface </span><span class="cls_2">IPlatformInfo</span></div><div style="position:absolute;left:109px;top:391px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:404px;white-space:pre;"><span class="cls_4">string </span><span class="cls_1">GetModel();</span></div><div style="position:absolute;left:132px;top:431px;white-space:pre;"><span class="cls_4">string </span><span class="cls_1">GetVersion();</span></div><div style="position:absolute;left:109px;top:444px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:458px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:483px;white-space:pre;"><span class="cls_0">You’ve seen those two methods before. They’re the same two methods implemented in the </span><span class="cls_5">Plat-</span></div><div style="position:absolute;left:87px;top:500px;white-space:pre;"><span class="cls_5">formInfo</span><span class="cls_0">classes in the platform projects in </span><span class="cls_13">PlatInfoSap2</span><span class="cls_0">.</span></div><div style="position:absolute;left:103px;top:527px;white-space:pre;"><span class="cls_0">In a manner very similar to </span><span class="cls_13">PlatInfoSap2</span><span class="cls_0">, all three platform projects in </span><span class="cls_13">DisplayPlatformInfo</span><span class="cls_0"> </span><span class="cls_0">must</span></div><div style="position:absolute;left:87px;top:544px;white-space:pre;"><span class="cls_0">now have a class that implements the </span><span class="cls_5">IPlatformInfo</span><span class="cls_0">interface. Here’s the class in the iOS project,</span></div><div style="position:absolute;left:87px;top:562px;white-space:pre;"><span class="cls_0">named </span><span class="cls_5">PlatformInfo</span><span class="cls_0">:</span></div><div style="position:absolute;left:87px;top:587px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">System;</span></div><div style="position:absolute;left:87px;top:600px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">UIKit;</span></div><div style="position:absolute;left:87px;top:614px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Xamarin.Forms;</span></div><div style="position:absolute;left:87px;top:640px;white-space:pre;"><span class="cls_1">[</span><span class="cls_4">assembly</span><span class="cls_1">: </span><span class="cls_2">Dependency</span><span class="cls_1">(</span><span class="cls_4">typeof</span><span class="cls_1">(DisplayPlatformInfo.iOS.</span><span class="cls_2">PlatformInfo</span><span class="cls_1">))]</span></div><div style="position:absolute;left:87px;top:667px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">DisplayPlatformInfo.iOS</span></div><div style="position:absolute;left:87px;top:680px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:694px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">PlatformInfo </span><span class="cls_1">: </span><span class="cls_2">IPlatformInfo</span></div><div style="position:absolute;left:109px;top:707px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:720px;white-space:pre;"><span class="cls_2">UIDevice </span><span class="cls_1">device = </span><span class="cls_4">new </span><span class="cls_2">UIDevice</span><span class="cls_1">();</span></div><div style="position:absolute;left:132px;top:747px;white-space:pre;"><span class="cls_4">public string </span><span class="cls_1">GetModel()</span></div><div style="position:absolute;left:132px;top:760px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:774px;white-space:pre;"><span class="cls_4">return </span><span class="cls_1">device.Model.ToString();</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 9</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Platform-specific API calls</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">189</span></div><div style="position:absolute;left:156px;top:71px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:156px;top:98px;white-space:pre;"><span class="cls_4">public string </span><span class="cls_1">GetVersion()</span></div><div style="position:absolute;left:156px;top:111px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:124px;white-space:pre;"><span class="cls_4">return </span><span class="cls_2">String</span><span class="cls_1">.Format(</span><span class="cls_6">"{0} {1}"</span><span class="cls_1">, device.SystemName,</span></div><div style="position:absolute;left:358px;top:138px;white-space:pre;"><span class="cls_1">device.SystemVersion);</span></div><div style="position:absolute;left:156px;top:151px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:133px;top:164px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:178px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:203px;white-space:pre;"><span class="cls_0">This class is not referenced directly from the PCL, so the namespace name can be anything you want.</span></div><div style="position:absolute;left:111px;top:220px;white-space:pre;"><span class="cls_0">Here it’s set to the same namespace as the other code in the iOS project. The class name can also be</span></div><div style="position:absolute;left:111px;top:238px;white-space:pre;"><span class="cls_0">anything you want. Whatever you name it, however, the class must explicitly implement the </span><span class="cls_5">IPlat-</span></div><div style="position:absolute;left:111px;top:255px;white-space:pre;"><span class="cls_5">formInfo</span><span class="cls_0">interface defined in the PCL:</span></div><div style="position:absolute;left:111px;top:280px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">PlatformInfo </span><span class="cls_1">: </span><span class="cls_2">IPlatformInfo</span></div><div style="position:absolute;left:127px;top:306px;white-space:pre;"><span class="cls_0">Furthermore, this class must be referenced in a special attribute outside the namespace block. You’ll</span></div><div style="position:absolute;left:111px;top:323px;white-space:pre;"><span class="cls_0">see it near the top of the file following the </span><span class="cls_5">using</span><span class="cls_0">directives:</span></div><div style="position:absolute;left:111px;top:348px;white-space:pre;"><span class="cls_1">[</span><span class="cls_4">assembly</span><span class="cls_1">: </span><span class="cls_2">Dependency</span><span class="cls_1">(</span><span class="cls_4">typeof</span><span class="cls_1">(DisplayPlatformInfo.iOS.</span><span class="cls_2">PlatformInfo</span><span class="cls_1">))]</span></div><div style="position:absolute;left:111px;top:374px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">DependencyAttribute</span><span class="cls_0">class that defines this </span><span class="cls_5">Dependency</span><span class="cls_0">attribute is part of Xamarin.Forms and</span></div><div style="position:absolute;left:111px;top:391px;white-space:pre;"><span class="cls_0">used specifically in connection with </span><span class="cls_5">DependencyService</span><span class="cls_0">. The argument is a </span><span class="cls_5">Type</span><span class="cls_0">object of a class in</span></div><div style="position:absolute;left:111px;top:408px;white-space:pre;"><span class="cls_0">the platform project that is available for access by the PCL. In this case, it’s this </span><span class="cls_5">PlatformInfo</span><span class="cls_0">class.</span></div><div style="position:absolute;left:111px;top:426px;white-space:pre;"><span class="cls_0">This attribute is attached to the platform assembly itself, so code executing in the PCL doesn’t have to</span></div><div style="position:absolute;left:111px;top:443px;white-space:pre;"><span class="cls_0">search all over the library to find it.</span></div><div style="position:absolute;left:127px;top:470px;white-space:pre;"><span class="cls_0">Here’s the Android version of </span><span class="cls_5">PlatformInfo</span><span class="cls_0">:</span></div><div style="position:absolute;left:111px;top:495px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">System;</span></div><div style="position:absolute;left:111px;top:508px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Android.OS;</span></div><div style="position:absolute;left:111px;top:522px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Xamarin.Forms;</span></div><div style="position:absolute;left:111px;top:548px;white-space:pre;"><span class="cls_1">[</span><span class="cls_4">assembly</span><span class="cls_1">: </span><span class="cls_2">Dependency</span><span class="cls_1">(</span><span class="cls_4">typeof</span><span class="cls_1">(DisplayPlatformInfo.Droid.</span><span class="cls_2">PlatformInfo</span><span class="cls_1">))]</span></div><div style="position:absolute;left:111px;top:575px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">DisplayPlatformInfo.Droid</span></div><div style="position:absolute;left:111px;top:588px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:602px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">PlatformInfo </span><span class="cls_1">: </span><span class="cls_2">IPlatformInfo</span></div><div style="position:absolute;left:133px;top:615px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:628px;white-space:pre;"><span class="cls_4">public string </span><span class="cls_1">GetModel()</span></div><div style="position:absolute;left:156px;top:642px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:655px;white-space:pre;"><span class="cls_4">return </span><span class="cls_2">String</span><span class="cls_1">.Format(</span><span class="cls_6">"{0} {1}"</span><span class="cls_1">, </span><span class="cls_2">Build</span><span class="cls_1">.Manufacturer,</span></div><div style="position:absolute;left:358px;top:668px;white-space:pre;"><span class="cls_2">Build</span><span class="cls_1">.Model);</span></div><div style="position:absolute;left:156px;top:682px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:156px;top:708px;white-space:pre;"><span class="cls_4">public string </span><span class="cls_1">GetVersion()</span></div><div style="position:absolute;left:156px;top:722px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:735px;white-space:pre;"><span class="cls_4">return </span><span class="cls_2">Build</span><span class="cls_1">.</span><span class="cls_2">VERSION</span><span class="cls_1">.Release.ToString();</span></div><div style="position:absolute;left:156px;top:748px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:133px;top:762px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:775px;white-space:pre;"><span class="cls_1">}</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 9</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Platform-specific API calls</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">190</span></div><div style="position:absolute;left:103px;top:72px;white-space:pre;"><span class="cls_0">And here’s the one for the UWP project:</span></div><div style="position:absolute;left:87px;top:98px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">System;</span></div><div style="position:absolute;left:87px;top:111px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Windows.Security.ExchangeActiveSyncProvisioning;</span></div><div style="position:absolute;left:87px;top:124px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Xamarin.Forms;</span></div><div style="position:absolute;left:87px;top:151px;white-space:pre;"><span class="cls_1">[</span><span class="cls_4">assembly</span><span class="cls_1">: </span><span class="cls_2">Dependency</span><span class="cls_1">(</span><span class="cls_4">typeof</span><span class="cls_1">(DisplayPlatformInfo.UWP.</span><span class="cls_2">PlatformInfo</span><span class="cls_1">))]</span></div><div style="position:absolute;left:87px;top:178px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">DisplayPlatformInfo.UWP</span></div><div style="position:absolute;left:87px;top:191px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:204px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">PlatformInfo </span><span class="cls_1">: </span><span class="cls_2">IPlatformInfo</span></div><div style="position:absolute;left:109px;top:218px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:231px;white-space:pre;"><span class="cls_2">EasClientDeviceInformation </span><span class="cls_1">devInfo = </span><span class="cls_4">new </span><span class="cls_2">EasClientDeviceInformation</span><span class="cls_1">();</span></div><div style="position:absolute;left:132px;top:258px;white-space:pre;"><span class="cls_4">public string </span><span class="cls_1">GetModel()</span></div><div style="position:absolute;left:132px;top:271px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:284px;white-space:pre;"><span class="cls_4">return </span><span class="cls_2">String</span><span class="cls_1">.Format(</span><span class="cls_6">"{0} {1}"</span><span class="cls_1">, devInfo.SystemManufacturer,</span></div><div style="position:absolute;left:334px;top:298px;white-space:pre;"><span class="cls_1">devInfo.SystemProductName);</span></div><div style="position:absolute;left:132px;top:311px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:132px;top:338px;white-space:pre;"><span class="cls_4">public string </span><span class="cls_1">GetVersion()</span></div><div style="position:absolute;left:132px;top:351px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:364px;white-space:pre;"><span class="cls_4">return </span><span class="cls_1">devInfo.OperatingSystem;</span></div><div style="position:absolute;left:132px;top:378px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:391px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:404px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:430px;white-space:pre;"><span class="cls_0">The Windows 8.1 and Windows Phone 8.1 projects have similar files that differ only by the namespace.</span></div><div style="position:absolute;left:103px;top:456px;white-space:pre;"><span class="cls_0">Code in the PCL can then get access to the particular platform’s implementation of </span><span class="cls_5">IPlatform-</span></div><div style="position:absolute;left:87px;top:474px;white-space:pre;"><span class="cls_5">Info</span><span class="cls_0">by using the </span><span class="cls_5">DependencyService</span><span class="cls_0">class. This is a static class with three public methods, the most</span></div><div style="position:absolute;left:87px;top:491px;white-space:pre;"><span class="cls_0">important of which is named </span><span class="cls_5">Get</span><span class="cls_0">. </span><span class="cls_5">Get</span><span class="cls_0">is a generic method whose argument is the interface you’ve de-</span></div><div style="position:absolute;left:87px;top:508px;white-space:pre;"><span class="cls_0">fined, in this case </span><span class="cls_5">IPlatformInfo</span><span class="cls_0">.</span></div><div style="position:absolute;left:87px;top:534px;white-space:pre;"><span class="cls_2">IPlatformInfo </span><span class="cls_1">platformInfo = </span><span class="cls_2">DependencyService</span><span class="cls_1">.Get<</span><span class="cls_2">IPlatformInfo</span><span class="cls_1">>();</span></div><div style="position:absolute;left:87px;top:559px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">Get</span><span class="cls_0">method returns an instance of the platform-specific class that implements the </span><span class="cls_5">IPlatform-</span></div><div style="position:absolute;left:87px;top:576px;white-space:pre;"><span class="cls_5">Info</span><span class="cls_0">interface. You can then use this object to make platform-specific calls. This is demonstrated in the</span></div><div style="position:absolute;left:87px;top:594px;white-space:pre;"><span class="cls_0">code-behind file for the </span><span class="cls_13">DisplayPlatformInfo</span><span class="cls_0"> </span><span class="cls_0">project:</span></div><div style="position:absolute;left:87px;top:619px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">DisplayPlatformInfo</span></div><div style="position:absolute;left:87px;top:632px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:646px;white-space:pre;"><span class="cls_4">public partial class </span><span class="cls_2">DisplayPlatformInfoPage </span><span class="cls_1">: </span><span class="cls_2">ContentPage</span></div><div style="position:absolute;left:109px;top:659px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:672px;white-space:pre;"><span class="cls_4">public </span><span class="cls_1">DisplayPlatformInfoPage()</span></div><div style="position:absolute;left:132px;top:686px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:699px;white-space:pre;"><span class="cls_1">InitializeComponent();</span></div><div style="position:absolute;left:154px;top:726px;white-space:pre;"><span class="cls_2">IPlatformInfo </span><span class="cls_1">platformInfo = </span><span class="cls_2">DependencyService</span><span class="cls_1">.Get<</span><span class="cls_2">IPlatformInfo</span><span class="cls_1">>();</span></div><div style="position:absolute;left:154px;top:739px;white-space:pre;"><span class="cls_1">modelLabel.Text = platformInfo.GetModel();</span></div><div style="position:absolute;left:154px;top:752px;white-space:pre;"><span class="cls_1">versionLabel.Text = platformInfo.GetVersion();</span></div><div style="position:absolute;left:132px;top:766px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:779px;white-space:pre;"><span class="cls_1">}</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image112.png" width="708" height="864" alt=""></div><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 9</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Platform-specific API calls</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">191</span></div><div style="position:absolute;left:111px;top:71px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:127px;top:96px;white-space:pre;"><span class="cls_5">DependencyService</span><span class="cls_0">caches the instances of the objects that it obtains through the </span><span class="cls_5">Get</span><span class="cls_0">method.</span></div><div style="position:absolute;left:111px;top:114px;white-space:pre;"><span class="cls_0">This speeds up subsequent uses of </span><span class="cls_5">Get</span><span class="cls_0">and also allows the platform implementations of the interface</span></div><div style="position:absolute;left:111px;top:131px;white-space:pre;"><span class="cls_0">to maintain state: any fields and properties in the platform implementations will be preserved across</span></div><div style="position:absolute;left:111px;top:148px;white-space:pre;"><span class="cls_0">multiple </span><span class="cls_5">Get</span><span class="cls_0">calls. These classes can also include events or implement callback methods.</span></div><div style="position:absolute;left:127px;top:175px;white-space:pre;"><span class="cls_5">DependencyService</span><span class="cls_0">requires just a little more overhead than the approach shown in the </span><span class="cls_13">PlatIn-</span></div><div style="position:absolute;left:111px;top:192px;white-space:pre;"><span class="cls_13">foSap2</span><span class="cls_0"> </span><span class="cls_0">project and is somewhat more structured because the individual platform classes implement an</span></div><div style="position:absolute;left:111px;top:210px;white-space:pre;"><span class="cls_0">interface defined in shared code.</span></div><div style="position:absolute;left:127px;top:236px;white-space:pre;"><span class="cls_5">DependencyService</span><span class="cls_0">is not the only way to implement platform-specific calls in a PCL. Adven-</span></div><div style="position:absolute;left:111px;top:254px;white-space:pre;"><span class="cls_0">turous developers might want to use dependency-injection techniques to configure the PCL to make</span></div><div style="position:absolute;left:111px;top:271px;white-space:pre;"><span class="cls_0">calls into the platform projects. But </span><span class="cls_5">DependencyService</span><span class="cls_0">is very easy to use, and it eliminates most</span></div><div style="position:absolute;left:111px;top:288px;white-space:pre;"><span class="cls_0">reasons to use a Shared Asset Project in a Xamarin.Forms application.</span></div><div style="position:absolute;left:79px;top:328px;white-space:pre;"><span class="cls_11">Platform-specific</span><span class="cls_12"> </span><span class="cls_11">sound</span><span class="cls_12"> </span><span class="cls_11">generation</span></div><div style="position:absolute;left:111px;top:376px;white-space:pre;"><span class="cls_0">Now for the real objective of this chapter: to give sound to </span><span class="cls_13">MonkeyTap</span><span class="cls_0">. All three platforms support</span></div><div style="position:absolute;left:111px;top:394px;white-space:pre;"><span class="cls_0">APIs that allow a program to dynamically generate and play audio waveforms. This is the approach</span></div><div style="position:absolute;left:111px;top:411px;white-space:pre;"><span class="cls_0">taken by the </span><span class="cls_13">MonkeyTapWithSound</span><span class="cls_0"> </span><span class="cls_0">program.</span></div><div style="position:absolute;left:127px;top:438px;white-space:pre;"><span class="cls_0">Commercial music files are often compressed in formats such as MP3. But when a program is algo-</span></div><div style="position:absolute;left:111px;top:455px;white-space:pre;"><span class="cls_0">rithmically generating waveforms, an uncompressed format is much more convenient. The most basic</span></div><div style="position:absolute;left:111px;top:472px;white-space:pre;"><span class="cls_0">technique</span><span class="cls_0">—</span><span class="cls_0">which is supported by all three platforms</span><span class="cls_0">—</span><span class="cls_0">is called pulse code modulation or PCM. De-</span></div><div style="position:absolute;left:111px;top:490px;white-space:pre;"><span class="cls_0">spite the fancy name, it’s quite simple, and it’s the technique used for storing sound on music CDs.</span></div><div style="position:absolute;left:127px;top:516px;white-space:pre;"><span class="cls_0">A PCM waveform is described by a series of samples at a constant rate, known as the sampling rate.</span></div><div style="position:absolute;left:111px;top:534px;white-space:pre;"><span class="cls_0">Music CDs use a standard rate of 44,100 samples per second. Audio files generated by computer pro-</span></div><div style="position:absolute;left:111px;top:551px;white-space:pre;"><span class="cls_0">grams often use a sampling rate of half that (22,050) or one-quarter (11,025) if high audio quality is</span></div><div style="position:absolute;left:111px;top:568px;white-space:pre;"><span class="cls_0">not required. The highest frequency that can be recorded and reproduced is one-half the sampling</span></div><div style="position:absolute;left:111px;top:586px;white-space:pre;"><span class="cls_0">rate.</span></div><div style="position:absolute;left:127px;top:612px;white-space:pre;"><span class="cls_0">Each sample is a fixed size that defines the amplitude of the waveform at that point in time. The</span></div><div style="position:absolute;left:111px;top:630px;white-space:pre;"><span class="cls_0">samples on a music CD are signed 16-bit values. Samples of 8 bits are common when sound quality</span></div><div style="position:absolute;left:111px;top:647px;white-space:pre;"><span class="cls_0">doesn’t matter as much. Some environments support floating</span><span class="cls_0">-point values. Multiple samples can</span></div><div style="position:absolute;left:111px;top:664px;white-space:pre;"><span class="cls_0">accommodate stereo or any number of channels. For simple sound effects on mobile devices, monau-</span></div><div style="position:absolute;left:111px;top:682px;white-space:pre;"><span class="cls_0">ral sound is often fine.</span></div><div style="position:absolute;left:127px;top:708px;white-space:pre;"><span class="cls_0">The sound generation algorithm in </span><span class="cls_13">MonkeyTapWithSound</span><span class="cls_0"> </span><span class="cls_0">is hard-coded for 16-bit monaural</span></div><div style="position:absolute;left:111px;top:726px;white-space:pre;"><span class="cls_0">samples, but the sampling rate is specified by a constant and can easily be changed.</span></div><div style="position:absolute;left:127px;top:752px;white-space:pre;"><span class="cls_0">Now that you know how </span><span class="cls_5">DependencyService</span><span class="cls_0">works, let’s examine the code added to </span><span class="cls_13">Monkey-</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 9</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Platform-specific API calls</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">192</span></div><div style="position:absolute;left:87px;top:72px;white-space:pre;"><span class="cls_13">Tap</span><span class="cls_0"> </span><span class="cls_0">to turn it into </span><span class="cls_13">MonkeyTapWithSound</span><span class="cls_0">, and let’s look at it from the top down. To avoid reproduc-</span></div><div style="position:absolute;left:87px;top:90px;white-space:pre;"><span class="cls_0">ing a lot of code, the new project contains links to the MonkeyTap.xaml and MonkeyTap.xaml.cs files in</span></div><div style="position:absolute;left:87px;top:107px;white-space:pre;"><span class="cls_0">the </span><span class="cls_13">MonkeyTap</span><span class="cls_0"> </span><span class="cls_0">project.</span></div><div style="position:absolute;left:103px;top:134px;white-space:pre;"><span class="cls_0">In Visual Studio, you can add items to projects as links to existing files by selecting </span><span class="cls_13">Add</span><span class="cls_0"> </span><span class="cls_13">></span><span class="cls_0"> </span><span class="cls_13">Existing</span></div><div style="position:absolute;left:87px;top:151px;white-space:pre;"><span class="cls_13">Item</span><span class="cls_0"> </span><span class="cls_0">from the project menu. Then use the </span><span class="cls_13">Add</span><span class="cls_0"> </span><span class="cls_13">Existing</span><span class="cls_0"> </span><span class="cls_13">Item</span><span class="cls_0"> </span><span class="cls_0">dialog to navigate to the file. Choose</span></div><div style="position:absolute;left:87px;top:168px;white-space:pre;"><span class="cls_13">Add</span><span class="cls_0"> </span><span class="cls_13">as</span><span class="cls_0"> </span><span class="cls_13">Link</span><span class="cls_0"> </span><span class="cls_0">from the drop-down on the </span><span class="cls_13">Add</span><span class="cls_0"> </span><span class="cls_0">button.</span></div><div style="position:absolute;left:103px;top:195px;white-space:pre;"><span class="cls_0">In Xamarin Studio, select </span><span class="cls_13">Add</span><span class="cls_0"> </span><span class="cls_13">></span><span class="cls_0"> </span><span class="cls_13">Add</span><span class="cls_0"> </span><span class="cls_13">Files</span><span class="cls_0"> </span><span class="cls_0">from </span><span class="cls_0">the project’s tool menu. After opening the file or</span></div><div style="position:absolute;left:87px;top:212px;white-space:pre;"><span class="cls_0">files, an </span><span class="cls_13">Add</span><span class="cls_0"> </span><span class="cls_13">File</span><span class="cls_0"> </span><span class="cls_13">to</span><span class="cls_0"> </span><span class="cls_13">Folder</span><span class="cls_0"> </span><span class="cls_0">alert box pops up. Choose </span><span class="cls_13">Add</span><span class="cls_0"> </span><span class="cls_13">a</span><span class="cls_0"> </span><span class="cls_13">link</span><span class="cls_0"> </span><span class="cls_13">to</span><span class="cls_0"> </span><span class="cls_13">the</span><span class="cls_0"> </span><span class="cls_13">file</span><span class="cls_0">.</span></div><div style="position:absolute;left:103px;top:239px;white-space:pre;"><span class="cls_0">However, after taking these steps in Visual Studio, it was also necessary to manually edit the Mon-</span></div><div style="position:absolute;left:87px;top:256px;white-space:pre;"><span class="cls_0">keyTapWithSound.csproj file to change the MonkeyTapPage.xaml file to an </span><span class="cls_13">EmbeddedResource</span><span class="cls_0"> </span><span class="cls_0">and</span></div><div style="position:absolute;left:87px;top:274px;white-space:pre;"><span class="cls_0">the </span><span class="cls_13">Generator</span><span class="cls_0"> </span><span class="cls_0">to </span><span class="cls_13">MSBuild:UpdateDesignTimeXaml</span><span class="cls_0">. Also, a </span><span class="cls_13">DependentUpon</span><span class="cls_0"> </span><span class="cls_0">tag was added to the</span></div><div style="position:absolute;left:87px;top:291px;white-space:pre;"><span class="cls_0">MonkeyTapPage.xaml.cs file to reference the MonkeyTapPage.xaml file. This causes the code-behind</span></div><div style="position:absolute;left:87px;top:308px;white-space:pre;"><span class="cls_0">file to be indented under the XAML file in the file list.</span></div><div style="position:absolute;left:103px;top:335px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">MonkeyTapWithSoundPage</span><span class="cls_0">class then derives from the </span><span class="cls_5">MonkeyTapPage</span><span class="cls_0">class. Although the</span></div><div style="position:absolute;left:87px;top:352px;white-space:pre;"><span class="cls_5">MonkeyTapPage</span><span class="cls_0">class is defined by a XAML file and a code-behind file, </span><span class="cls_5">MonkeyTapWithSoundPage</span><span class="cls_0">is</span></div><div style="position:absolute;left:87px;top:370px;white-space:pre;"><span class="cls_0">code only. When a class is derived in this way, event handlers in the original code-behind file for events</span></div><div style="position:absolute;left:87px;top:387px;white-space:pre;"><span class="cls_0">in the XAML file must be defined as </span><span class="cls_5">protected</span><span class="cls_0">, and this is the case.</span></div><div style="position:absolute;left:103px;top:414px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">MonkeyTap</span><span class="cls_0">class also defined a </span><span class="cls_5">flashDuration</span><span class="cls_0">constant as </span><span class="cls_5">protected</span><span class="cls_0">, and two methods</span></div><div style="position:absolute;left:87px;top:431px;white-space:pre;"><span class="cls_0">were defined as </span><span class="cls_5">protected</span><span class="cls_0">and </span><span class="cls_5">virtual</span><span class="cls_0">. The </span><span class="cls_5">MonkeyTapWithSoundPage</span><span class="cls_0">overrides these two meth-</span></div><div style="position:absolute;left:87px;top:448px;white-space:pre;"><span class="cls_0">ods to call a static method named </span><span class="cls_5">SoundPlayer.PlaySound</span><span class="cls_0">:</span></div><div style="position:absolute;left:87px;top:474px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">MonkeyTapWithSound</span></div><div style="position:absolute;left:87px;top:487px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:500px;white-space:pre;"><span class="cls_4">class </span><span class="cls_2">MonkeyTapWithSoundPage </span><span class="cls_1">: MonkeyTap.</span><span class="cls_2">MonkeyTapPage</span></div><div style="position:absolute;left:109px;top:514px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:527px;white-space:pre;"><span class="cls_4">const int </span><span class="cls_1">errorDuration = 500;</span></div><div style="position:absolute;left:132px;top:554px;white-space:pre;"><span class="cls_3">// Diminished 7th in 1st inversion: C, Eb, F#, A</span></div><div style="position:absolute;left:132px;top:567px;white-space:pre;"><span class="cls_4">double</span><span class="cls_1">[] frequencies = { 523.25, 622.25, 739.99, 880 };</span></div><div style="position:absolute;left:132px;top:594px;white-space:pre;"><span class="cls_4">protected override void </span><span class="cls_1">BlinkBoxView(</span><span class="cls_4">int </span><span class="cls_1">index)</span></div><div style="position:absolute;left:132px;top:607px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:620px;white-space:pre;"><span class="cls_2">SoundPlayer</span><span class="cls_1">.PlaySound(frequencies[index], flashDuration);</span></div><div style="position:absolute;left:154px;top:634px;white-space:pre;"><span class="cls_4">base</span><span class="cls_1">.BlinkBoxView(index);</span></div><div style="position:absolute;left:132px;top:647px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:132px;top:674px;white-space:pre;"><span class="cls_4">protected override void </span><span class="cls_1">EndGame()</span></div><div style="position:absolute;left:132px;top:687px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:700px;white-space:pre;"><span class="cls_2">SoundPlayer</span><span class="cls_1">.PlaySound(65.4, errorDuration);</span></div><div style="position:absolute;left:154px;top:714px;white-space:pre;"><span class="cls_4">base</span><span class="cls_1">.EndGame();</span></div><div style="position:absolute;left:132px;top:727px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:740px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:754px;white-space:pre;"><span class="cls_1">}</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 9</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Platform-specific API calls</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">193</span></div><div style="position:absolute;left:127px;top:72px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">SoundPlayer.PlaySound</span><span class="cls_0">method accepts a frequency and a duration in milliseconds. Every-</span></div><div style="position:absolute;left:111px;top:90px;white-space:pre;"><span class="cls_0">thing else</span><span class="cls_0">—</span><span class="cls_0">the volume, the harmonic makeup of the sound, and how the sound is generated</span><span class="cls_0">—</span><span class="cls_0">is the</span></div><div style="position:absolute;left:111px;top:107px;white-space:pre;"><span class="cls_0">responsibility of the </span><span class="cls_5">PlaySound</span><span class="cls_0">method. However, this code makes an implicit assumption that</span></div><div style="position:absolute;left:111px;top:124px;white-space:pre;"><span class="cls_5">SoundPlayer.PlaySound</span><span class="cls_0">returns immediately and does not wait for the sound to complete playing.</span></div><div style="position:absolute;left:111px;top:142px;white-space:pre;"><span class="cls_0">Fortunately, all three platforms support sound-generation APIs that behave in this way.</span></div><div style="position:absolute;left:127px;top:168px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">SoundPlayer</span><span class="cls_0">class with the </span><span class="cls_5">PlaySound</span><span class="cls_0">static method is part of the </span><span class="cls_13">MonkeyTapWithSound</span></div><div style="position:absolute;left:111px;top:186px;white-space:pre;"><span class="cls_0">PCL project. The responsibility of this method is to define an array of the PCM data for the sound. The</span></div><div style="position:absolute;left:111px;top:203px;white-space:pre;"><span class="cls_0">size of this array is based on the sampling rate and the duration. The </span><span class="cls_5">for</span><span class="cls_0">loop calculates samples that</span></div><div style="position:absolute;left:111px;top:220px;white-space:pre;"><span class="cls_0">define a triangle wave of the requested frequency:</span></div><div style="position:absolute;left:111px;top:246px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">MonkeyTapWithSound</span></div><div style="position:absolute;left:111px;top:259px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:272px;white-space:pre;"><span class="cls_4">class </span><span class="cls_2">SoundPlayer</span></div><div style="position:absolute;left:133px;top:286px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:299px;white-space:pre;"><span class="cls_4">const int </span><span class="cls_1">samplingRate = 22050;</span></div><div style="position:absolute;left:156px;top:326px;white-space:pre;"><span class="cls_3">// Hard-coded for monaural, 16-bit-per-sample PCM</span></div><div style="position:absolute;left:156px;top:339px;white-space:pre;"><span class="cls_4">public static void </span><span class="cls_1">PlaySound(</span><span class="cls_4">double </span><span class="cls_1">frequency = 440, </span><span class="cls_4">int </span><span class="cls_1">duration = 250)</span></div><div style="position:absolute;left:156px;top:352px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:366px;white-space:pre;"><span class="cls_4">short</span><span class="cls_1">[] shortBuffer = </span><span class="cls_4">new short</span><span class="cls_1">[samplingRate * duration / 1000];</span></div><div style="position:absolute;left:178px;top:379px;white-space:pre;"><span class="cls_4">double </span><span class="cls_1">angleIncrement = frequency / samplingRate;</span></div><div style="position:absolute;left:178px;top:392px;white-space:pre;"><span class="cls_4">double </span><span class="cls_1">angle = 0;</span></div><div style="position:absolute;left:291px;top:392px;white-space:pre;"><span class="cls_3">// normalized 0 to 1</span></div><div style="position:absolute;left:178px;top:419px;white-space:pre;"><span class="cls_4">for </span><span class="cls_1">(</span><span class="cls_4">int </span><span class="cls_1">i = 0; i < shortBuffer.Length; i++)</span></div><div style="position:absolute;left:178px;top:432px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:201px;top:446px;white-space:pre;"><span class="cls_3">// Define triangle wave</span></div><div style="position:absolute;left:201px;top:459px;white-space:pre;"><span class="cls_4">double </span><span class="cls_1">sample;</span></div><div style="position:absolute;left:201px;top:486px;white-space:pre;"><span class="cls_3">// 0 to 1</span></div><div style="position:absolute;left:201px;top:499px;white-space:pre;"><span class="cls_4">if </span><span class="cls_1">(angle < 0.25)</span></div><div style="position:absolute;left:223px;top:512px;white-space:pre;"><span class="cls_1">sample = 4 * angle;</span></div><div style="position:absolute;left:201px;top:539px;white-space:pre;"><span class="cls_3">// 1 to -1</span></div><div style="position:absolute;left:201px;top:552px;white-space:pre;"><span class="cls_4">else if </span><span class="cls_1">(angle < 0.75)</span></div><div style="position:absolute;left:223px;top:566px;white-space:pre;"><span class="cls_1">sample = 4 * (0.5 - angle);</span></div><div style="position:absolute;left:201px;top:592px;white-space:pre;"><span class="cls_3">// -1 to 0</span></div><div style="position:absolute;left:201px;top:606px;white-space:pre;"><span class="cls_4">else</span></div><div style="position:absolute;left:223px;top:619px;white-space:pre;"><span class="cls_1">sample = 4 * (angle - 1);</span></div><div style="position:absolute;left:201px;top:646px;white-space:pre;"><span class="cls_1">shortBuffer[i] = (</span><span class="cls_4">short</span><span class="cls_1">)(32767 * sample);</span></div><div style="position:absolute;left:201px;top:659px;white-space:pre;"><span class="cls_1">angle += angleIncrement;</span></div><div style="position:absolute;left:201px;top:686px;white-space:pre;"><span class="cls_4">while </span><span class="cls_1">(angle > 1)</span></div><div style="position:absolute;left:223px;top:699px;white-space:pre;"><span class="cls_1">angle -= 1;</span></div><div style="position:absolute;left:178px;top:712px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:178px;top:739px;white-space:pre;"><span class="cls_4">byte</span><span class="cls_1">[] byteBuffer = </span><span class="cls_4">new byte</span><span class="cls_1">[2 * shortBuffer.Length];</span></div><div style="position:absolute;left:178px;top:752px;white-space:pre;"><span class="cls_2">Buffer</span><span class="cls_1">.BlockCopy(shortBuffer, 0, byteBuffer, 0, byteBuffer.Length);</span></div><div style="position:absolute;left:178px;top:779px;white-space:pre;"><span class="cls_2">DependencyService</span><span class="cls_1">.Get<</span><span class="cls_2">IPlatformSoundPlayer</span><span class="cls_1">>().PlaySound(samplingRate, byteBuffer);</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 9</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Platform-specific API calls</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">194</span></div><div style="position:absolute;left:132px;top:71px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:84px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:98px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:123px;white-space:pre;"><span class="cls_0">Although the samples are 16-bit integers, two of the platforms want the data in the form of an array of</span></div><div style="position:absolute;left:87px;top:140px;white-space:pre;"><span class="cls_0">bytes, so a conversion occurs near the end with </span><span class="cls_5">Buffer.BlockCopy</span><span class="cls_0">. The last line of the method uses</span></div><div style="position:absolute;left:87px;top:158px;white-space:pre;"><span class="cls_5">DependencyService</span><span class="cls_0">to pass this byte array with the sampling rate to the individual platforms.</span></div><div style="position:absolute;left:103px;top:184px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">DependencyService.Get</span><span class="cls_0">method references the </span><span class="cls_5">IPlatformSoundPlayer</span><span class="cls_0">interface that de-</span></div><div style="position:absolute;left:87px;top:202px;white-space:pre;"><span class="cls_0">fines the signature of the </span><span class="cls_5">PlaySound</span><span class="cls_0">method:</span></div><div style="position:absolute;left:87px;top:227px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">MonkeyTapWithSound</span></div><div style="position:absolute;left:87px;top:240px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:254px;white-space:pre;"><span class="cls_4">public interface </span><span class="cls_2">IPlatformSoundPlayer</span></div><div style="position:absolute;left:109px;top:267px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:280px;white-space:pre;"><span class="cls_4">void </span><span class="cls_1">PlaySound(</span><span class="cls_4">int </span><span class="cls_1">samplingRate, </span><span class="cls_4">byte</span><span class="cls_1">[] pcmData);</span></div><div style="position:absolute;left:109px;top:294px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:307px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:103px;top:332px;white-space:pre;"><span class="cls_0">Now comes the hard part: writing this </span><span class="cls_5">PlaySound</span><span class="cls_0">method for the three platforms!</span></div><div style="position:absolute;left:103px;top:359px;white-space:pre;"><span class="cls_0">The iOS version uses </span><span class="cls_5">AVAudioPlayer</span><span class="cls_0">, which requires data that includes the header used in Wave-</span></div><div style="position:absolute;left:87px;top:376px;white-space:pre;"><span class="cls_0">form Audio File Format (.wav) files. The code here assembles that data in a </span><span class="cls_5">MemoryBuffer</span><span class="cls_0">and then</span></div><div style="position:absolute;left:87px;top:394px;white-space:pre;"><span class="cls_0">converts that to an </span><span class="cls_5">NSData</span><span class="cls_0">object:</span></div><div style="position:absolute;left:87px;top:419px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">System;</span></div><div style="position:absolute;left:87px;top:432px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">System.IO;</span></div><div style="position:absolute;left:87px;top:446px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">System.Text;</span></div><div style="position:absolute;left:87px;top:459px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Xamarin.Forms;</span></div><div style="position:absolute;left:87px;top:472px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">AVFoundation;</span></div><div style="position:absolute;left:87px;top:486px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Foundation;</span></div><div style="position:absolute;left:87px;top:512px;white-space:pre;"><span class="cls_1">[</span><span class="cls_4">assembly</span><span class="cls_1">: </span><span class="cls_2">Dependency</span><span class="cls_1">(</span><span class="cls_4">typeof</span><span class="cls_1">(MonkeyTapWithSound.iOS.</span><span class="cls_2">PlatformSoundPlayer</span><span class="cls_1">))]</span></div><div style="position:absolute;left:87px;top:539px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">MonkeyTapWithSound.iOS</span></div><div style="position:absolute;left:87px;top:552px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:566px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">PlatformSoundPlayer </span><span class="cls_1">: </span><span class="cls_2">IPlatformSoundPlayer</span></div><div style="position:absolute;left:109px;top:579px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:592px;white-space:pre;"><span class="cls_4">const int </span><span class="cls_1">numChannels = 1;</span></div><div style="position:absolute;left:132px;top:606px;white-space:pre;"><span class="cls_4">const int </span><span class="cls_1">bitsPerSample = 16;</span></div><div style="position:absolute;left:132px;top:632px;white-space:pre;"><span class="cls_4">public void </span><span class="cls_1">PlaySound(</span><span class="cls_4">int </span><span class="cls_1">samplingRate, </span><span class="cls_4">byte</span><span class="cls_1">[] pcmData)</span></div><div style="position:absolute;left:132px;top:646px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:659px;white-space:pre;"><span class="cls_4">int </span><span class="cls_1">numSamples = pcmData.Length / (bitsPerSample / 8);</span></div><div style="position:absolute;left:154px;top:686px;white-space:pre;"><span class="cls_2">MemoryStream </span><span class="cls_1">memoryStream = </span><span class="cls_4">new </span><span class="cls_2">MemoryStream</span><span class="cls_1">();</span></div><div style="position:absolute;left:154px;top:699px;white-space:pre;"><span class="cls_2">BinaryWriter </span><span class="cls_1">writer = </span><span class="cls_4">new </span><span class="cls_2">BinaryWriter</span><span class="cls_1">(memoryStream, </span><span class="cls_2">Encoding</span><span class="cls_1">.ASCII);</span></div><div style="position:absolute;left:154px;top:726px;white-space:pre;"><span class="cls_3">// Construct WAVE header.</span></div><div style="position:absolute;left:154px;top:739px;white-space:pre;"><span class="cls_1">writer.Write(</span><span class="cls_4">new char</span><span class="cls_1">[] { </span><span class="cls_6">'R'</span><span class="cls_1">, </span><span class="cls_6">'I'</span><span class="cls_1">, </span><span class="cls_6">'F'</span><span class="cls_1">, </span><span class="cls_6">'F' </span><span class="cls_1">});</span></div><div style="position:absolute;left:154px;top:752px;white-space:pre;"><span class="cls_1">writer.Write(36 + </span><span class="cls_4">sizeof</span><span class="cls_1">(</span><span class="cls_4">short</span><span class="cls_1">) * numSamples);</span></div><div style="position:absolute;left:154px;top:766px;white-space:pre;"><span class="cls_1">writer.Write(</span><span class="cls_4">new char</span><span class="cls_1">[] { </span><span class="cls_6">'W'</span><span class="cls_1">, </span><span class="cls_6">'A'</span><span class="cls_1">, </span><span class="cls_6">'V'</span><span class="cls_1">, </span><span class="cls_6">'E' </span><span class="cls_1">});</span></div><div style="position:absolute;left:154px;top:779px;white-space:pre;"><span class="cls_1">writer.Write(</span><span class="cls_4">new char</span><span class="cls_1">[] { </span><span class="cls_6">'f'</span><span class="cls_1">, </span><span class="cls_6">'m'</span><span class="cls_1">, </span><span class="cls_6">'t'</span><span class="cls_1">, </span><span class="cls_6">' ' </span><span class="cls_1">});</span></div><div style="position:absolute;left:514px;top:779px;white-space:pre;"><span class="cls_3">// format chunk</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 9</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Platform-specific API calls</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">195</span></div><div style="position:absolute;left:178px;top:71px;white-space:pre;"><span class="cls_1">writer.Write(16);</span></div><div style="position:absolute;left:538px;top:71px;white-space:pre;"><span class="cls_3">// PCM chunk size</span></div><div style="position:absolute;left:178px;top:84px;white-space:pre;"><span class="cls_1">writer.Write((</span><span class="cls_4">short</span><span class="cls_1">)1);</span></div><div style="position:absolute;left:538px;top:84px;white-space:pre;"><span class="cls_3">// PCM format flag</span></div><div style="position:absolute;left:178px;top:98px;white-space:pre;"><span class="cls_1">writer.Write((</span><span class="cls_4">short</span><span class="cls_1">)numChannels);</span></div><div style="position:absolute;left:178px;top:111px;white-space:pre;"><span class="cls_1">writer.Write(samplingRate);</span></div><div style="position:absolute;left:178px;top:124px;white-space:pre;"><span class="cls_1">writer.Write(samplingRate * numChannels * bitsPerSample / 8);</span></div><div style="position:absolute;left:538px;top:124px;white-space:pre;"><span class="cls_3">// byte rate</span></div><div style="position:absolute;left:178px;top:138px;white-space:pre;"><span class="cls_1">writer.Write((</span><span class="cls_4">short</span><span class="cls_1">)(numChannels * bitsPerSample / 8));</span></div><div style="position:absolute;left:538px;top:138px;white-space:pre;"><span class="cls_3">// block align</span></div><div style="position:absolute;left:178px;top:151px;white-space:pre;"><span class="cls_1">writer.Write((</span><span class="cls_4">short</span><span class="cls_1">)bitsPerSample);</span></div><div style="position:absolute;left:178px;top:164px;white-space:pre;"><span class="cls_1">writer.Write(</span><span class="cls_4">new char</span><span class="cls_1">[] { </span><span class="cls_6">'d'</span><span class="cls_1">, </span><span class="cls_6">'a'</span><span class="cls_1">, </span><span class="cls_6">'t'</span><span class="cls_1">, </span><span class="cls_6">'a' </span><span class="cls_1">});</span></div><div style="position:absolute;left:538px;top:164px;white-space:pre;"><span class="cls_3">// data chunk</span></div><div style="position:absolute;left:178px;top:178px;white-space:pre;"><span class="cls_1">writer.Write(numSamples * numChannels * bitsPerSample / 8);</span></div><div style="position:absolute;left:178px;top:204px;white-space:pre;"><span class="cls_3">// Write data as well.</span></div><div style="position:absolute;left:178px;top:218px;white-space:pre;"><span class="cls_1">writer.Write(pcmData, 0, pcmData.Length);</span></div><div style="position:absolute;left:178px;top:244px;white-space:pre;"><span class="cls_1">memoryStream.Seek(0, </span><span class="cls_2">SeekOrigin</span><span class="cls_1">.Begin);</span></div><div style="position:absolute;left:178px;top:258px;white-space:pre;"><span class="cls_2">NSData </span><span class="cls_1">data = </span><span class="cls_2">NSData</span><span class="cls_1">.FromStream(memoryStream);</span></div><div style="position:absolute;left:178px;top:271px;white-space:pre;"><span class="cls_2">AVAudioPlayer </span><span class="cls_1">audioPlayer = </span><span class="cls_2">AVAudioPlayer</span><span class="cls_1">.FromData(data);</span></div><div style="position:absolute;left:178px;top:284px;white-space:pre;"><span class="cls_1">audioPlayer.Play();</span></div><div style="position:absolute;left:156px;top:298px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:133px;top:311px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:324px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:350px;white-space:pre;"><span class="cls_0">Notice the two essentials: </span><span class="cls_5">PlatformSoundPlayer</span><span class="cls_0">implements the </span><span class="cls_5">IPlatformSoundPlayer</span><span class="cls_0">inter-</span></div><div style="position:absolute;left:111px;top:367px;white-space:pre;"><span class="cls_0">face, and the class is flagged with the </span><span class="cls_5">Dependency</span><span class="cls_0">attribute.</span></div><div style="position:absolute;left:127px;top:394px;white-space:pre;"><span class="cls_0">The Android version uses the </span><span class="cls_5">AudioTrack</span><span class="cls_0">class, and that turns out to be a little easier. However,</span></div><div style="position:absolute;left:111px;top:411px;white-space:pre;"><span class="cls_5">AudioTrack</span><span class="cls_0">objects can’t overlap, so it’s necessary to save the previous object and stop it playing be-</span></div><div style="position:absolute;left:111px;top:428px;white-space:pre;"><span class="cls_0">fore starting the next one:</span></div><div style="position:absolute;left:111px;top:454px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">System;</span></div><div style="position:absolute;left:111px;top:467px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Android.Media;</span></div><div style="position:absolute;left:111px;top:480px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Xamarin.Forms;</span></div><div style="position:absolute;left:111px;top:507px;white-space:pre;"><span class="cls_1">[</span><span class="cls_4">assembly</span><span class="cls_1">: </span><span class="cls_2">Dependency</span><span class="cls_1">(</span><span class="cls_4">typeof</span><span class="cls_1">(MonkeyTapWithSound.Droid.</span><span class="cls_2">PlatformSoundPlayer</span><span class="cls_1">))]</span></div><div style="position:absolute;left:111px;top:534px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">MonkeyTapWithSound.Droid</span></div><div style="position:absolute;left:111px;top:547px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:560px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">PlatformSoundPlayer </span><span class="cls_1">: </span><span class="cls_2">IPlatformSoundPlayer</span></div><div style="position:absolute;left:133px;top:574px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:587px;white-space:pre;"><span class="cls_2">AudioTrack </span><span class="cls_1">previousAudioTrack;</span></div><div style="position:absolute;left:156px;top:614px;white-space:pre;"><span class="cls_4">public void </span><span class="cls_1">PlaySound(</span><span class="cls_4">int </span><span class="cls_1">samplingRate, </span><span class="cls_4">byte</span><span class="cls_1">[] pcmData)</span></div><div style="position:absolute;left:156px;top:627px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:640px;white-space:pre;"><span class="cls_4">if </span><span class="cls_1">(previousAudioTrack != </span><span class="cls_4">null</span><span class="cls_1">)</span></div><div style="position:absolute;left:178px;top:654px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:201px;top:667px;white-space:pre;"><span class="cls_1">previousAudioTrack.Stop();</span></div><div style="position:absolute;left:201px;top:680px;white-space:pre;"><span class="cls_1">previousAudioTrack.Release();</span></div><div style="position:absolute;left:178px;top:694px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:178px;top:720px;white-space:pre;"><span class="cls_2">AudioTrack </span><span class="cls_1">audioTrack = </span><span class="cls_4">new </span><span class="cls_2">AudioTrack</span><span class="cls_1">(</span><span class="cls_2">Stream</span><span class="cls_1">.Music,</span></div><div style="position:absolute;left:398px;top:734px;white-space:pre;"><span class="cls_1">samplingRate,</span></div><div style="position:absolute;left:398px;top:747px;white-space:pre;"><span class="cls_2">ChannelOut</span><span class="cls_1">.Mono,</span></div><div style="position:absolute;left:398px;top:760px;white-space:pre;"><span class="cls_1">Android.Media.</span><span class="cls_2">Encoding</span><span class="cls_1">.Pcm16bit,</span></div><div style="position:absolute;left:398px;top:774px;white-space:pre;"><span class="cls_1">pcmData.Length * </span><span class="cls_4">sizeof</span><span class="cls_1">(</span><span class="cls_4">short</span><span class="cls_1">),</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 9</span></div><div style="position:absolute;left:150px;top:30px;white-space:pre;"><span class="cls_0">Platform-specific API calls</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">196</span></div><div style="position:absolute;left:374px;top:71px;white-space:pre;"><span class="cls_2">AudioTrackMode</span><span class="cls_1">.Static);</span></div><div style="position:absolute;left:154px;top:98px;white-space:pre;"><span class="cls_1">audioTrack.Write(pcmData, 0, pcmData.Length);</span></div><div style="position:absolute;left:154px;top:111px;white-space:pre;"><span class="cls_1">audioTrack.Play();</span></div><div style="position:absolute;left:154px;top:138px;white-space:pre;"><span class="cls_1">previousAudioTrack = audioTrack;</span></div><div style="position:absolute;left:132px;top:151px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:164px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:178px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:103px;top:203px;white-space:pre;"><span class="cls_0">The three Windows and Windows Phone platforms can use </span><span class="cls_5">MediaStreamSource</span><span class="cls_0">. To avoid a lot of</span></div><div style="position:absolute;left:87px;top:220px;white-space:pre;"><span class="cls_0">repetitive code, the </span><span class="cls_13">MonkeyTapWithSound</span><span class="cls_0"> </span><span class="cls_0">solution contains an additional SAP project named</span></div><div style="position:absolute;left:87px;top:238px;white-space:pre;"><span class="cls_13">WinRuntimeShared</span><span class="cls_0"> </span><span class="cls_0">consisting solely of a class that all three platforms can use:</span></div><div style="position:absolute;left:87px;top:263px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">System;</span></div><div style="position:absolute;left:87px;top:276px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">System.Runtime.InteropServices.WindowsRuntime;</span></div><div style="position:absolute;left:87px;top:290px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Windows.Media.Core;</span></div><div style="position:absolute;left:87px;top:303px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Windows.Media.MediaProperties;</span></div><div style="position:absolute;left:87px;top:316px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Windows.Storage.Streams;</span></div><div style="position:absolute;left:87px;top:330px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Windows.UI.Xaml.Controls;</span></div><div style="position:absolute;left:87px;top:356px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">MonkeyTapWithSound.WinRuntimeShared</span></div><div style="position:absolute;left:87px;top:370px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:383px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">SharedSoundPlayer</span></div><div style="position:absolute;left:109px;top:396px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:410px;white-space:pre;"><span class="cls_2">MediaElement </span><span class="cls_1">mediaElement = </span><span class="cls_4">new </span><span class="cls_2">MediaElement</span><span class="cls_1">();</span></div><div style="position:absolute;left:132px;top:423px;white-space:pre;"><span class="cls_2">TimeSpan </span><span class="cls_1">duration;</span></div><div style="position:absolute;left:132px;top:450px;white-space:pre;"><span class="cls_4">public void </span><span class="cls_1">PlaySound(</span><span class="cls_4">int </span><span class="cls_1">samplingRate, </span><span class="cls_4">byte</span><span class="cls_1">[] pcmData)</span></div><div style="position:absolute;left:132px;top:463px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:154px;top:476px;white-space:pre;"><span class="cls_2">AudioEncodingProperties </span><span class="cls_1">audioProps =</span></div><div style="position:absolute;left:177px;top:490px;white-space:pre;"><span class="cls_2">AudioEncodingProperties</span><span class="cls_1">.CreatePcm((</span><span class="cls_4">uint</span><span class="cls_1">)samplingRate, 1, 16);</span></div><div style="position:absolute;left:154px;top:503px;white-space:pre;"><span class="cls_2">AudioStreamDescriptor </span><span class="cls_1">audioDesc = </span><span class="cls_4">new </span><span class="cls_2">AudioStreamDescriptor</span><span class="cls_1">(audioProps);</span></div><div style="position:absolute;left:154px;top:516px;white-space:pre;"><span class="cls_2">MediaStreamSource </span><span class="cls_1">mss = </span><span class="cls_4">new </span><span class="cls_2">MediaStreamSource</span><span class="cls_1">(audioDesc);</span></div><div style="position:absolute;left:154px;top:543px;white-space:pre;"><span class="cls_4">bool </span><span class="cls_1">samplePlayed = </span><span class="cls_4">false</span><span class="cls_1">;</span></div><div style="position:absolute;left:154px;top:556px;white-space:pre;"><span class="cls_1">mss.SampleRequested += (sender, args) =></span></div><div style="position:absolute;left:154px;top:570px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:177px;top:583px;white-space:pre;"><span class="cls_4">if </span><span class="cls_1">(samplePlayed)</span></div><div style="position:absolute;left:199px;top:596px;white-space:pre;"><span class="cls_4">return</span><span class="cls_1">;</span></div><div style="position:absolute;left:177px;top:623px;white-space:pre;"><span class="cls_2">IBuffer </span><span class="cls_1">ibuffer = pcmData.AsBuffer();</span></div><div style="position:absolute;left:177px;top:636px;white-space:pre;"><span class="cls_2">MediaStreamSample </span><span class="cls_1">sample =</span></div><div style="position:absolute;left:199px;top:650px;white-space:pre;"><span class="cls_2">MediaStreamSample</span><span class="cls_1">.CreateFromBuffer(ibuffer, </span><span class="cls_2">TimeSpan</span><span class="cls_1">.Zero);</span></div><div style="position:absolute;left:177px;top:663px;white-space:pre;"><span class="cls_1">sample.Duration = </span><span class="cls_2">TimeSpan</span><span class="cls_1">.FromSeconds(pcmData.Length / 2.0 / samplingRate);</span></div><div style="position:absolute;left:177px;top:676px;white-space:pre;"><span class="cls_1">args.Request.Sample = sample;</span></div><div style="position:absolute;left:177px;top:690px;white-space:pre;"><span class="cls_1">samplePlayed = </span><span class="cls_4">true</span><span class="cls_1">;</span></div><div style="position:absolute;left:154px;top:703px;white-space:pre;"><span class="cls_1">};</span></div><div style="position:absolute;left:154px;top:730px;white-space:pre;"><span class="cls_1">mediaElement.SetMediaStreamSource(mss);</span></div><div style="position:absolute;left:132px;top:743px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:109px;top:756px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:770px;white-space:pre;"><span class="cls_1">}</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 9</span></div><div style="position:absolute;left:174px;top:30px;white-space:pre;"><span class="cls_0">Platform-specific API calls</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">197</span></div><div style="position:absolute;left:127px;top:72px;white-space:pre;"><span class="cls_0">This SAP project is referenced by the three Windows and Windows Phone projects, each of which</span></div><div style="position:absolute;left:111px;top:90px;white-space:pre;"><span class="cls_0">contains an identical (except for the namespace) </span><span class="cls_5">PlatformSoundPlayer</span><span class="cls_0">class:</span></div><div style="position:absolute;left:111px;top:115px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">System;</span></div><div style="position:absolute;left:111px;top:128px;white-space:pre;"><span class="cls_4">using </span><span class="cls_1">Xamarin.Forms;</span></div><div style="position:absolute;left:111px;top:155px;white-space:pre;"><span class="cls_1">[</span><span class="cls_4">assembly</span><span class="cls_1">: </span><span class="cls_2">Dependency</span><span class="cls_1">(</span><span class="cls_4">typeof</span><span class="cls_1">(MonkeyTapWithSound.UWP.</span><span class="cls_2">PlatformSoundPlayer</span><span class="cls_1">))]</span></div><div style="position:absolute;left:111px;top:182px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">MonkeyTapWithSound.UWP</span></div><div style="position:absolute;left:111px;top:195px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:208px;white-space:pre;"><span class="cls_4">public class </span><span class="cls_2">PlatformSoundPlayer </span><span class="cls_1">: IPlatformSoundPlayer</span></div><div style="position:absolute;left:133px;top:222px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:156px;top:235px;white-space:pre;"><span class="cls_1">WinRuntimeShared.</span><span class="cls_2">SharedSoundPlayer </span><span class="cls_1">sharedSoundPlayer;</span></div><div style="position:absolute;left:156px;top:262px;white-space:pre;"><span class="cls_4">public void </span><span class="cls_1">PlaySound(</span><span class="cls_4">int </span><span class="cls_1">samplingRate, </span><span class="cls_4">byte</span><span class="cls_1">[] pcmData)</span></div><div style="position:absolute;left:156px;top:275px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:178px;top:288px;white-space:pre;"><span class="cls_4">if </span><span class="cls_1">(sharedSoundPlayer == </span><span class="cls_4">null</span><span class="cls_1">)</span></div><div style="position:absolute;left:178px;top:302px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:201px;top:315px;white-space:pre;"><span class="cls_1">sharedSoundPlayer = </span><span class="cls_4">new </span><span class="cls_1">WinRuntimeShared.</span><span class="cls_2">SharedSoundPlayer</span><span class="cls_1">();</span></div><div style="position:absolute;left:178px;top:328px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:178px;top:355px;white-space:pre;"><span class="cls_1">sharedSoundPlayer.PlaySound(samplingRate, pcmData);</span></div><div style="position:absolute;left:156px;top:368px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:133px;top:382px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:395px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:127px;top:420px;white-space:pre;"><span class="cls_0">The use of </span><span class="cls_5">DependencyService</span><span class="cls_0">to perform platform-specific chores is very powerful, but this ap-</span></div><div style="position:absolute;left:111px;top:438px;white-space:pre;"><span class="cls_0">proach falls short when it comes to user-interface elements. If you need to expand the arsenal of views</span></div><div style="position:absolute;left:111px;top:455px;white-space:pre;"><span class="cls_0">that adorn the pages of your Xamarin.Forms applications, that job involves creating platform-specific</span></div><div style="position:absolute;left:111px;top:472px;white-space:pre;"><span class="cls_0">renderers, a process discussed in the final chapter of this book.</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image113.png" width="708" height="864" alt=""></div><div style="position:absolute;left:55px;top:74px;white-space:pre;"><span class="cls_7">Chapter 10</span></div><div style="position:absolute;left:55px;top:94px;white-space:pre;"><span class="cls_8">XAML</span><span class="cls_15"> </span><span class="cls_8">markup</span></div><div style="position:absolute;left:289px;top:94px;white-space:pre;"><span class="cls_8">extensions</span></div><div style="position:absolute;left:87px;top:168px;white-space:pre;"><span class="cls_0">In code, you can set a property in a variety of different ways from a variety of different sources:</span></div><div style="position:absolute;left:87px;top:194px;white-space:pre;"><span class="cls_1">triangle.Angle1 = 45;</span></div><div style="position:absolute;left:87px;top:207px;white-space:pre;"><span class="cls_1">triangle.Angle1 = 180 * radians / Math.PI;</span></div><div style="position:absolute;left:87px;top:220px;white-space:pre;"><span class="cls_1">triangle.Angle1 = angles[i];</span></div><div style="position:absolute;left:87px;top:234px;white-space:pre;"><span class="cls_1">triangle.Angle1 = animator.GetCurrentAngle();</span></div><div style="position:absolute;left:87px;top:259px;white-space:pre;"><span class="cls_0">If this </span><span class="cls_5">Angle1</span><span class="cls_0">property is a </span><span class="cls_5">double</span><span class="cls_0">, all that’s requi</span><span class="cls_0">red is that the source be a </span><span class="cls_5">double</span><span class="cls_0">or otherwise pro-</span></div><div style="position:absolute;left:87px;top:276px;white-space:pre;"><span class="cls_0">vide a numeric value that is convertible to a </span><span class="cls_5">double</span><span class="cls_0">.</span></div><div style="position:absolute;left:103px;top:303px;white-space:pre;"><span class="cls_0">In markup, however, a property of type </span><span class="cls_5">double</span><span class="cls_0">usually can be set only from a string that qualifies</span></div><div style="position:absolute;left:87px;top:320px;white-space:pre;"><span class="cls_0">as a valid argument to </span><span class="cls_5">Double.Parse</span><span class="cls_0">. The only except</span><span class="cls_0">ion you’ve seen so far is when the target prop-</span></div><div style="position:absolute;left:87px;top:338px;white-space:pre;"><span class="cls_0">erty is flagged with a </span><span class="cls_5">TypeConverter</span><span class="cls_0">attribute, such as the </span><span class="cls_5">FontSize</span><span class="cls_0">property.</span></div><div style="position:absolute;left:103px;top:364px;white-space:pre;"><span class="cls_0">It might be desirable if XAML were more flexible</span><span class="cls_0">—</span><span class="cls_0">if you could set a property from sources other</span></div><div style="position:absolute;left:87px;top:382px;white-space:pre;"><span class="cls_0">than explicit text strings. For example, suppose you want to define another way to set a property of</span></div><div style="position:absolute;left:87px;top:399px;white-space:pre;"><span class="cls_0">type </span><span class="cls_5">Color</span><span class="cls_0">, perhaps using the </span><span class="cls_5">Hue</span><span class="cls_0">, </span><span class="cls_5">Saturation</span><span class="cls_0">, and </span><span class="cls_5">Luminosity</span><span class="cls_0">values but without the hassle of</span></div><div style="position:absolute;left:87px;top:416px;white-space:pre;"><span class="cls_0">the </span><span class="cls_5">x:FactoryMethod</span><span class="cls_0">element. Just offhand, it doesn’t seem possible. The XAML parser expects th</span><span class="cls_0">at</span></div><div style="position:absolute;left:87px;top:434px;white-space:pre;"><span class="cls_0">any value set to an attribute of type </span><span class="cls_5">Color</span><span class="cls_0">is a string acceptable to the </span><span class="cls_5">ColorTypeConverter</span><span class="cls_0">class.</span></div><div style="position:absolute;left:103px;top:460px;white-space:pre;"><span class="cls_0">The purpose of XAML </span><span class="cls_9">markup</span><span class="cls_0"> </span><span class="cls_9">extensions</span><span class="cls_0"> </span><span class="cls_0">is to get around this apparent restriction. Rest assured that</span></div><div style="position:absolute;left:87px;top:478px;white-space:pre;"><span class="cls_0">XAML markup extensions are </span><span class="cls_9">not</span><span class="cls_0"> </span><span class="cls_0">extensions to XML. XAML is always legal XML. XAML markup exten-</span></div><div style="position:absolute;left:87px;top:495px;white-space:pre;"><span class="cls_0">sions are extensions only in the sense that they extend the possibilities of attribute settings in markup.</span></div><div style="position:absolute;left:87px;top:512px;white-space:pre;"><span class="cls_0">A markup extension essentially </span><span class="cls_9">provides</span><span class="cls_0"> </span><span class="cls_0">a value of a particular type without necessarily being a text</span></div><div style="position:absolute;left:87px;top:530px;white-space:pre;"><span class="cls_0">representation </span><span class="cls_9">of</span><span class="cls_0"> </span><span class="cls_0">a value.</span></div><div style="position:absolute;left:55px;top:569px;white-space:pre;"><span class="cls_11">The</span><span class="cls_12"> </span><span class="cls_11">code</span><span class="cls_12"> </span><span class="cls_11">infrastructure</span></div><div style="position:absolute;left:87px;top:618px;white-space:pre;"><span class="cls_0">Strictly speaking, a XAML markup extension is a class that implements </span><span class="cls_5">IMarkupExtension</span><span class="cls_0">, which is a</span></div><div style="position:absolute;left:87px;top:635px;white-space:pre;"><span class="cls_0">public interface defined in the regular </span><span class="cls_13">Xamarin.Forms.Core</span><span class="cls_0"> </span><span class="cls_0">assembly but with the namespace </span><span class="cls_5">Xama-</span></div><div style="position:absolute;left:87px;top:653px;white-space:pre;"><span class="cls_5">rin.Forms.Xaml</span><span class="cls_0">:</span></div><div style="position:absolute;left:87px;top:678px;white-space:pre;"><span class="cls_1">public interface IMarkupExtension</span></div><div style="position:absolute;left:87px;top:691px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:704px;white-space:pre;"><span class="cls_1">object ProvideValue(IServiceProvider serviceProvider);</span></div><div style="position:absolute;left:87px;top:718px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:743px;white-space:pre;"><span class="cls_0">As the name suggests, </span><span class="cls_5">ProvideValue</span><span class="cls_0">is the method that provides a value to a XAML attribute.</span></div><div style="position:absolute;left:87px;top:761px;white-space:pre;"><span class="cls_5">IServiceProvider</span><span class="cls_0">is part of the base class libraries of .NET and defined in the </span><span class="cls_5">System</span><span class="cls_0">namespace:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 10</span></div><div style="position:absolute;left:181px;top:30px;white-space:pre;"><span class="cls_0">XAML markup extensions</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">199</span></div><div style="position:absolute;left:111px;top:71px;white-space:pre;"><span class="cls_1">public interface IServiceProvider</span></div><div style="position:absolute;left:111px;top:84px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:133px;top:98px;white-space:pre;"><span class="cls_1">object GetService(Type type);</span></div><div style="position:absolute;left:111px;top:111px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:111px;top:136px;white-space:pre;"><span class="cls_0">Obviously, this information doesn’t provide much of a hint on writing custom markup extensions, and</span></div><div style="position:absolute;left:111px;top:154px;white-space:pre;"><span class="cls_0">in truth, they can be tricky. (You’ll see an example s</span><span class="cls_0">hortly and other examples later in this book.) Fortu-</span></div><div style="position:absolute;left:111px;top:171px;white-space:pre;"><span class="cls_0">nately, Xamarin.Forms provides several valuable markup extensions for you. These fall into three</span></div><div style="position:absolute;left:111px;top:188px;white-space:pre;"><span class="cls_0">categories:</span></div><div style="position:absolute;left:125px;top:214px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:215px;white-space:pre;"><span class="cls_0">Markup extensions that are part of the XAML 2009 specification. These appear in XAML files</span></div><div style="position:absolute;left:149px;top:232px;white-space:pre;"><span class="cls_0">with the customary </span><span class="cls_5">x</span><span class="cls_0">prefix and are:</span></div><div style="position:absolute;left:151px;top:257px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:175px;top:259px;white-space:pre;"><span class="cls_5">x:Static</span></div><div style="position:absolute;left:151px;top:284px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:175px;top:286px;white-space:pre;"><span class="cls_5">x:Reference</span></div><div style="position:absolute;left:151px;top:311px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:175px;top:313px;white-space:pre;"><span class="cls_5">x:Type</span></div><div style="position:absolute;left:151px;top:337px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:175px;top:339px;white-space:pre;"><span class="cls_5">x:Null</span></div><div style="position:absolute;left:151px;top:364px;white-space:pre;"><span class="cls_18"> </span></div><div style="position:absolute;left:175px;top:366px;white-space:pre;"><span class="cls_5">x:Array</span></div><div style="position:absolute;left:151px;top:392px;white-space:pre;"><span class="cls_0">These are implemented in classes that consist of the name of the markup extension with the</span></div><div style="position:absolute;left:151px;top:410px;white-space:pre;"><span class="cls_0">word </span><span class="cls_5">Extension</span><span class="cls_0">appended</span><span class="cls_0">—</span><span class="cls_0">for example, the </span><span class="cls_5">StaticExtension</span><span class="cls_0">and </span><span class="cls_5">ReferenceExtension</span></div><div style="position:absolute;left:151px;top:427px;white-space:pre;"><span class="cls_0">classes. These classes are defined in the </span><span class="cls_13">Xamarin.Forms.Xaml</span><span class="cls_0"> </span><span class="cls_0">assembly.</span></div><div style="position:absolute;left:125px;top:453px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:454px;white-space:pre;"><span class="cls_0">The following markup extensions originated in the Windows Presentation Foundation (WPF)</span></div><div style="position:absolute;left:149px;top:471px;white-space:pre;"><span class="cls_0">and, with the exception of </span><span class="cls_5">DynamicResource,</span><span class="cls_0">are supported by Microsoft’s other implemen-</span></div><div style="position:absolute;left:149px;top:488px;white-space:pre;"><span class="cls_0">tations of XAML, including Silverlight, Windows Phone 7 and 8, and Windows 8 and 10:</span></div><div style="position:absolute;left:151px;top:513px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:175px;top:516px;white-space:pre;"><span class="cls_5">StaticResource</span></div><div style="position:absolute;left:151px;top:540px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:175px;top:543px;white-space:pre;"><span class="cls_5">DynamicResource</span></div><div style="position:absolute;left:151px;top:567px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:175px;top:569px;white-space:pre;"><span class="cls_5">Binding</span></div><div style="position:absolute;left:151px;top:595px;white-space:pre;"><span class="cls_0">These are implemented in the public </span><span class="cls_5">StaticResourceExtension</span><span class="cls_0">, </span><span class="cls_5">DynamicResourceExten-</span></div><div style="position:absolute;left:151px;top:612px;white-space:pre;"><span class="cls_5">sion</span><span class="cls_0">, and </span><span class="cls_5">BindingExtension</span><span class="cls_0">classes.</span></div><div style="position:absolute;left:125px;top:638px;white-space:pre;"><span class="cls_10"> </span></div><div style="position:absolute;left:149px;top:639px;white-space:pre;"><span class="cls_0">There is only one markup extension that is unique to Xamarin.Forms: the </span><span class="cls_5">ConstraintExpres-</span></div><div style="position:absolute;left:149px;top:656px;white-space:pre;"><span class="cls_5">sion</span><span class="cls_0">class used in connection with </span><span class="cls_5">RelativeLayout</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:683px;white-space:pre;"><span class="cls_0">Although it’s possible to play around with public markup</span><span class="cls_0">-extension classes in code, they really only</span></div><div style="position:absolute;left:111px;top:700px;white-space:pre;"><span class="cls_0">make sense in XAML.</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image114.png" width="708" height="864" alt=""></div><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 10</span></div><div style="position:absolute;left:157px;top:30px;white-space:pre;"><span class="cls_0">XAML markup extensions</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">200</span></div><div style="position:absolute;left:55px;top:73px;white-space:pre;"><span class="cls_11">Accessing</span><span class="cls_12"> </span><span class="cls_11">static</span><span class="cls_12"> </span><span class="cls_11">members</span></div><div style="position:absolute;left:87px;top:122px;white-space:pre;"><span class="cls_0">One of the simplest and most useful implementations of </span><span class="cls_5">IMarkupExtension</span><span class="cls_0">is encapsulated in the</span></div><div style="position:absolute;left:87px;top:139px;white-space:pre;"><span class="cls_5">StaticExtension</span><span class="cls_0">class. This is part of the original XAML specification, so it customarily appears in</span></div><div style="position:absolute;left:87px;top:156px;white-space:pre;"><span class="cls_0">XAML with an </span><span class="cls_5">x</span><span class="cls_0">prefix. </span><span class="cls_5">StaticExtension</span><span class="cls_0">defines a single property named </span><span class="cls_5">Member</span><span class="cls_0">of type </span><span class="cls_5">string</span></div><div style="position:absolute;left:87px;top:174px;white-space:pre;"><span class="cls_0">that you set to a class and member name of a public constant, static property, static field, or enumera-</span></div><div style="position:absolute;left:87px;top:191px;white-space:pre;"><span class="cls_0">tion member.</span></div><div style="position:absolute;left:103px;top:218px;white-space:pre;"><span class="cls_0">Let’s see how this works. Here’s a </span><span class="cls_5">Label</span><span class="cls_0">with six properties set as they would normally appear in</span></div><div style="position:absolute;left:87px;top:235px;white-space:pre;"><span class="cls_0">XAML.</span></div><div style="position:absolute;left:87px;top:260px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Just some text</span><span class="cls_1">"</span></div><div style="position:absolute;left:126px;top:274px;white-space:pre;"><span class="cls_14">BackgroundColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Accent</span><span class="cls_1">"</span></div><div style="position:absolute;left:126px;top:287px;white-space:pre;"><span class="cls_14">TextColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Black</span><span class="cls_1">"</span></div><div style="position:absolute;left:126px;top:300px;white-space:pre;"><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Italic</span><span class="cls_1">"</span></div><div style="position:absolute;left:126px;top:314px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:126px;top:327px;white-space:pre;"><span class="cls_14">HorizontalTextAlignment</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:87px;top:352px;white-space:pre;"><span class="cls_0">Five of these attributes are set to text strings that eventually reference various static properties, fields,</span></div><div style="position:absolute;left:87px;top:370px;white-space:pre;"><span class="cls_0">and enumeration members, but the conversion of those text strings occurs through type converters</span></div><div style="position:absolute;left:87px;top:387px;white-space:pre;"><span class="cls_0">and the standard XAML parsing of enumeration types.</span></div><div style="position:absolute;left:103px;top:414px;white-space:pre;"><span class="cls_0">If you want to be more explicit in setting these attributes to those various static properties, fields,</span></div><div style="position:absolute;left:87px;top:431px;white-space:pre;"><span class="cls_0">and enumeration members, you can use </span><span class="cls_5">x:StaticExtension</span><span class="cls_0">within property element tags:</span></div><div style="position:absolute;left:87px;top:456px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Just some text</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:470px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.BackgroundColor</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:483px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:StaticExtension </span><span class="cls_14">Member</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Color.Accent</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:109px;top:496px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.BackgroundColor</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:523px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.TextColor</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:536px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:StaticExtension </span><span class="cls_14">Member</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Color.Black</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:109px;top:550px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.TextColor</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:576px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.FontAttributes</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:590px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:StaticExtension </span><span class="cls_14">Member</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">FontAttributes.Italic</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:109px;top:603px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.FontAttributes</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:630px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.VerticalOptions</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:643px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:StaticExtension </span><span class="cls_14">Member</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">LayoutOptions.Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:109px;top:656px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.VerticalOptions</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:683px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.HorizontalTextAlignment</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:696px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:StaticExtension </span><span class="cls_14">Member</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">TextAlignment.Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:109px;top:710px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.HorizontalTextAlignment</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:723px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:748px;white-space:pre;"><span class="cls_5">Color.Accent</span><span class="cls_0">is a static property. </span><span class="cls_5">Color.Black</span><span class="cls_0">and </span><span class="cls_5">LayoutOptions.Center</span><span class="cls_0">are static fields.</span></div><div style="position:absolute;left:87px;top:766px;white-space:pre;"><span class="cls_5">FontAttributes.Italic</span><span class="cls_0">and </span><span class="cls_5">TextAlignment.Center</span><span class="cls_0">are enumeration members.</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 10</span></div><div style="position:absolute;left:181px;top:30px;white-space:pre;"><span class="cls_0">XAML markup extensions</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">201</span></div><div style="position:absolute;left:127px;top:72px;white-space:pre;"><span class="cls_0">Considering the ease with which these attributes are set with text strings, the approach using </span><span class="cls_5">Stat-</span></div><div style="position:absolute;left:111px;top:90px;white-space:pre;"><span class="cls_5">icExtension</span><span class="cls_0">initial</span><span class="cls_0">ly seems ridiculous, but notice that it’s a general</span><span class="cls_0">-purpose mechanism. You can use</span></div><div style="position:absolute;left:111px;top:107px;white-space:pre;"><span class="cls_9">any</span><span class="cls_0"> </span><span class="cls_0">static property, field, or enumeration member in the </span><span class="cls_5">StaticExtension</span><span class="cls_0">tag if its type matches the</span></div><div style="position:absolute;left:111px;top:124px;white-space:pre;"><span class="cls_0">type of the target property.</span></div><div style="position:absolute;left:127px;top:151px;white-space:pre;"><span class="cls_0">By convention, classes that implement </span><span class="cls_5">IMarkupExtension</span><span class="cls_0">incorporate the word </span><span class="cls_5">Extension</span><span class="cls_0">in</span></div><div style="position:absolute;left:111px;top:168px;white-space:pre;"><span class="cls_0">their names, but you can leave that out in XAML, which is why this markup extension is usually called</span></div><div style="position:absolute;left:111px;top:186px;white-space:pre;"><span class="cls_5">x:Static</span><span class="cls_0">rather than </span><span class="cls_5">x:StaticExtension</span><span class="cls_0">. The following markup is marginally shorter than the pre-</span></div><div style="position:absolute;left:111px;top:203px;white-space:pre;"><span class="cls_0">vious block:</span></div><div style="position:absolute;left:111px;top:228px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Just some text</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:242px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.BackgroundColor</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:255px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Static </span><span class="cls_14">Member</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Color.Accent</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:133px;top:268px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.BackgroundColor</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:295px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.TextColor</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:308px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Static </span><span class="cls_14">Member</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Color.Black</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:133px;top:322px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.TextColor</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:348px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.FontAttributes</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:362px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Static </span><span class="cls_14">Member</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">FontAttributes.Italic</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:133px;top:375px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.FontAttributes</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:402px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.VerticalOptions</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:415px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Static </span><span class="cls_14">Member</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">LayoutOptions.Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:133px;top:428px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.VerticalOptions</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:455px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.HorizontalTextAlignment</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:468px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">x:Static </span><span class="cls_14">Member</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">TextAlignment.Center</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:133px;top:482px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.HorizontalTextAlignment</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:495px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label</span><span class="cls_4">></span></div><div style="position:absolute;left:127px;top:520px;white-space:pre;"><span class="cls_0">And now for the really major markup reduction</span><span class="cls_0">—</span><span class="cls_0">a change in syntax that causes the property-ele-</span></div><div style="position:absolute;left:111px;top:538px;white-space:pre;"><span class="cls_0">ment tags to disappear and the footprint to shrink considerably. XAML markup extensions almost al-</span></div><div style="position:absolute;left:111px;top:555px;white-space:pre;"><span class="cls_0">ways appear with the markup extension name and the arguments within a pair of curly braces:</span></div><div style="position:absolute;left:111px;top:580px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Just some text</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:594px;white-space:pre;"><span class="cls_14">BackgroundColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static Member=Color.Accent}</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:607px;white-space:pre;"><span class="cls_14">TextColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static Member=Color.Black}</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:620px;white-space:pre;"><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static Member=FontAttributes.Italic}</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:634px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static Member=LayoutOptions.Center}</span><span class="cls_1">"</span></div><div style="position:absolute;left:150px;top:647px;white-space:pre;"><span class="cls_14">HorizontalTextAlignment</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static Member=TextAlignment.Center}</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:127px;top:672px;white-space:pre;"><span class="cls_0">This syntax with the curly braces is so ubiquitously used in connection with XAML markup exten-</span></div><div style="position:absolute;left:111px;top:690px;white-space:pre;"><span class="cls_0">sions that many developers consider markup extensions to be synonymous with the curly-brace syntax.</span></div><div style="position:absolute;left:111px;top:707px;white-space:pre;"><span class="cls_0">And that’s nearly true: while curly braces always signal the presence of a XAML markup extension, in</span></div><div style="position:absolute;left:111px;top:724px;white-space:pre;"><span class="cls_0">many cases a markup extension can appear in XAML without the curly braces (as demonstrated earlier)</span></div><div style="position:absolute;left:111px;top:742px;white-space:pre;"><span class="cls_0">and it’s sometimes convenient to use them in that way.</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 10</span></div><div style="position:absolute;left:157px;top:30px;white-space:pre;"><span class="cls_0">XAML markup extensions</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">202</span></div><div style="position:absolute;left:103px;top:72px;white-space:pre;"><span class="cls_0">Notice there are no quotation marks within the curly braces. Within those braces, very different syn-</span></div><div style="position:absolute;left:87px;top:90px;white-space:pre;"><span class="cls_0">tax rules apply. The </span><span class="cls_5">Member</span><span class="cls_0">property of the </span><span class="cls_5">StaticExtension</span><span class="cls_0">class is no longer an XML attribute. In</span></div><div style="position:absolute;left:87px;top:107px;white-space:pre;"><span class="cls_0">terms of XML, the entire expression delimited by the curly braces is the value of the attribute, and the</span></div><div style="position:absolute;left:87px;top:124px;white-space:pre;"><span class="cls_0">arguments within the curly braces appear without quotation marks.</span></div><div style="position:absolute;left:103px;top:151px;white-space:pre;"><span class="cls_0">Just like elements, markup extensions can have a </span><span class="cls_5">ContentProperty</span><span class="cls_0">attribute. Markup extensions</span></div><div style="position:absolute;left:87px;top:168px;white-space:pre;"><span class="cls_0">that have only one property</span><span class="cls_0">—</span><span class="cls_0">such as the </span><span class="cls_5">StaticExtension</span><span class="cls_0">class with its single </span><span class="cls_5">Member</span><span class="cls_0">property</span><span class="cls_0">—</span></div><div style="position:absolute;left:87px;top:186px;white-space:pre;"><span class="cls_0">invariably mark that sole property as the content property. For markup extensions using the curly-</span></div><div style="position:absolute;left:87px;top:203px;white-space:pre;"><span class="cls_0">brace syntax, this means that the </span><span class="cls_5">Member</span><span class="cls_0">property name and the equal sign can be removed:</span></div><div style="position:absolute;left:87px;top:228px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Just some text</span><span class="cls_1">"</span></div><div style="position:absolute;left:126px;top:242px;white-space:pre;"><span class="cls_14">BackgroundColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static Color.Accent}</span><span class="cls_1">"</span></div><div style="position:absolute;left:126px;top:255px;white-space:pre;"><span class="cls_14">TextColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static Color.Black}</span><span class="cls_1">"</span></div><div style="position:absolute;left:126px;top:268px;white-space:pre;"><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static FontAttributes.Italic}</span><span class="cls_1">"</span></div><div style="position:absolute;left:126px;top:282px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static LayoutOptions.Center}</span><span class="cls_1">"</span></div><div style="position:absolute;left:126px;top:295px;white-space:pre;"><span class="cls_14">HorizontalTextAlignment</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static TextAlignment.Center}</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:87px;top:320px;white-space:pre;"><span class="cls_0">This is the common form of the </span><span class="cls_5">x:Static</span><span class="cls_0">markup extension.</span></div><div style="position:absolute;left:103px;top:347px;white-space:pre;"><span class="cls_0">Obviously, the use of </span><span class="cls_5">x:Static</span><span class="cls_0">for these particular properties is unnecessary, but you can define</span></div><div style="position:absolute;left:87px;top:364px;white-space:pre;"><span class="cls_0">your own static members for implementing application-wide constants, and you can reference these in</span></div><div style="position:absolute;left:87px;top:382px;white-space:pre;"><span class="cls_0">your XAML files. This is demonstrated in the </span><span class="cls_13">SharedStatics</span><span class="cls_0"> </span><span class="cls_0">project.</span></div><div style="position:absolute;left:103px;top:408px;white-space:pre;"><span class="cls_0">The </span><span class="cls_13">SharedStatics</span><span class="cls_0"> </span><span class="cls_0">project contains a class named </span><span class="cls_5">AppConstants</span><span class="cls_0">that defines some constants and</span></div><div style="position:absolute;left:87px;top:426px;white-space:pre;"><span class="cls_0">static fields that might be of use for formatting text:</span></div><div style="position:absolute;left:87px;top:451px;white-space:pre;"><span class="cls_4">namespace </span><span class="cls_1">SharedStatics</span></div><div style="position:absolute;left:87px;top:464px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:109px;top:478px;white-space:pre;"><span class="cls_4">static class </span><span class="cls_2">AppConstants</span></div><div style="position:absolute;left:109px;top:491px;white-space:pre;"><span class="cls_1">{</span></div><div style="position:absolute;left:132px;top:504px;white-space:pre;"><span class="cls_4">public static </span><span class="cls_2">Color </span><span class="cls_1">LightBackground = </span><span class="cls_2">Color</span><span class="cls_1">.Yellow;</span></div><div style="position:absolute;left:132px;top:518px;white-space:pre;"><span class="cls_4">public static </span><span class="cls_2">Color </span><span class="cls_1">DarkForeground = </span><span class="cls_2">Color</span><span class="cls_1">.Blue;</span></div><div style="position:absolute;left:132px;top:544px;white-space:pre;"><span class="cls_4">public static double </span><span class="cls_1">NormalFontSize = 18;</span></div><div style="position:absolute;left:132px;top:558px;white-space:pre;"><span class="cls_4">public static double </span><span class="cls_1">TitleFontSize = 1.4 * NormalFontSize;</span></div><div style="position:absolute;left:132px;top:571px;white-space:pre;"><span class="cls_4">public static double </span><span class="cls_1">ParagraphSpacing = 10;</span></div><div style="position:absolute;left:132px;top:598px;white-space:pre;"><span class="cls_4">public const </span><span class="cls_2">FontAttributes </span><span class="cls_1">Emphasis = </span><span class="cls_2">FontAttributes</span><span class="cls_1">.Italic;</span></div><div style="position:absolute;left:132px;top:611px;white-space:pre;"><span class="cls_4">public const </span><span class="cls_2">FontAttributes </span><span class="cls_1">TitleAttribute = </span><span class="cls_2">FontAttributes</span><span class="cls_1">.Bold;</span></div><div style="position:absolute;left:132px;top:638px;white-space:pre;"><span class="cls_4">public const </span><span class="cls_2">TextAlignment </span><span class="cls_1">TitleAlignment = </span><span class="cls_2">TextAlignment</span><span class="cls_1">.Center;</span></div><div style="position:absolute;left:109px;top:651px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:664px;white-space:pre;"><span class="cls_1">}</span></div><div style="position:absolute;left:87px;top:690px;white-space:pre;"><span class="cls_0">You could use </span><span class="cls_5">Device.OnPlatform</span><span class="cls_0">in these definitions if you need something different for each plat-</span></div><div style="position:absolute;left:87px;top:707px;white-space:pre;"><span class="cls_0">form.</span></div><div style="position:absolute;left:103px;top:734px;white-space:pre;"><span class="cls_0">The XAML file then uses 18 </span><span class="cls_5">x:Static</span><span class="cls_0">markup extensions to reference these items. Notice the XML</span></div><div style="position:absolute;left:87px;top:751px;white-space:pre;"><span class="cls_0">namespace declaration that associates the </span><span class="cls_5">local</span><span class="cls_0">prefix with the namespace of the project:</span></div><div style="position:absolute;left:87px;top:776px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 10</span></div><div style="position:absolute;left:181px;top:30px;white-space:pre;"><span class="cls_0">XAML markup extensions</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">203</span></div><div style="position:absolute;left:184px;top:71px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:84px;white-space:pre;"><span class="cls_14">xmlns:local</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">clr-namespace:SharedStatics</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:98px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">SharedStatics.SharedStaticsPage</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:111px;white-space:pre;"><span class="cls_14">BackgroundColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.LightBackground}</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:138px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage.Padding</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:151px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Thickness</span><span class="cls_1">"</span></div><div style="position:absolute;left:223px;top:164px;white-space:pre;"><span class="cls_14">iOS</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">0, 20, 0, 0</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:133px;top:178px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage.Padding</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:204px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout </span><span class="cls_14">Padding</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">10, 0</span><span class="cls_1">"</span></div><div style="position:absolute;left:206px;top:218px;white-space:pre;"><span class="cls_14">Spacing</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.ParagraphSpacing}</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:244px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">The SharedStatics Program</span><span class="cls_1">"</span></div><div style="position:absolute;left:195px;top:258px;white-space:pre;"><span class="cls_14">TextColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.DarkForeground}</span><span class="cls_1">"</span></div><div style="position:absolute;left:195px;top:271px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.TitleFontSize}</span><span class="cls_1">"</span></div><div style="position:absolute;left:195px;top:284px;white-space:pre;"><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.TitleAttribute}</span><span class="cls_1">"</span></div><div style="position:absolute;left:195px;top:298px;white-space:pre;"><span class="cls_14">HorizontalTextAlignment</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.TitleAlignment}</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:156px;top:324px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">TextColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.DarkForeground}</span><span class="cls_1">"</span></div><div style="position:absolute;left:195px;top:338px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.NormalFontSize}</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:351px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.FormattedText</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:364px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">FormattedString</span><span class="cls_4">></span></div><div style="position:absolute;left:223px;top:378px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Through use of the </span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:223px;top:391px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">x:Static</span><span class="cls_1">"</span></div><div style="position:absolute;left:257px;top:404px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.NormalFontSize}</span><span class="cls_1">"</span></div><div style="position:absolute;left:257px;top:418px;white-space:pre;"><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.Emphasis}</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:223px;top:431px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span></div><div style="position:absolute;left:111px;top:444px;white-space:pre;"><span class="cls_1">" </span><span class="cls_4">XAML markup extension, an application can maintain a collection of</span></div><div style="position:absolute;left:111px;top:458px;white-space:pre;"><span class="cls_4">common property settings defined as constants, static properties or fields,</span></div><div style="position:absolute;left:111px;top:471px;white-space:pre;"><span class="cls_4">or enumeration members in a separate code file. These can then be</span></div><div style="position:absolute;left:111px;top:484px;white-space:pre;"><span class="cls_4">referenced within the XAML file.</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:201px;top:498px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">FormattedString</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:511px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.FormattedText</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:524px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:551px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">TextColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.DarkForeground}</span><span class="cls_1">"</span></div><div style="position:absolute;left:195px;top:564px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.NormalFontSize}</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:578px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.FormattedText</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:591px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">FormattedString</span><span class="cls_4">></span></div><div style="position:absolute;left:223px;top:604px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span></div><div style="position:absolute;left:111px;top:618px;white-space:pre;"><span class="cls_1">"</span><span class="cls_4">However, this is not the only technique to share property settings.</span></div><div style="position:absolute;left:111px;top:631px;white-space:pre;"><span class="cls_4">You'll soon discover that you can store objects in a </span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:223px;top:644px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">ResourceDictionary</span><span class="cls_1">"</span></div><div style="position:absolute;left:257px;top:658px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.NormalFontSize}</span><span class="cls_1">"</span></div><div style="position:absolute;left:257px;top:671px;white-space:pre;"><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.Emphasis}</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:223px;top:684px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">" </span><span class="cls_4">and access them through the </span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:223px;top:698px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">StaticResource</span><span class="cls_1">"</span></div><div style="position:absolute;left:257px;top:711px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.NormalFontSize}</span><span class="cls_1">"</span></div><div style="position:absolute;left:257px;top:724px;white-space:pre;"><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.Emphasis}</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:223px;top:738px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span></div><div style="position:absolute;left:111px;top:751px;white-space:pre;"><span class="cls_1">" </span><span class="cls_4">markup extension, and even encapsultate multiple property settings in a </span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:223px;top:764px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Style</span><span class="cls_1">"</span></div><div style="position:absolute;left:257px;top:778px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.NormalFontSize}</span><span class="cls_1">"</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:87px;top:265px;width:492px;height:295px;z-index:0;"><img src="images\image115.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image116.png" width="708" height="864" alt=""></div><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 10</span></div><div style="position:absolute;left:157px;top:30px;white-space:pre;"><span class="cls_0">XAML markup extensions</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">204</span></div><div style="position:absolute;left:233px;top:71px;white-space:pre;"><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static local:AppConstants.Emphasis}</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:199px;top:84px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">" </span><span class="cls_4">object.</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:177px;top:98px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">FormattedString</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:111px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.FormattedText</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:124px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:138px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:151px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:176px;white-space:pre;"><span class="cls_0">Each of the </span><span class="cls_5">Span</span><span class="cls_0">objects with a </span><span class="cls_5">FontAttributes</span><span class="cls_0">setting repeats the </span><span class="cls_5">FontSize</span><span class="cls_0">setting that is set on</span></div><div style="position:absolute;left:87px;top:194px;white-space:pre;"><span class="cls_0">the </span><span class="cls_5">Label</span><span class="cls_0">itself because </span><span class="cls_5">Span</span><span class="cls_0">objects do not inherit font-related settings from the </span><span class="cls_5">Label</span><span class="cls_0">when an-</span></div><div style="position:absolute;left:87px;top:211px;white-space:pre;"><span class="cls_0">other font-related setting is applied.</span></div><div style="position:absolute;left:103px;top:238px;white-space:pre;"><span class="cls_0">And here it is:</span></div><div style="position:absolute;left:103px;top:568px;white-space:pre;"><span class="cls_0">This technique allows you to use these common property settings on multiple pages, and if you</span></div><div style="position:absolute;left:87px;top:586px;white-space:pre;"><span class="cls_0">ever need to change the values, you need only change the </span><span class="cls_5">AppSettings</span><span class="cls_0">file.</span></div><div style="position:absolute;left:103px;top:612px;white-space:pre;"><span class="cls_0">It is also possible to use </span><span class="cls_5">x:Static</span><span class="cls_0">with static properties and fields defined in classes in external li-</span></div><div style="position:absolute;left:87px;top:630px;white-space:pre;"><span class="cls_0">braries. The following example, named </span><span class="cls_13">SystemStatics,</span><span class="cls_0"> </span><span class="cls_0">is rather contrived</span><span class="cls_0">—</span><span class="cls_0">it sets the </span><span class="cls_5">BorderWidth</span><span class="cls_0">of</span></div><div style="position:absolute;left:87px;top:647px;white-space:pre;"><span class="cls_0">a </span><span class="cls_5">Button</span><span class="cls_0">equal to the </span><span class="cls_5">PI</span><span class="cls_0">static field defined in the </span><span class="cls_5">Math</span><span class="cls_0">class and uses the static </span><span class="cls_5">Environment.New-</span></div><div style="position:absolute;left:87px;top:664px;white-space:pre;"><span class="cls_5">Line</span><span class="cls_0">property for line breaks in text. But it demonstrates the technique.</span></div><div style="position:absolute;left:103px;top:691px;white-space:pre;"><span class="cls_0">The </span><span class="cls_5">Math</span><span class="cls_0">and </span><span class="cls_5">Environment</span><span class="cls_0">classes are both defined in the .NET </span><span class="cls_5">System</span><span class="cls_0">namespace, so a new</span></div><div style="position:absolute;left:87px;top:708px;white-space:pre;"><span class="cls_0">XML namespace declaration is required to define a prefix named (for example) </span><span class="cls_5">sys</span><span class="cls_0">for </span><span class="cls_5">System</span><span class="cls_0">. Notice</span></div><div style="position:absolute;left:87px;top:726px;white-space:pre;"><span class="cls_0">that this namespace declaration specifies the CLR namespace as </span><span class="cls_5">System</span><span class="cls_0">but the assembly as</span></div><div style="position:absolute;left:87px;top:743px;white-space:pre;"><span class="cls_5">mscorlib</span><span class="cls_0">, which originally stood for Microsoft Common Object Runtime Library but now stands for</span></div><div style="position:absolute;left:87px;top:760px;white-space:pre;"><span class="cls_0">Multilanguage Standard Common Object Runtime Library:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 10</span></div><div style="position:absolute;left:181px;top:30px;white-space:pre;"><span class="cls_0">XAML markup extensions</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">205</span></div><div style="position:absolute;left:111px;top:71px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:84px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:98px;white-space:pre;"><span class="cls_14">xmlns:sys</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">clr-namespace:System;assembly=mscorlib</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:111px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">SystemStatics.SystemStaticsPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:124px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:138px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">" </span><span class="cls_4">Button with </span><span class="cls_14">&#x03C0; </span><span class="cls_4">border width </span><span class="cls_1">"</span></div><div style="position:absolute;left:201px;top:151px;white-space:pre;"><span class="cls_14">BorderWidth</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static sys:Math.PI}</span><span class="cls_1">"</span></div><div style="position:absolute;left:201px;top:164px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:201px;top:178px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:191px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button.BackgroundColor</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:204px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Color</span><span class="cls_1">"</span></div><div style="position:absolute;left:268px;top:218px;white-space:pre;"><span class="cls_14">Android</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">#404040</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:231px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Button.BackgroundColor</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:244px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button.BorderColor</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:258px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Color</span><span class="cls_1">"</span></div><div style="position:absolute;left:268px;top:271px;white-space:pre;"><span class="cls_14">Android</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">White</span><span class="cls_1">"</span></div><div style="position:absolute;left:268px;top:284px;white-space:pre;"><span class="cls_14">WinPhone</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Black</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:178px;top:298px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Button.BorderColor</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:311px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Button</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:338px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span></div><div style="position:absolute;left:195px;top:351px;white-space:pre;"><span class="cls_14">HorizontalTextAlignment</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:195px;top:364px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Medium</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:378px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label.FormattedText</span><span class="cls_4">></span></div><div style="position:absolute;left:201px;top:391px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">FormattedString</span><span class="cls_4">></span></div><div style="position:absolute;left:223px;top:404px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Three lines of text</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:223px;top:418px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static sys:Environment.NewLine}</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:223px;top:431px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">separated by</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:223px;top:444px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{x:Static sys:Environment.NewLine}</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:223px;top:458px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Environment.NewLine</span><span class="cls_1">"</span></div><div style="position:absolute;left:257px;top:471px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Medium</span><span class="cls_1">"</span></div><div style="position:absolute;left:257px;top:484px;white-space:pre;"><span class="cls_14">FontAttributes</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Italic</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:223px;top:498px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Span </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">" </span><span class="cls_4">strings</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:201px;top:511px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">FormattedString</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:524px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label.FormattedText</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:538px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Label</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:551px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:564px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:127px;top:590px;white-space:pre;"><span class="cls_0">The button border doesn’t show up in Android unless the background color is set, and on both An-</span></div><div style="position:absolute;left:111px;top:607px;white-space:pre;"><span class="cls_0">droid and Windows Phone the border needs a nondefault color, so some additional markup takes care</span></div><div style="position:absolute;left:111px;top:624px;white-space:pre;"><span class="cls_0">of those problems. On iOS platforms, a button border tends to crowd the button text, so the text is de-</span></div><div style="position:absolute;left:111px;top:642px;white-space:pre;"><span class="cls_0">fined with spaces at the beginning and end.</span></div><div style="position:absolute;left:127px;top:668px;white-space:pre;"><span class="cls_0">Judging solely from the visuals, we really have to take it on trust that the button border width is</span></div><div style="position:absolute;left:111px;top:686px;white-space:pre;"><span class="cls_0">about 3.14 units wide, but the line breaks definitely work:</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:87px;top:71px;width:492px;height:295px;z-index:0;"><img src="images\image117.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image118.png" width="708" height="864" alt=""></div><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 10</span></div><div style="position:absolute;left:157px;top:30px;white-space:pre;"><span class="cls_0">XAML markup extensions</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">206</span></div><div style="position:absolute;left:103px;top:374px;white-space:pre;"><span class="cls_0">The use of curly braces for markup extensions implies that you can’t display text surrounded by</span></div><div style="position:absolute;left:87px;top:391px;white-space:pre;"><span class="cls_0">curly braces. The curly braces in this text will be mistaken for a markup extension:</span></div><div style="position:absolute;left:87px;top:416px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{Text in curly braces}</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:87px;top:442px;white-space:pre;"><span class="cls_0">That won’t work. You can have curly braces elsewhere in the text string, but you can’t begin with a left</span></div><div style="position:absolute;left:87px;top:459px;white-space:pre;"><span class="cls_0">curly brace.</span></div><div style="position:absolute;left:103px;top:486px;white-space:pre;"><span class="cls_0">If you really need to, however, you can ensure that text is not mistaken for a XAML markup exten-</span></div><div style="position:absolute;left:87px;top:503px;white-space:pre;"><span class="cls_0">sion by beginning the text with an escape sequence that consists of a pair of left and right curly braces:</span></div><div style="position:absolute;left:87px;top:528px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Label </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">{}{Text in curly braces}</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:87px;top:554px;white-space:pre;"><span class="cls_0">That will display the text you want.</span></div><div style="position:absolute;left:55px;top:593px;white-space:pre;"><span class="cls_11">Resource</span><span class="cls_12"> </span><span class="cls_11">dictionaries</span></div><div style="position:absolute;left:87px;top:642px;white-space:pre;"><span class="cls_0">Xamarin.Forms also supports a second approach to sharing objects and values, and while this approach</span></div><div style="position:absolute;left:87px;top:659px;white-space:pre;"><span class="cls_0">has a little more overhead than the </span><span class="cls_5">x:Static</span><span class="cls_0">markup extension, it is somewhat more versatile be-</span></div><div style="position:absolute;left:87px;top:676px;white-space:pre;"><span class="cls_0">cause everything</span><span class="cls_0">—</span><span class="cls_0">the shared objects and the visual elements that use them</span><span class="cls_0">—</span><span class="cls_0">can be expressed in</span></div><div style="position:absolute;left:87px;top:694px;white-space:pre;"><span class="cls_0">XAML.</span></div><div style="position:absolute;left:103px;top:720px;white-space:pre;"><span class="cls_5">VisualElement</span><span class="cls_0">defines a property named </span><span class="cls_5">Resources</span><span class="cls_0">that is of type </span><span class="cls_5">ResourceDictionary</span><span class="cls_0">—</span><span class="cls_0">a</span></div><div style="position:absolute;left:87px;top:738px;white-space:pre;"><span class="cls_0">dictionary with </span><span class="cls_5">string</span><span class="cls_0">keys and values of type </span><span class="cls_5">object</span><span class="cls_0">. Items can be added to this dictionary right in</span></div><div style="position:absolute;left:87px;top:755px;white-space:pre;"><span class="cls_0">XAML, and they can be accessed in XAML with the </span><span class="cls_5">StaticResource</span><span class="cls_0">and </span><span class="cls_5">DynamicResource</span><span class="cls_0">markup</span></div><div style="position:absolute;left:87px;top:772px;white-space:pre;"><span class="cls_0">extensions.</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 10</span></div><div style="position:absolute;left:181px;top:30px;white-space:pre;"><span class="cls_0">XAML markup extensions</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">207</span></div><div style="position:absolute;left:127px;top:72px;white-space:pre;"><span class="cls_0">Although </span><span class="cls_5">x:Static</span><span class="cls_0">and </span><span class="cls_5">StaticResource</span><span class="cls_0">have somewhat similar names, they are quite different:</span></div><div style="position:absolute;left:111px;top:90px;white-space:pre;"><span class="cls_5">x:Static</span><span class="cls_0">references a constant, a static field, a static property, or an enumeration member, while</span></div><div style="position:absolute;left:111px;top:107px;white-space:pre;"><span class="cls_5">StaticResource</span><span class="cls_0">retrieves an object from a </span><span class="cls_5">ResourceDictionary</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:134px;white-space:pre;"><span class="cls_0">While the </span><span class="cls_5">x:Static</span><span class="cls_0">markup extension is intrinsic to XAML (and hence appears in XAML with an </span><span class="cls_5">x</span></div><div style="position:absolute;left:111px;top:151px;white-space:pre;"><span class="cls_0">prefix), the </span><span class="cls_5">StaticResource</span><span class="cls_0">and </span><span class="cls_5">DynamicResource</span><span class="cls_0">markup extensions are not. They were part of</span></div><div style="position:absolute;left:111px;top:168px;white-space:pre;"><span class="cls_0">the original XAML implementation in the Windows Presentation Foundation, and </span><span class="cls_5">StaticResource</span><span class="cls_0">is</span></div><div style="position:absolute;left:111px;top:186px;white-space:pre;"><span class="cls_0">also supported in Silverlight, Windows Phone 7 and 8, and Windows 8 and 10.</span></div><div style="position:absolute;left:127px;top:212px;white-space:pre;"><span class="cls_0">You’ll use </span><span class="cls_5">StaticResource</span><span class="cls_0">for most purposes and reserve </span><span class="cls_5">DynamicResource</span><span class="cls_0">for some special</span></div><div style="position:absolute;left:111px;top:230px;white-space:pre;"><span class="cls_0">applications, so let’s begin with </span><span class="cls_5">StaticResource</span><span class="cls_0">.</span></div><div style="position:absolute;left:111px;top:262px;white-space:pre;"><span class="cls_16">StaticResource</span><span class="cls_17"> </span><span class="cls_16">for</span><span class="cls_17"> </span><span class="cls_16">most</span><span class="cls_17"> </span><span class="cls_16">purposes</span></div><div style="position:absolute;left:111px;top:293px;white-space:pre;"><span class="cls_0">Suppose you’ve defined three buttons in a </span><span class="cls_5">StackLayout</span><span class="cls_0">:</span></div><div style="position:absolute;left:111px;top:319px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:332px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">" </span><span class="cls_4">Carpe diem </span><span class="cls_1">"</span></div><div style="position:absolute;left:178px;top:345px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:178px;top:359px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span></div><div style="position:absolute;left:178px;top:372px;white-space:pre;"><span class="cls_14">BorderWidth</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">3</span><span class="cls_1">"</span></div><div style="position:absolute;left:178px;top:385px;white-space:pre;"><span class="cls_14">TextColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Red</span><span class="cls_1">"</span></div><div style="position:absolute;left:178px;top:399px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:412px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button.BackgroundColor</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:425px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Color</span><span class="cls_1">"</span></div><div style="position:absolute;left:246px;top:439px;white-space:pre;"><span class="cls_14">Android</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">#404040</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:156px;top:452px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Button.BackgroundColor</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:465px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button.BorderColor</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:479px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Color</span><span class="cls_1">"</span></div><div style="position:absolute;left:246px;top:492px;white-space:pre;"><span class="cls_14">Android</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">White</span><span class="cls_1">"</span></div><div style="position:absolute;left:246px;top:505px;white-space:pre;"><span class="cls_14">WinPhone</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Black</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:156px;top:519px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Button.BorderColor</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:532px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Button</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:559px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">" </span><span class="cls_4">Sapere aude </span><span class="cls_1">"</span></div><div style="position:absolute;left:178px;top:572px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:178px;top:586px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span></div><div style="position:absolute;left:178px;top:599px;white-space:pre;"><span class="cls_14">BorderWidth</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">3</span><span class="cls_1">"</span></div><div style="position:absolute;left:178px;top:612px;white-space:pre;"><span class="cls_14">TextColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Red</span><span class="cls_1">"</span></div><div style="position:absolute;left:201px;top:626px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:639px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button.BackgroundColor</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:652px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Color</span><span class="cls_1">"</span></div><div style="position:absolute;left:246px;top:666px;white-space:pre;"><span class="cls_14">Android</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">#404040</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:156px;top:679px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Button.BackgroundColor</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:692px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button.BorderColor</span><span class="cls_4">></span></div><div style="position:absolute;left:178px;top:706px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Color</span><span class="cls_1">"</span></div><div style="position:absolute;left:246px;top:719px;white-space:pre;"><span class="cls_14">Android</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">White</span><span class="cls_1">"</span></div><div style="position:absolute;left:246px;top:732px;white-space:pre;"><span class="cls_14">WinPhone</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Black</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:156px;top:746px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Button.BorderColor</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:759px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Button</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:786px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button </span><span class="cls_14">Text</span><span class="cls_4">=</span><span class="cls_1">" </span><span class="cls_4">Discere faciendo </span><span class="cls_1">"</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;border:none;left:87px;top:341px;width:492px;height:295px;z-index:0;"><img src="images\image119.png" width="492" height="295" alt=""></div><div style="position:absolute;border:none;left:0px;top:0px;width:708px;height:864px;z-index:-1;"><img src="images\image120.png" width="708" height="864" alt=""></div><div style="position:absolute;left:87px;top:30px;white-space:pre;"><span class="cls_0">Chapter 10</span></div><div style="position:absolute;left:157px;top:30px;white-space:pre;"><span class="cls_0">XAML markup extensions</span></div><div style="position:absolute;left:609px;top:30px;white-space:pre;"><span class="cls_0">208</span></div><div style="position:absolute;left:154px;top:71px;white-space:pre;"><span class="cls_14">HorizontalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:154px;top:84px;white-space:pre;"><span class="cls_14">VerticalOptions</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">CenterAndExpand</span><span class="cls_1">"</span></div><div style="position:absolute;left:154px;top:98px;white-space:pre;"><span class="cls_14">BorderWidth</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">3</span><span class="cls_1">"</span></div><div style="position:absolute;left:154px;top:111px;white-space:pre;"><span class="cls_14">TextColor</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Red</span><span class="cls_1">"</span></div><div style="position:absolute;left:154px;top:124px;white-space:pre;"><span class="cls_14">FontSize</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Large</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:138px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button.BackgroundColor</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:151px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Color</span><span class="cls_1">"</span></div><div style="position:absolute;left:222px;top:164px;white-space:pre;"><span class="cls_14">Android</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">#404040</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:132px;top:178px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Button.BackgroundColor</span><span class="cls_4">></span></div><div style="position:absolute;left:132px;top:191px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">Button.BorderColor</span><span class="cls_4">></span></div><div style="position:absolute;left:154px;top:204px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">OnPlatform </span><span class="cls_14">x:TypeArguments</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Color</span><span class="cls_1">"</span></div><div style="position:absolute;left:222px;top:218px;white-space:pre;"><span class="cls_14">Android</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">White</span><span class="cls_1">"</span></div><div style="position:absolute;left:222px;top:231px;white-space:pre;"><span class="cls_14">WinPhone</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Black</span><span class="cls_1">" </span><span class="cls_4">/></span></div><div style="position:absolute;left:132px;top:244px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Button.BorderColor</span><span class="cls_4">></span></div><div style="position:absolute;left:109px;top:258px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">Button</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:271px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">StackLayout</span><span class="cls_4">></span></div><div style="position:absolute;left:87px;top:296px;white-space:pre;"><span class="cls_0">Of course, this is somewhat unrealistic. There are no </span><span class="cls_5">Clicked</span><span class="cls_0">events set for these buttons, and gener-</span></div><div style="position:absolute;left:87px;top:314px;white-space:pre;"><span class="cls_0">ally button text is not in Latin. But here’s what they look like:</span></div><div style="position:absolute;left:103px;top:644px;white-space:pre;"><span class="cls_0">Aside from the text, all three buttons have the same properties set to the same values. Repetitious</span></div><div style="position:absolute;left:87px;top:662px;white-space:pre;"><span class="cls_0">markup such as this tends to rub programmers the wrong way. It’s an affront to the eye and difficult to</span></div><div style="position:absolute;left:87px;top:679px;white-space:pre;"><span class="cls_0">maintain and change.</span></div><div style="position:absolute;left:103px;top:706px;white-space:pre;"><span class="cls_0">Eventually you’ll see how to use styles to really cut down on the repetitio</span><span class="cls_0">us markup. For now, how-</span></div><div style="position:absolute;left:87px;top:723px;white-space:pre;"><span class="cls_0">ever, the goal is not to make the markup shorter but to consolidate the values in one place so that if</span></div><div style="position:absolute;left:87px;top:740px;white-space:pre;"><span class="cls_0">you ever want to change the </span><span class="cls_5">TextColor</span><span class="cls_0">property from </span><span class="cls_5">Red</span><span class="cls_0">to </span><span class="cls_5">Blue</span><span class="cls_0">, you can do so with one edit</span></div><div style="position:absolute;left:87px;top:758px;white-space:pre;"><span class="cls_0">rather than three.</span></div></div><div style="position:relative;margin: 0px 0px 0px 0px;padding:0px;border:none;overflow:hidden;width:708px;height:864px;"><div style="position:absolute;left:111px;top:30px;white-space:pre;"><span class="cls_0">Chapter 10</span></div><div style="position:absolute;left:181px;top:30px;white-space:pre;"><span class="cls_0">XAML markup extensions</span></div><div style="position:absolute;left:633px;top:30px;white-space:pre;"><span class="cls_0">209</span></div><div style="position:absolute;left:127px;top:72px;white-space:pre;"><span class="cls_0">Obviously, you can use </span><span class="cls_5">x:Static</span><span class="cls_0">for this job by defining the values in code. But let’s do the whole</span></div><div style="position:absolute;left:111px;top:90px;white-space:pre;"><span class="cls_0">thing in XAML by storing the values in a </span><span class="cls_9">resource</span><span class="cls_0"> </span><span class="cls_9">dictionary</span><span class="cls_0">. Every class that derives from </span><span class="cls_5">VisualEle-</span></div><div style="position:absolute;left:111px;top:107px;white-space:pre;"><span class="cls_5">ment</span><span class="cls_0">has a </span><span class="cls_5">Resources</span><span class="cls_0">property of type </span><span class="cls_5">ResourceDictionary</span><span class="cls_0">. Resources that are used throughout a</span></div><div style="position:absolute;left:111px;top:124px;white-space:pre;"><span class="cls_0">page are customarily stored in the </span><span class="cls_5">Resources</span><span class="cls_0">collection of the </span><span class="cls_5">ContentPage</span><span class="cls_0">.</span></div><div style="position:absolute;left:127px;top:151px;white-space:pre;"><span class="cls_0">The first step is to express the </span><span class="cls_5">Resources</span><span class="cls_0">property of </span><span class="cls_5">ContentPage</span><span class="cls_0">as a property element:</span></div><div style="position:absolute;left:111px;top:176px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:190px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:203px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">ResourceSharing.ResourceSharingPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:230px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage.Resources</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:256px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage.Resources</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:270px;white-space:pre;"><span class="cls_4">…</span></div><div style="position:absolute;left:111px;top:283px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:308px;white-space:pre;"><span class="cls_0">If you’re also defining a </span><span class="cls_5">Padding</span><span class="cls_0">property on the page by using property-element tags, the order</span></div><div style="position:absolute;left:111px;top:326px;white-space:pre;"><span class="cls_0">doesn’t matter.</span></div><div style="position:absolute;left:127px;top:352px;white-space:pre;"><span class="cls_0">For performance purposes, the </span><span class="cls_5">Resources</span><span class="cls_0">property is </span><span class="cls_5">null</span><span class="cls_0">by default, so you need to explicitly</span></div><div style="position:absolute;left:111px;top:370px;white-space:pre;"><span class="cls_0">instantiate the </span><span class="cls_5">ResourceDictionary</span><span class="cls_0">:</span></div><div style="position:absolute;left:111px;top:395px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage </span><span class="cls_14">xmlns</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://xamarin.com/schemas/2014/forms</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:408px;white-space:pre;"><span class="cls_14">xmlns:x</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">http://schemas.microsoft.com/winfx/2009/xaml</span><span class="cls_1">"</span></div><div style="position:absolute;left:184px;top:422px;white-space:pre;"><span class="cls_14">x:Class</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">ResourceSharing.ResourceSharingPage</span><span class="cls_1">"</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:448px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ContentPage.Resources</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:462px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">ResourceDictionary</span><span class="cls_4">></span></div><div style="position:absolute;left:156px;top:488px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ResourceDictionary</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:502px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage.Resources</span><span class="cls_4">></span></div><div style="position:absolute;left:133px;top:515px;white-space:pre;"><span class="cls_4">…</span></div><div style="position:absolute;left:111px;top:528px;white-space:pre;"><span class="cls_4"></</span><span class="cls_6">ContentPage</span><span class="cls_4">></span></div><div style="position:absolute;left:127px;top:554px;white-space:pre;"><span class="cls_0">Between the </span><span class="cls_5">ResourceDictionary</span><span class="cls_0">tags, you define one or more objects or values. Each item in</span></div><div style="position:absolute;left:111px;top:571px;white-space:pre;"><span class="cls_0">the dictionary must be identified with a dictionary key that you specify with the XAML </span><span class="cls_5">x:Key</span><span class="cls_0">attribute.</span></div><div style="position:absolute;left:111px;top:588px;white-space:pre;"><span class="cls_0">For example, here’s the syntax for i</span><span class="cls_0">ncluding a </span><span class="cls_5">LayoutOptions</span><span class="cls_0">value in the dictionary with a descrip-</span></div><div style="position:absolute;left:111px;top:606px;white-space:pre;"><span class="cls_0">tive key that indicates that this value is defined for setting horizontal options:</span></div><div style="position:absolute;left:111px;top:631px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">LayoutOptions </span><span class="cls_14">x:Key</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">horzOptions</span><span class="cls_1">"</span><span class="cls_4">></span><span class="cls_1">Center</span><span class="cls_4"></</span><span class="cls_6">LayoutOptions</span><span class="cls_4">></span></div><div style="position:absolute;left:111px;top:656px;white-space:pre;"><span class="cls_0">Because this is a </span><span class="cls_5">LayoutOptions</span><span class="cls_0">value, the XAML parser accesses the </span><span class="cls_5">LayoutOptionsConverter</span></div><div style="position:absolute;left:111px;top:674px;white-space:pre;"><span class="cls_0">class to convert the content of the tags, which is the text “Center”.</span></div><div style="position:absolute;left:127px;top:700px;white-space:pre;"><span class="cls_0">A second way to store a </span><span class="cls_5">LayoutOptions</span><span class="cls_0">value in the dictionary is to let the XAML parser instanti-</span></div><div style="position:absolute;left:111px;top:718px;white-space:pre;"><span class="cls_0">ate the structure and set </span><span class="cls_5">LayoutOptions</span><span class="cls_0">properties from attributes you specify:</span></div><div style="position:absolute;left:111px;top:743px;white-space:pre;"><span class="cls_4"><</span><span class="cls_6">LayoutOptions </span><span class="cls_14">x:Key</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">vertOptions</span><span class="cls_1">"</span></div><div style="position:absolute;left:195px;top:756px;white-space:pre;"><span class="cls_14">Alignment</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">Center</span><span class="cls_1">"</span></div><div style="position:absolute;left:195px;top:770px;white-space:pre;"><span class="cls_14">Expands</span><span class="cls_4">=</span><span class="cls_1">"</span><span class="cls_4">True</span><span class="cls_1">" </span><span class="cls_4">/></span></div></div></body></html>